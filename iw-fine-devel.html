
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Finescale Mixing Parametrizations: Development &#8212; Eddy Diffusivity</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Compare different \(K_e\) estimates" href="compare-Ke-estimates.html" />
    <link rel="prev" title="Existing finestructure estimates" href="iw-fine-estimates.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Eddy Diffusivity</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Moored χpod analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="tao.html">
   TAO (0, 140) χpod
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="equix.html">
   EQUIX
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  CTD χpod analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="BoB-ctd-chipod.html">
   BoB ASIRI 2013 CTD χpod
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="P06.html">
   P06 CTD χpod analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sections-variance-estimate.html">
   Eddy variance generation along GO-SHIP lines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ctd-%CF%87-A05.html">
   CTD χpod A05 section
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bootstrap-ctd-chipod-estimates.html">
   Bootstrapped outlier detection for CTD-χpod
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Variance budgets
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="natre.html">
   NATRE region variance budget
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  NATRE region analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="natre-examine.html">
   NATRE microstructure dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="natre-finescale.html">
   NATRE micro vs finescale
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Finestructure analysis
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="iw-fine-argo.html">
   Argo finescale estimates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="iw-fine-estimates.html">
   Existing finestructure estimates
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Finescale Mixing Parametrizations: Development
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Ancillary analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="compare-Ke-estimates.html">
   Compare different
   <span class="math notranslate nohighlight">
    \(K_e\)
   </span>
   estimates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="equix-vs-tao.html">
   χpods: EQUIX vs TAO
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eqpac-ts-diagrams.html">
   T-S diagrams from TAO &amp; Argo at (0, 145W→135W)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dataset-processing.html">
   Dataset processing
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Presentation figures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="figs-2022-02-omwg.html">
   Nice matplotlib map
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/iw-fine-devel.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/dcherian/eddydiff"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/dcherian/eddydiff/master?urlpath=tree/notebooks/iw-fine-devel.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#check-against-kunze-mixsea">
   Check against Kunze &amp; mixsea
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-n2-estimates">
     Compare N² estimates:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-to-mixsea-sensitivity-studies">
     Compare to mixsea &amp; Sensitivity studies
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Finescale Mixing Parametrizations: Development</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#check-against-kunze-mixsea">
   Check against Kunze &amp; mixsea
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-n2-estimates">
     Compare N² estimates:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-to-mixsea-sensitivity-studies">
     Compare to mixsea &amp; Sensitivity studies
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="finescale-mixing-parametrizations-development">
<h1>Finescale Mixing Parametrizations: Development<a class="headerlink" href="#finescale-mixing-parametrizations-development" title="Permalink to this headline">¶</a></h1>
<p>From Whalen et al (2012) Supplementary</p>
<p>QC:</p>
<ol class="simple">
<li><p>All Argo float profiles with an ‘A’ quality rating (all real-time quality control tests passed) between June 2006 and December 2011 were selected.</p></li>
<li><p>The mixed layer was removed before implementing the parameterization since the mixed layer appears at a region of the high strain variance, and the parameterization treats all strain variance as internal waves, leading to an inaccurate estimate of the mixing. The same problem exists for other areas of low stratification near the surface (for example, mode water).</p></li>
<li><p>The variable temperature criterion (de Boyer Montegut et al., 2004) was therefore applied twice, once to remove the mixed layer, and a second time treating the bottom of the mixed layer as the surface.</p></li>
<li><p>Profiles with large spikes from any of the sensors were taken out of the dataset, and small salinity spikes needed to be removed from a subset of the profiles.</p></li>
</ol>
<p>Steps:</p>
<ol class="simple">
<li><p>Each profile containing 15 m resolution or better was divided into 200 m half-overlapping segments.</p></li>
<li><p>Segments were discarded if N² &lt; 10−9 s−2 or if N² varied by more than 6 x 10−4 s−2, to remove sharp strain gradients not associated with internal waves.</p></li>
<li><p>We consider the vertical resolution of the segments since this could have an effect on the calculated dissipation rates. The majority of the segments had either 2 m or 10 m resolution, with similar mean ! (the mean 10 m resolution estimate above 500 m was only 10% larger), while the standard deviation of dissipation rate for 2 m data was 40% larger.</p></li>
</ol>
<hr class="docutils" />
<p>Whalen et al (2015):</p>
<p>To calculate the strain variance ⟨ξ²⟩, each segment
was detrended, windowed using a sin² 10% taper, and
spatially Fourier transformed to generate the spectrum
Sstr for each segment. The spectrum is corrected for first
differencing by dividing by the transfer function sinc²
(kzDz/2p), where Dz is the vertical resolution of the
segment. Argo data are either point measurements or
averages over a depth interval, which is currently not
identified in the metadata. Here, we correct for this
whenever we know the sampling scheme of the profile
by dividing by the same transfer function a second time
[a correction not included in Whalen et al. (2012)]. This
slightly raises the variances in the bin-averaged cases.
The average increase in the dissipation rate for the Atlantic Ocean is a factor of 1.02, with a range of 1 to 2.6.</p>
<p>Strain</p>
<div class="amsmath math notranslate nohighlight" id="equation-1807ebfb-9cf5-444e-bbee-5f401dd1ad6d">
<span class="eqno">(9)<a class="headerlink" href="#equation-1807ebfb-9cf5-444e-bbee-5f401dd1ad6d" title="Permalink to this equation">¶</a></span>\[\begin{equation}
ξ_z = \frac{N² - N²_{fit}}{\bar{N²}}
\end{equation}\]</div>
<hr class="docutils" />
<p>Waterman et al (2014)</p>
<p>Segments were constructed
both starting from the surface and the bottom, with
near-surface values computed from the vertical segments defined starting from the surface, near-bottom
values computed from the vertical segments defined
starting from the bottom, and interior values computed
from an average of top–down- and bottom–up-defined
segments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark

<span class="kn">import</span> <span class="nn">argopy</span>
<span class="kn">import</span> <span class="nn">cf_xarray</span> <span class="k">as</span> <span class="nn">cfxr</span>
<span class="kn">import</span> <span class="nn">dask</span>
<span class="kn">import</span> <span class="nn">dcpy</span>
<span class="kn">import</span> <span class="nn">gsw</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">mixsea</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">scipy.integrate</span>
<span class="kn">import</span> <span class="nn">seawater</span> <span class="k">as</span> <span class="nn">sw</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">dcpy.finestructure</span> <span class="kn">import</span> <span class="n">estimate_turb_segment</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">loadmat</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;bmh&quot;</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">140</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;lines.linewidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">dirname</span> <span class="o">=</span> <span class="s2">&quot;/home/deepak/datasets/finestructure/&quot;</span>

<span class="o">%</span><span class="k">watermark</span> -iv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dask      : 2021.6.2
cf_xarray : 0.4.1.dev21+gab9dc66
scipy     : 1.5.3
eddydiff  : 0.1
pandas    : 1.2.3
seawater  : 3.3.4
dcpy      : 0.1
mixsea    : 0.1.0
xarray    : 0.17.1.dev3+g48378c4b1
numpy     : 1.20.2
argopy    : 0.1.7
gsw       : 3.4.0
matplotlib: 3.4.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kunze</span> <span class="o">=</span> <span class="n">dcpy</span><span class="o">.</span><span class="n">oceans</span><span class="o">.</span><span class="n">read_kunze_2017_finestructure</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="check-against-kunze-mixsea">
<h2>Check against Kunze &amp; mixsea<a class="headerlink" href="#check-against-kunze-mixsea" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cruise</span> <span class="o">=</span> <span class="s2">&quot;317519930704&quot;</span>
<span class="n">cast</span> <span class="o">=</span> <span class="mi">19</span>
<span class="n">kunze_cruise</span> <span class="o">=</span> <span class="n">kunze</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;cruise&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">cruise</span><span class="p">)</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;drop == </span><span class="si">{</span><span class="n">cast</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">ctd</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dirname</span><span class="si">}</span><span class="s2">/../cchdo/</span><span class="si">{</span><span class="n">cruise</span><span class="si">}</span><span class="s2">/*ctd.nc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="k">del</span> <span class="n">ctd</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;comments&quot;</span><span class="p">]</span>

<span class="n">profile</span> <span class="o">=</span> <span class="n">ctd</span><span class="o">.</span><span class="n">query</span><span class="p">({</span><span class="s2">&quot;N_PROF&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;cast == </span><span class="si">{</span><span class="n">cast</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">profile</span><span class="o">.</span><span class="n">ctd_salinity</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;standard_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sea_water_salinity&quot;</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">&quot;γ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dcpy</span><span class="o">.</span><span class="n">oceans</span><span class="o">.</span><span class="n">neutral_density</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Polzin et al (2015) recommend sorting then calculating N2</span>
<span class="n">initial_pressure</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">profile</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s2">&quot;γ&quot;</span><span class="p">)</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">&quot;pressure&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">initial_pressure</span>
<span class="n">profile</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s2">&quot;N_LEVELS&quot;</span><span class="p">:</span> <span class="s2">&quot;pressure&quot;</span><span class="p">})</span>
<span class="n">profile</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="n">profile</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span>

<span class="n">profile</span><span class="p">[</span><span class="s2">&quot;N2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;pressure&quot;</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">dcpy</span><span class="o">.</span><span class="n">eos</span><span class="o">.</span><span class="n">bfrq</span><span class="p">(</span>
            <span class="n">profile</span><span class="o">.</span><span class="n">ctd_salinity</span><span class="p">,</span>
            <span class="n">profile</span><span class="o">.</span><span class="n">ctd_temperature</span><span class="p">,</span>
            <span class="n">profile</span><span class="o">.</span><span class="n">pressure</span><span class="p">,</span>
            <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># .interp(pressure_mid=profile.pressure.data)</span>
        <span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="n">SA</span> <span class="o">=</span> <span class="n">gsw</span><span class="o">.</span><span class="n">SA_from_SP</span><span class="p">(</span>
    <span class="n">profile</span><span class="o">.</span><span class="n">ctd_salinity</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">pressure</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">latitude</span>
<span class="p">)</span>
<span class="n">CT</span> <span class="o">=</span> <span class="n">gsw</span><span class="o">.</span><span class="n">CT_from_t</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">ctd_temperature</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">pressure</span><span class="p">)</span>
<span class="n">N2gsw</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">gsw</span><span class="o">.</span><span class="n">Nsquared</span><span class="p">(</span><span class="n">SA</span><span class="p">,</span> <span class="n">CT</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">pressure</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">latitude</span><span class="p">)</span>
<span class="n">N2gsw</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">N2gsw</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;pressure&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">})</span>

<span class="c1"># profile[&quot;N2gsw&quot;] = (&quot;pressure&quot;, N2gsw.interp(pressure=profile.pressure.data).data)</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">&quot;N2gsw&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">N2gsw</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))</span>

<span class="c1"># Density variables σp, σθ, σ3, and γ_n and stratification N2 were then computed</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">&quot;σθ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dcpy</span><span class="o">.</span><span class="n">eos</span><span class="o">.</span><span class="n">pden</span><span class="p">(</span>
    <span class="n">profile</span><span class="o">.</span><span class="n">ctd_salinity</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">ctd_temperature</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">pressure</span><span class="p">,</span> <span class="mi">0</span>
<span class="p">)</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">&quot;σ3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dcpy</span><span class="o">.</span><span class="n">eos</span><span class="o">.</span><span class="n">pden</span><span class="p">(</span>
    <span class="n">profile</span><span class="o">.</span><span class="n">ctd_salinity</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">ctd_temperature</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">pressure</span><span class="p">,</span> <span class="mi">3000</span>
<span class="p">)</span>

<span class="n">profile</span><span class="p">[</span><span class="s2">&quot;N2θ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="o">-</span><span class="mf">9.81</span>
    <span class="o">/</span> <span class="mi">1030</span>
    <span class="o">*</span> <span class="n">profile</span><span class="o">.</span><span class="n">σθ</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">differentiate</span><span class="p">(</span><span class="s2">&quot;sea_water_pressure&quot;</span><span class="p">,</span> <span class="n">positive_upward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">&quot;N23&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="o">-</span><span class="mf">9.81</span>
    <span class="o">/</span> <span class="mi">1030</span>
    <span class="o">*</span> <span class="n">profile</span><span class="o">.</span><span class="n">σ3</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">differentiate</span><span class="p">(</span><span class="s2">&quot;sea_water_pressure&quot;</span><span class="p">,</span> <span class="n">positive_upward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">profile</span><span class="p">[</span><span class="s2">&quot;N2γ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="o">-</span><span class="mf">9.81</span>
    <span class="o">/</span> <span class="mi">1030</span>
    <span class="o">*</span> <span class="n">profile</span><span class="o">.</span><span class="n">γ</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">differentiate</span><span class="p">(</span><span class="s2">&quot;sea_water_pressure&quot;</span><span class="p">,</span> <span class="n">positive_upward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">profile</span><span class="p">[</span><span class="s2">&quot;pres&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">profile</span><span class="p">[</span><span class="s2">&quot;pressure&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Break up in to half overlapping segments</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">segmented</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">profile</span><span class="o">.</span><span class="n">drop_vars</span><span class="p">(</span><span class="s2">&quot;sample&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">148</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">construct</span><span class="p">(</span><span class="n">window_dim</span><span class="o">=</span><span class="s2">&quot;segment&quot;</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
    <span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="p">)</span>
<span class="n">segmented</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;pres_mean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">segmented</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;segment&quot;</span><span class="p">)</span>
<span class="n">segmented</span><span class="p">[</span><span class="s2">&quot;segment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">segmented</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s2">&quot;segment&quot;</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">segmented</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:             (pressure: 28, segment: 128)
Coordinates:
    latitude            float64 2.002
    longitude           float64 -25.2
    time                datetime64[ns] 1993-07-11T06:14:00
    expocode            object &#x27;3175MB93&#x27;
    station             object &#x27;16&#x27;
    cast                int8 19
    reference_pressure  int64 0
  * pressure            (pressure) float64 404.0 532.0 ... 3.732e+03 3.86e+03
    pres_mean           (pressure) float64 277.0 405.0 ... 3.605e+03 3.733e+03
  * segment             (segment) int64 0 2 4 6 8 10 ... 244 246 248 250 252 254
Data variables: (12/16)
    section_id          object &#x27;AR21b&#x27;
    ctd_temperature     (pressure, segment) float32 14.0 13.87 ... 2.389 2.392
    ctd_temperature_qc  (pressure, segment) float32 2.0 2.0 2.0 ... 2.0 2.0 2.0
    ctd_salinity        (pressure, segment) float32 35.38 35.38 ... 34.89 34.89
    ctd_salinity_qc     (pressure, segment) float32 2.0 2.0 2.0 ... 2.0 2.0 2.0
    profile_type        object &#x27;C&#x27;
    ...                  ...
    σθ                  (pressure, segment) float64 1.026e+03 ... 1.028e+03
    σ3                  (pressure, segment) float64 1.039e+03 ... 1.042e+03
    N2θ                 (pressure, segment) float64 0.0001127 ... 3.154e-06
    N23                 (pressure, segment) float64 0.0001539 ... 2.376e-06
    N2γ                 (pressure, segment) float32 0.0001192 ... 6.358e-08
    pres                (pressure, segment) float64 150.0 152.0 ... 3.86e+03
Attributes:
    Conventions:               CF-1.8 CCHDO-1.0
    cchdo_software_version:    hydro 1.0.1.2
    cchdo_parameters_version:  params 0.1.9
    featureType:               profile</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-2ec16363-93f2-4943-a912-0a8c1c376ec6' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2ec16363-93f2-4943-a912-0a8c1c376ec6' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>pressure</span>: 28</li><li><span class='xr-has-index'>segment</span>: 128</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-2ec7ec42-14e4-4f6b-8099-ee19cedb4ce8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2ec7ec42-14e4-4f6b-8099-ee19cedb4ce8' class='xr-section-summary' >Coordinates: <span>(10)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.002</div><input id='attrs-b9c6397a-776a-4c23-87a0-b0a751940ef1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b9c6397a-776a-4c23-87a0-b0a751940ef1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-23c17a22-45a6-48e0-9525-da8d4a5c8e50' class='xr-var-data-in' type='checkbox'><label for='data-23c17a22-45a6-48e0-9525-da8d4a5c8e50' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>whp_name :</span></dt><dd>LATITUDE</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degree_north</dd><dt><span>C_format :</span></dt><dd>%9.4f</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array(2.002)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-25.2</div><input id='attrs-52de7a0c-9806-42f5-90b2-f8dee66bcb79' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-52de7a0c-9806-42f5-90b2-f8dee66bcb79' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b9cc7af9-dbd1-4ecc-9238-f8eb8158814b' class='xr-var-data-in' type='checkbox'><label for='data-b9cc7af9-dbd1-4ecc-9238-f8eb8158814b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>whp_name :</span></dt><dd>LONGITUDE</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degree_east</dd><dt><span>C_format :</span></dt><dd>%9.4f</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array(-25.202)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1993-07-11T06:14:00</div><input id='attrs-a185480e-823e-4061-b292-cd459380e886' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a185480e-823e-4061-b292-cd459380e886' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d5184c80-c58e-4535-9c13-be1e330efe88' class='xr-var-data-in' type='checkbox'><label for='data-d5184c80-c58e-4535-9c13-be1e330efe88' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>whp_name :</span></dt><dd>[&#x27;DATE&#x27;, &#x27;TIME&#x27;]</dd><dt><span>resolution :</span></dt><dd>0.000694</dd><dt><span>geometry :</span></dt><dd>geometry_container</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;1993-07-11T06:14:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>expocode</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;3175MB93&#x27;</div><input id='attrs-3fdd73bd-4144-49fd-afc5-ac66899076bb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3fdd73bd-4144-49fd-afc5-ac66899076bb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0fc8e00b-75e7-44b3-af74-4d2f34086064' class='xr-var-data-in' type='checkbox'><label for='data-0fc8e00b-75e7-44b3-af74-4d2f34086064' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>whp_name :</span></dt><dd>EXPOCODE</dd><dt><span>geometry :</span></dt><dd>geometry_container</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;3175MB93&#x27;, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>station</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;16&#x27;</div><input id='attrs-3f5230e2-979f-4799-8462-d515eb96e9c9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3f5230e2-979f-4799-8462-d515eb96e9c9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8c0a2944-3d23-43c5-aa40-260c5256e32f' class='xr-var-data-in' type='checkbox'><label for='data-8c0a2944-3d23-43c5-aa40-260c5256e32f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>whp_name :</span></dt><dd>STNNBR</dd><dt><span>geometry :</span></dt><dd>geometry_container</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;16&#x27;, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>cast</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int8</div><div class='xr-var-preview xr-preview'>19</div><input id='attrs-59423722-19c0-458d-bd9f-75c8d4829687' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-59423722-19c0-458d-bd9f-75c8d4829687' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-36c52ef4-25ba-4b54-857c-67343b0f5820' class='xr-var-data-in' type='checkbox'><label for='data-36c52ef4-25ba-4b54-857c-67343b0f5820' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>whp_name :</span></dt><dd>CASTNO</dd><dt><span>geometry :</span></dt><dd>geometry_container</dd></dl></div><div class='xr-var-data'><pre>array(19, dtype=int8)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>reference_pressure</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-fe7e8609-d95f-49ce-8255-a0daf30248ac' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fe7e8609-d95f-49ce-8255-a0daf30248ac' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-04bf27cf-f971-40fa-a778-dab6a840cf34' class='xr-var-data-in' type='checkbox'><label for='data-04bf27cf-f971-40fa-a778-dab6a840cf34' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>dbar</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>pressure</span></div><div class='xr-var-dims'>(pressure)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>404.0 532.0 ... 3.732e+03 3.86e+03</div><input id='attrs-0e3aca91-c925-4b70-b19e-cbc06bae0bf9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0e3aca91-c925-4b70-b19e-cbc06bae0bf9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-03593b53-1226-4aef-ac7f-1a16d638a62e' class='xr-var-data-in' type='checkbox'><label for='data-03593b53-1226-4aef-ac7f-1a16d638a62e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>whp_name :</span></dt><dd>CTDPRS</dd><dt><span>whp_unit :</span></dt><dd>DBAR</dd><dt><span>standard_name :</span></dt><dd>sea_water_pressure</dd><dt><span>units :</span></dt><dd>dbar</dd><dt><span>C_format :</span></dt><dd>%9.1f</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>positive :</span></dt><dd>down</dd></dl></div><div class='xr-var-data'><pre>array([ 404.,  532.,  660.,  788.,  916., 1044., 1172., 1300., 1428., 1556.,
       1684., 1812., 1940., 2068., 2196., 2324., 2452., 2580., 2708., 2836.,
       2964., 3092., 3220., 3348., 3476., 3604., 3732., 3860.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pres_mean</span></div><div class='xr-var-dims'>(pressure)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>277.0 405.0 ... 3.605e+03 3.733e+03</div><input id='attrs-3292e388-7c4e-4b11-a592-0f3a99cc2a8d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3292e388-7c4e-4b11-a592-0f3a99cc2a8d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bae84aca-80e5-4ef8-bcb0-14d910f3adec' class='xr-var-data-in' type='checkbox'><label for='data-bae84aca-80e5-4ef8-bcb0-14d910f3adec' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 277.,  405.,  533.,  661.,  789.,  917., 1045., 1173., 1301.,
       1429., 1557., 1685., 1813., 1941., 2069., 2197., 2325., 2453.,
       2581., 2709., 2837., 2965., 3093., 3221., 3349., 3477., 3605.,
       3733.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>segment</span></div><div class='xr-var-dims'>(segment)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 2 4 6 8 ... 246 248 250 252 254</div><input id='attrs-cb7901e5-c543-42a7-90f7-f8c08485211c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cb7901e5-c543-42a7-90f7-f8c08485211c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-019793de-7bf3-466d-8cd1-f7a4996014cd' class='xr-var-data-in' type='checkbox'><label for='data-019793de-7bf3-466d-8cd1-f7a4996014cd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0,   2,   4,   6,   8,  10,  12,  14,  16,  18,  20,  22,  24,  26,
        28,  30,  32,  34,  36,  38,  40,  42,  44,  46,  48,  50,  52,  54,
        56,  58,  60,  62,  64,  66,  68,  70,  72,  74,  76,  78,  80,  82,
        84,  86,  88,  90,  92,  94,  96,  98, 100, 102, 104, 106, 108, 110,
       112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138,
       140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166,
       168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194,
       196, 198, 200, 202, 204, 206, 208, 210, 212, 214, 216, 218, 220, 222,
       224, 226, 228, 230, 232, 234, 236, 238, 240, 242, 244, 246, 248, 250,
       252, 254])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4cc79327-cc0a-44b6-bf29-91b89ad1bdb7' class='xr-section-summary-in' type='checkbox'  ><label for='section-4cc79327-cc0a-44b6-bf29-91b89ad1bdb7' class='xr-section-summary' >Data variables: <span>(16)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>section_id</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;AR21b&#x27;</div><input id='attrs-4c10c4bc-8b4c-45f8-8a0a-9b8e886678fb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4c10c4bc-8b4c-45f8-8a0a-9b8e886678fb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-33e663f0-5a2c-4281-a5ed-5d76633692e9' class='xr-var-data-in' type='checkbox'><label for='data-33e663f0-5a2c-4281-a5ed-5d76633692e9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>whp_name :</span></dt><dd>SECT_ID</dd><dt><span>geometry :</span></dt><dd>geometry_container</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;AR21b&#x27;, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ctd_temperature</span></div><div class='xr-var-dims'>(pressure, segment)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>14.0 13.87 13.84 ... 2.389 2.392</div><input id='attrs-e92cfb8a-5da5-4c59-9c85-f345932beeca' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e92cfb8a-5da5-4c59-9c85-f345932beeca' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cea135b3-08fa-46b6-82dc-b599c5359583' class='xr-var-data-in' type='checkbox'><label for='data-cea135b3-08fa-46b6-82dc-b599c5359583' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>whp_name :</span></dt><dd>CTDTMP</dd><dt><span>whp_unit :</span></dt><dd>ITS-90</dd><dt><span>standard_name :</span></dt><dd>sea_water_temperature</dd><dt><span>units :</span></dt><dd>degC</dd><dt><span>reference_scale :</span></dt><dd>ITS-90</dd><dt><span>C_format :</span></dt><dd>%9.4f</dd><dt><span>ancillary_variables :</span></dt><dd>ctd_temperature_qc</dd></dl></div><div class='xr-var-data'><pre>array([[13.996, 13.869, 13.837, ...,  9.995,  9.941,  9.917],
       [12.363, 12.373, 12.367, ...,  5.956,  5.951,  5.944],
       [ 9.844,  9.903,  9.896, ...,  5.446,  5.441,  5.445],
       ...,
       [ 2.562,  2.559,  2.546, ...,  2.442,  2.451,  2.446],
       [ 2.487,  2.485,  2.48 , ...,  2.41 ,  2.407,  2.41 ],
       [ 2.448,  2.448,  2.448, ...,  2.393,  2.389,  2.392]],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ctd_temperature_qc</span></div><div class='xr-var-dims'>(pressure, segment)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>2.0 2.0 2.0 2.0 ... 2.0 2.0 2.0 2.0</div><input id='attrs-e447787b-3376-4ca1-b176-e1158e4bdf85' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e447787b-3376-4ca1-b176-e1158e4bdf85' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-76d9caa4-028e-44ce-8422-8fee685a234f' class='xr-var-data-in' type='checkbox'><label for='data-76d9caa4-028e-44ce-8422-8fee685a234f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>status_flag</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_flag_assigned not_calibrated acceptable_measurement questionable_measurement bad_measurement not_reported interpolated_over_a_pressure_interval_larger_than_2_dbar despiked not_sampled</dd><dt><span>conventions :</span></dt><dd>WOCECTD - WOCE Quality Codes for CTD instrument measurements</dd></dl></div><div class='xr-var-data'><pre>array([[2., 2., 2., ..., 2., 2., 2.],
       [2., 2., 2., ..., 2., 2., 2.],
       [2., 2., 2., ..., 2., 2., 2.],
       ...,
       [2., 2., 2., ..., 2., 2., 2.],
       [2., 2., 2., ..., 2., 2., 2.],
       [2., 2., 2., ..., 2., 2., 2.]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ctd_salinity</span></div><div class='xr-var-dims'>(pressure, segment)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>35.38 35.38 35.38 ... 34.89 34.89</div><input id='attrs-5fe47c2f-71ad-4151-a07f-37ed40d5ba94' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5fe47c2f-71ad-4151-a07f-37ed40d5ba94' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6aad9166-412b-4f6b-889f-4db8c5a082ce' class='xr-var-data-in' type='checkbox'><label for='data-6aad9166-412b-4f6b-889f-4db8c5a082ce' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>whp_name :</span></dt><dd>CTDSAL</dd><dt><span>whp_unit :</span></dt><dd>PSS-78</dd><dt><span>standard_name :</span></dt><dd>sea_water_salinity</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>reference_scale :</span></dt><dd>PSS-78</dd><dt><span>C_format :</span></dt><dd>%9.4f</dd><dt><span>ancillary_variables :</span></dt><dd>ctd_salinity_qc</dd></dl></div><div class='xr-var-data'><pre>array([[35.379, 35.376, 35.379, ..., 34.906, 34.91 , 34.909],
       [35.192, 35.195, 35.194, ..., 34.532, 34.532, 34.532],
       [34.897, 34.911, 34.913, ..., 34.513, 34.513, 34.514],
       ...,
       [34.908, 34.907, 34.903, ..., 34.894, 34.897, 34.895],
       [34.899, 34.899, 34.898, ..., 34.892, 34.891, 34.892],
       [34.896, 34.896, 34.896, ..., 34.891, 34.889, 34.89 ]],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ctd_salinity_qc</span></div><div class='xr-var-dims'>(pressure, segment)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>2.0 2.0 2.0 2.0 ... 2.0 2.0 2.0 2.0</div><input id='attrs-a814e392-a7fa-45fe-b4c8-76a54e5d293a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a814e392-a7fa-45fe-b4c8-76a54e5d293a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b46d416d-1ed6-49b2-a137-0e7b89bf6d86' class='xr-var-data-in' type='checkbox'><label for='data-b46d416d-1ed6-49b2-a137-0e7b89bf6d86' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>status_flag</dd><dt><span>flag_values :</span></dt><dd>[0 1 2 3 4 5 6 7 9]</dd><dt><span>flag_meanings :</span></dt><dd>no_flag_assigned not_calibrated acceptable_measurement questionable_measurement bad_measurement not_reported interpolated_over_a_pressure_interval_larger_than_2_dbar despiked not_sampled</dd><dt><span>conventions :</span></dt><dd>WOCECTD - WOCE Quality Codes for CTD instrument measurements</dd></dl></div><div class='xr-var-data'><pre>array([[2., 2., 2., ..., 2., 2., 2.],
       [2., 2., 2., ..., 2., 2., 2.],
       [2., 2., 2., ..., 2., 2., 2.],
       ...,
       [2., 2., 2., ..., 2., 2., 2.],
       [2., 2., 2., ..., 2., 2., 2.],
       [2., 2., 2., ..., 2., 2., 2.]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>profile_type</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;C&#x27;</div><input id='attrs-b93c2835-62fa-4df5-8c53-9d11a29aeb1d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b93c2835-62fa-4df5-8c53-9d11a29aeb1d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b02f4868-d174-4552-a461-fa206e584a3c' class='xr-var-data-in' type='checkbox'><label for='data-b02f4868-d174-4552-a461-fa206e584a3c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(&#x27;C&#x27;, dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>geometry_container</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan</div><input id='attrs-ea09402e-b188-46e7-98bf-919b26f04189' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ea09402e-b188-46e7-98bf-919b26f04189' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3ae91711-1a71-4457-a8b7-4efc83368fc4' class='xr-var-data-in' type='checkbox'><label for='data-3ae91711-1a71-4457-a8b7-4efc83368fc4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>geometry_type :</span></dt><dd>point</dd><dt><span>node_coordinates :</span></dt><dd>longitude latitude</dd></dl></div><div class='xr-var-data'><pre>array(nan)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>γ</span></div><div class='xr-var-dims'>(pressure, segment)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>26.54 26.57 26.58 ... 28.1 28.1</div><input id='attrs-66ac7136-7c52-4fc2-98a7-3e8b745c37e7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-66ac7136-7c52-4fc2-98a7-3e8b745c37e7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-488bb9cf-f26c-4ff2-b2de-7c5cf38d177e' class='xr-var-data-in' type='checkbox'><label for='data-488bb9cf-f26c-4ff2-b2de-7c5cf38d177e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>neutral_density</dd><dt><span>units :</span></dt><dd>kg/m3</dd><dt><span>long_name :</span></dt><dd>$γ_n$</dd></dl></div><div class='xr-var-data'><pre>array([[26.541239, 26.566978, 26.576508, ..., 26.975796, 26.98863 ,
        26.992172],
       [26.74396 , 26.74418 , 26.74467 , ..., 27.325842, 27.326574,
        27.327587],
       [26.996119, 26.996273, 26.999125, ..., 27.383345, 27.384216,
        27.384338],
       ...,
       [28.085022, 28.085041, 28.08506 , ..., 28.096266, 28.09627 ,
        28.09627 ],
       [28.091358, 28.09164 , 28.091845, ..., 28.100817, 28.100845,
        28.100847],
       [28.096346, 28.096376, 28.096405, ..., 28.103762, 28.103916,
        28.10394 ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>N2</span></div><div class='xr-var-dims'>(pressure, segment)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.377e-05 1.483e-05 ... -2.582e-06</div><input id='attrs-997affd5-f63f-48de-86ab-d8a0ba8c5f1d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-997affd5-f63f-48de-86ab-d8a0ba8c5f1d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4c634849-d7e8-4f3f-8c85-0118c957013e' class='xr-var-data-in' type='checkbox'><label for='data-4c634849-d7e8-4f3f-8c85-0118c957013e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 4.37680791e-05,  1.48312208e-05,  4.73837291e-06, ...,
         1.68648353e-05,  1.74886791e-05,  2.18544961e-06],
       [ 2.29621811e-06,  1.43986530e-06,  7.41253409e-06, ...,
         4.73582718e-06,  3.19693034e-07,  5.39240079e-06],
       [ 1.35492023e-05,  3.17093601e-06,  2.64434973e-06, ...,
         1.27107685e-06,  7.62273382e-07,  1.15745656e-07],
       ...,
       [-4.07379801e-06, -2.90621147e-07,  1.89295484e-06, ...,
        -2.99651830e-06,  2.17962714e-06,  1.83226394e-07],
       [ 5.63791173e-07,  1.39833071e-06, -2.37656554e-07, ...,
         1.33141164e-06,  1.88266167e-07, -9.53537987e-07],
       [ 1.83318164e-07, -1.81904599e-07,  1.36290282e-06, ...,
         1.29424653e-06,  2.96984115e-06, -2.58174075e-06]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>N2gsw</span></div><div class='xr-var-dims'>(pressure, segment)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0001185 4.387e-05 ... 3.051e-06</div><input id='attrs-74af723d-2fbf-4d84-a30d-014678804e0d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-74af723d-2fbf-4d84-a30d-014678804e0d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-039c1fe3-a21e-47c1-815c-c2f16313dfdd' class='xr-var-data-in' type='checkbox'><label for='data-039c1fe3-a21e-47c1-815c-c2f16313dfdd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 1.18506609e-04,  4.38686551e-05,  1.48307925e-05, ...,
         6.11738335e-05,  1.69535409e-05,  1.74934893e-05],
       [ 1.84632101e-06,  2.34153488e-06,  1.28642565e-06, ...,
         3.47290790e-06,  4.79624301e-06,  3.59136330e-07],
       [ 2.32988969e-06,  1.36381534e-05,  3.19817653e-06, ...,
         3.39959423e-06,  1.31906143e-06,  8.04467609e-07],
       ...,
       [-1.09324590e-06, -4.13324217e-06, -2.85213424e-07, ...,
         3.81394030e-06, -3.04332688e-06,  2.23381175e-06],
       [ 1.82940548e-06,  5.86523661e-07,  1.43137761e-06, ...,
        -9.62941362e-07,  1.36803456e-06,  2.03074796e-07],
       [ 1.97803878e-07,  1.97899500e-07, -1.71548886e-07, ...,
        -3.74424645e-06,  1.33841261e-06,  3.05149195e-06]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>σθ</span></div><div class='xr-var-dims'>(pressure, segment)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.026e+03 1.027e+03 ... 1.028e+03</div><input id='attrs-007a3c15-cd5f-4f54-aa5a-4a41110b5e0a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-007a3c15-cd5f-4f54-aa5a-4a41110b5e0a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bf7c30e7-cb0e-489f-b48b-d4636321e367' class='xr-var-data-in' type='checkbox'><label for='data-bf7c30e7-cb0e-489f-b48b-d4636321e367' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_potential_density</dd><dt><span>units :</span></dt><dd>kg/m3</dd></dl></div><div class='xr-var-data'><pre>array([[1026.48554736, 1026.50997682, 1026.51906077, ..., 1026.88743526,
        1026.89977443, 1026.90310077],
       [1026.6753066 , 1026.67574139, 1026.67618586, ..., 1027.1942568 ,
        1027.19490737, 1027.19580866],
       [1026.90609426, 1026.90711293, 1026.90989939, ..., 1027.24312459,
        1027.24374314, 1027.24407838],
       ...,
       [1027.87475613, 1027.87421834, 1027.87209017, ..., 1027.87545326,
        1027.87715653, 1027.87597129],
       [1027.87476483, 1027.87494355, 1027.87456259, ..., 1027.87753667,
        1027.8769906 , 1027.8775727 ],
       [1027.87663072, 1027.87664865, 1027.87666659, ..., 1027.87923339,
        1027.87796337, 1027.87854702]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>σ3</span></div><div class='xr-var-dims'>(pressure, segment)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.039e+03 1.039e+03 ... 1.042e+03</div><input id='attrs-655ea0f6-891a-41c7-b755-4d18aff769ef' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-655ea0f6-891a-41c7-b755-4d18aff769ef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8e4afaa9-e012-4d37-8142-72235f8a4d13' class='xr-var-data-in' type='checkbox'><label for='data-8e4afaa9-e012-4d37-8142-72235f8a4d13' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_water_potential_density</dd><dt><span>units :</span></dt><dd>kg/m3</dd></dl></div><div class='xr-var-data'><pre>array([[1039.31503359, 1039.34649341, 1039.35729086, ..., 1039.96225127,
        1039.9778912 , 1039.98275335],
       [1039.60123286, 1039.6010459 , 1039.6018722 , ..., 1040.5475624 ,
        1040.54858224, 1040.54999552],
       [1039.9905846 , 1039.98762847, 1039.99082545, ..., 1040.63432969,
        1040.63532335, 1040.63535899],
       ...,
       [1041.49449975, 1041.49423876, 1041.49324502, ..., 1041.50715796,
        1041.50809795, 1041.50737223],
       [1041.50173211, 1041.50208578, 1041.5021399 , ..., 1041.51295465,
        1041.51268711, 1041.51302664],
       [1041.50786789, 1041.50790355, 1041.50793922, ..., 1041.51717566,
        1041.51628729, 1041.51662858]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>N2θ</span></div><div class='xr-var-dims'>(pressure, segment)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0001127 7.98e-05 ... 3.154e-06</div><input id='attrs-1ed78f4c-4f41-4389-b47a-5a1f03be2a26' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1ed78f4c-4f41-4389-b47a-5a1f03be2a26' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d6005c96-13a4-4917-b853-e32437463ef9' class='xr-var-data-in' type='checkbox'><label for='data-d6005c96-13a4-4917-b853-e32437463ef9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 1.12710321e-04,  7.97977083e-05,  2.83347463e-05, ...,
         8.18469556e-05,  3.73006346e-05,  1.50479430e-05],
       [ 3.46432094e-06,  2.09357845e-06, -8.77930767e-07, ...,
         7.76676329e-06,  3.69508851e-06,  2.10305380e-06],
       [ 9.55322223e-06,  9.06027533e-06,  7.74120007e-06, ...,
         2.66161535e-06,  2.27105173e-06,  1.13356525e-06],
       ...,
       [ 8.50945482e-08, -6.34782784e-06, -6.15613438e-06, ...,
         3.13995285e-06,  1.23344261e-06, -1.25199511e-06],
       [-6.79401345e-07, -4.81531029e-07,  4.67834139e-07, ...,
        -1.25734817e-06,  8.57890363e-08,  1.42892624e-06],
       [ 1.61285432e-06,  8.54196699e-08, -1.06259803e-06, ...,
         2.73536830e-07, -1.63429040e-06,  3.15388149e-06]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>N23</span></div><div class='xr-var-dims'>(pressure, segment)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0001539 0.0001006 ... 2.376e-06</div><input id='attrs-ed0e6dab-9a06-440d-8ee5-f6ee2d3ea908' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ed0e6dab-9a06-440d-8ee5-f6ee2d3ea908' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1b93a181-3b07-4b22-b3fe-305fe47c499c' class='xr-var-data-in' type='checkbox'><label for='data-1b93a181-3b07-4b22-b3fe-305fe47c499c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 1.53909538e-04,  1.00617441e-04,  4.53640376e-05, ...,
         1.05203257e-04,  4.88168563e-05,  3.02238481e-05],
       [ 3.17135818e-07,  1.52231641e-06,  2.70809179e-05, ...,
         9.92620414e-06,  5.79342485e-06,  4.42562600e-06],
       [ 1.16079768e-05,  5.73495960e-07,  1.20843578e-05, ...,
         4.27524776e-06,  2.45081752e-06,  6.23508882e-07],
       ...,
       [ 1.67063852e-07, -2.98761426e-06, -2.60841705e-06, ...,
         2.36000997e-06,  5.10181958e-07, -5.47805691e-07],
       [ 5.85657835e-07,  9.70984896e-07,  9.25997557e-07, ...,
        -5.51342749e-07,  1.71415255e-07,  8.94173251e-07],
       [ 1.26511801e-06,  1.69853917e-07, -1.70633720e-07, ...,
         5.48361282e-07, -1.30264641e-06,  2.37552127e-06]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>N2γ</span></div><div class='xr-var-dims'>(pressure, segment)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0001192 8.398e-05 ... 6.358e-08</div><input id='attrs-ec654735-ed4b-41ea-822b-89dc487dec98' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ec654735-ed4b-41ea-822b-89dc487dec98' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f853ce6e-5f5e-4e56-88bc-effe7deefb11' class='xr-var-data-in' type='checkbox'><label for='data-f853ce6e-5f5e-4e56-88bc-effe7deefb11' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1.1915604e-04, 8.3977371e-05, 3.0650765e-05, ..., 8.5385247e-05,
        3.8993549e-05, 1.7830034e-05],
       [2.6068362e-06, 1.6939895e-06, 2.8066636e-06, ..., 8.2610368e-06,
        4.1554968e-06, 2.5977533e-06],
       [9.7642824e-06, 7.1574459e-06, 8.7515218e-06, ..., 3.4561019e-06,
        2.3661355e-06, 5.4044170e-07],
       ...,
       [6.8122901e-08, 9.0830532e-08, 6.3581375e-08, ..., 3.7240520e-07,
        9.0830534e-09, 1.8166106e-07],
       [9.1284687e-07, 1.1580893e-06, 6.7668748e-07, ..., 1.4078732e-07,
        7.2664427e-08, 7.2664427e-08],
       [2.5432550e-07, 1.4078732e-07, 4.1782044e-07, ..., 3.7240520e-07,
        4.2236198e-07, 6.3581375e-08]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pres</span></div><div class='xr-var-dims'>(pressure, segment)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>150.0 152.0 ... 3.858e+03 3.86e+03</div><input id='attrs-ee20191b-f696-4207-969c-41813b872a10' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ee20191b-f696-4207-969c-41813b872a10' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8d621327-836e-4ac7-a0b1-d7fd2ee7e60e' class='xr-var-data-in' type='checkbox'><label for='data-8d621327-836e-4ac7-a0b1-d7fd2ee7e60e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>whp_name :</span></dt><dd>CTDPRS</dd><dt><span>whp_unit :</span></dt><dd>DBAR</dd><dt><span>standard_name :</span></dt><dd>sea_water_pressure</dd><dt><span>units :</span></dt><dd>dbar</dd><dt><span>C_format :</span></dt><dd>%9.1f</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>positive :</span></dt><dd>down</dd></dl></div><div class='xr-var-data'><pre>array([[ 150.,  152.,  154., ...,  400.,  402.,  404.],
       [ 278.,  280.,  282., ...,  528.,  530.,  532.],
       [ 406.,  408.,  410., ...,  656.,  658.,  660.],
       ...,
       [3350., 3352., 3354., ..., 3600., 3602., 3604.],
       [3478., 3480., 3482., ..., 3728., 3730., 3732.],
       [3606., 3608., 3610., ..., 3856., 3858., 3860.]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-09448955-7595-4ca0-9a41-ca7ffe5c9ec7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-09448955-7595-4ca0-9a41-ca7ffe5c9ec7' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.8 CCHDO-1.0</dd><dt><span>cchdo_software_version :</span></dt><dd>hydro 1.0.1.2</dd><dt><span>cchdo_parameters_version :</span></dt><dd>params 0.1.9</dd><dt><span>featureType :</span></dt><dd>profile</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="section" id="compare-n2-estimates">
<h3>Compare N² estimates:<a class="headerlink" href="#compare-n2-estimates" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Kunze seems to be using something like N² using pot temp referenced to surface! What!</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">axx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;N2&quot;</span><span class="p">,</span> <span class="s2">&quot;N2γ&quot;</span><span class="p">,</span> <span class="s2">&quot;N2θ&quot;</span><span class="p">,</span> <span class="s2">&quot;N2gsw&quot;</span><span class="p">]:</span>
    <span class="n">segmented</span><span class="p">[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;segment&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">y</span><span class="o">=</span><span class="s2">&quot;pres_mean&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">var</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span>
    <span class="p">)</span>
<span class="c1"># (segmented.N2_γ.mean(&quot;segment&quot;)).plot(y=&quot;pres_mean&quot;, ax=axx[0], xscale=&quot;log&quot;)</span>
<span class="n">axx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kunze_cruise</span><span class="o">.</span><span class="n">N2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">kunze_cruise</span><span class="o">.</span><span class="n">z_mean</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;kunze&quot;</span><span class="p">)</span>
<span class="c1"># mod.N2mean.plot(hue=&quot;kind&quot;, ax=axx[0], y=&quot;depth_bin&quot;)</span>
<span class="n">axx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">segmented</span><span class="o">.</span><span class="n">γ</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;segment&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;pres_mean&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kunze_cruise</span><span class="o">.</span><span class="n">γ_mean</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">kunze_cruise</span><span class="o">.</span><span class="n">z_mean</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>

<span class="n">segmented</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;pres_mean&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">kunze_cruise</span><span class="o">.</span><span class="n">z_i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">kunze_cruise</span><span class="o">.</span><span class="n">z_mean</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="n">segmented</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">segment</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;pres_mean&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">axx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">kunze_cruise</span><span class="o">.</span><span class="n">z_f</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">kunze_cruise</span><span class="o">.</span><span class="n">z_mean</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>

<span class="n">segmented</span><span class="o">.</span><span class="n">γ</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">segment</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;pres_mean&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">axx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kunze_cruise</span><span class="o">.</span><span class="n">γ_i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">kunze_cruise</span><span class="o">.</span><span class="n">z_mean</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="n">segmented</span><span class="o">.</span><span class="n">γ</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">segment</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;pres_mean&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axx</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">axx</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kunze_cruise</span><span class="o">.</span><span class="n">γ_f</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">kunze_cruise</span><span class="o">.</span><span class="n">z_mean</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>

<span class="p">[</span><span class="n">aa</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="n">axx</span><span class="p">]</span>
<span class="p">[</span><span class="n">aa</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="n">axx</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">axx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">4200</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">f</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/iw-fine-devel_8_0.png" src="_images/iw-fine-devel_8_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dcpy.finestructure</span> <span class="kn">import</span> <span class="n">do_mixsea_shearstrain</span><span class="p">,</span> <span class="n">estimate_turb_segment</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;pressure&quot;</span><span class="p">:</span> <span class="n">segmented</span><span class="o">.</span><span class="n">pres_mean</span><span class="p">})</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="s2">&quot;ε&quot;</span><span class="p">,</span> <span class="s2">&quot;ξvar&quot;</span><span class="p">,</span> <span class="s2">&quot;ξvargm&quot;</span><span class="p">]:</span>
    <span class="n">results</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">segmented</span><span class="o">.</span><span class="n">pressure</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">segmented</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s2">&quot;pressure&quot;</span><span class="p">]):</span>
    <span class="n">seg</span> <span class="o">=</span> <span class="n">segmented</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="n">idx</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">set_coords</span><span class="p">(</span><span class="s2">&quot;pres&quot;</span><span class="p">)</span>
    <span class="p">(</span>
        <span class="n">results</span><span class="o">.</span><span class="n">K</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="n">results</span><span class="o">.</span><span class="n">ε</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="n">results</span><span class="o">.</span><span class="n">ξvar</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="n">results</span><span class="o">.</span><span class="n">ξvargm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
        <span class="n">_</span><span class="p">,</span>
        <span class="n">_</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="n">estimate_turb_segment</span><span class="p">(</span>
        <span class="n">seg</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="s2">&quot;sea_water_pressure&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">seg</span><span class="o">.</span><span class="n">N2</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
        <span class="n">seg</span><span class="o">.</span><span class="n">cf</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span>
        <span class="n">crit</span><span class="o">=</span><span class="s2">&quot;kunze&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------ mixsea&quot;</span><span class="p">)</span>

<span class="n">mod</span> <span class="o">=</span> <span class="n">do_mixsea_shearstrain</span><span class="p">(</span>
    <span class="n">profile</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">148</span><span class="p">,</span> <span class="kc">None</span><span class="p">)),</span> <span class="n">segmented</span><span class="o">.</span><span class="n">pres_mean</span><span class="o">.</span><span class="n">data</span>
<span class="p">)</span>

<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">ε</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kunze_cruise</span><span class="o">.</span><span class="n">ε</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">kunze_cruise</span><span class="o">.</span><span class="n">z_mean</span><span class="p">)</span>
<span class="n">mod</span><span class="o">.</span><span class="n">eps</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;kind&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth_bin&quot;</span><span class="p">)</span>

<span class="n">results</span><span class="o">.</span><span class="n">K</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kunze_cruise</span><span class="o">.</span><span class="n">K</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">kunze_cruise</span><span class="o">.</span><span class="n">z_mean</span><span class="p">)</span>
<span class="n">mod</span><span class="o">.</span><span class="n">krho</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;kind&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth_bin&quot;</span><span class="p">)</span>

<span class="n">mod</span><span class="o">.</span><span class="n">strain</span><span class="o">.</span><span class="n">coarsen</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">boundary</span><span class="o">=</span><span class="s2">&quot;trim&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">var</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;kind&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">ξvargm</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">ξvargm</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;kind&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">ξvar</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">mod</span><span class="o">.</span><span class="n">ξvar</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;kind&quot;</span><span class="p">)</span>

<span class="c1"># estimate_turb_segment(segmented.isel(pressure=5, drop=True).set_coords(&quot;pres&quot;), debug=True)#</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------ mixsea
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/deepak/miniconda3/envs/dcpy/lib/python3.8/site-packages/numpy/core/fromnumeric.py:3419: RuntimeWarning: Mean of empty slice.
  return _methods._mean(a, axis=axis, dtype=dtype,
/home/deepak/miniconda3/envs/dcpy/lib/python3.8/site-packages/numpy/core/_methods.py:188: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
/home/deepak/work/python/xarray/xarray/core/nputils.py:152: RuntimeWarning: Degrees of freedom &lt;= 0 for slice.
  result = getattr(npmodule, name)(values, axis=axis, **kwargs)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f0b5454e5b0&gt;,
 &lt;matplotlib.lines.Line2D at 0x7f0b5454e5e0&gt;]
</pre></div>
</div>
<img alt="_images/iw-fine-devel_9_3.png" src="_images/iw-fine-devel_9_3.png" />
<img alt="_images/iw-fine-devel_9_4.png" src="_images/iw-fine-devel_9_4.png" />
<img alt="_images/iw-fine-devel_9_5.png" src="_images/iw-fine-devel_9_5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">segmented</span><span class="o">.</span><span class="n">ctd_temperature</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="s2">&quot;segment&quot;</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:               (degree: 2, pressure: 28)
Coordinates:
  * degree                (degree) int64 1 0
  * pressure              (pressure) float64 404.0 532.0 ... 3.732e+03 3.86e+03
Data variables:
    polyfit_coefficients  (degree, pressure) float64 -0.01245 -0.02878 ... 2.438</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-19da2a12-5288-4f88-8440-355e16626b32' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-19da2a12-5288-4f88-8440-355e16626b32' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>degree</span>: 2</li><li><span class='xr-has-index'>pressure</span>: 28</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-0d21a685-32fe-4935-8cef-cc72240f7dc0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0d21a685-32fe-4935-8cef-cc72240f7dc0' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>degree</span></div><div class='xr-var-dims'>(degree)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 0</div><input id='attrs-aa17cf03-0356-4525-b845-a66597953d59' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-aa17cf03-0356-4525-b845-a66597953d59' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c416c06c-aa6c-43aa-a87c-745dcbfffea5' class='xr-var-data-in' type='checkbox'><label for='data-c416c06c-aa6c-43aa-a87c-745dcbfffea5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1, 0])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>pressure</span></div><div class='xr-var-dims'>(pressure)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>404.0 532.0 ... 3.732e+03 3.86e+03</div><input id='attrs-f4c9618f-011b-4428-9b63-41dfa02315ee' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f4c9618f-011b-4428-9b63-41dfa02315ee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-be9bb655-cfa2-47f4-adf3-92ae6af64470' class='xr-var-data-in' type='checkbox'><label for='data-be9bb655-cfa2-47f4-adf3-92ae6af64470' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 404.,  532.,  660.,  788.,  916., 1044., 1172., 1300., 1428., 1556.,
       1684., 1812., 1940., 2068., 2196., 2324., 2452., 2580., 2708., 2836.,
       2964., 3092., 3220., 3348., 3476., 3604., 3732., 3860.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-901b0273-2ae1-403b-aa37-24b98d695952' class='xr-section-summary-in' type='checkbox'  checked><label for='section-901b0273-2ae1-403b-aa37-24b98d695952' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>polyfit_coefficients</span></div><div class='xr-var-dims'>(degree, pressure)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.01245 -0.02878 ... 2.484 2.438</div><input id='attrs-f1ac03b5-6921-4ef6-b017-650ef9535af1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f1ac03b5-6921-4ef6-b017-650ef9535af1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5cc8dd6d-aecc-4365-be35-e7de3b7d2dce' class='xr-var-data-in' type='checkbox'><label for='data-5cc8dd6d-aecc-4365-be35-e7de3b7d2dce' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[-1.24475460e-02, -2.87833760e-02, -1.64239307e-02,
        -3.57453125e-03, -2.82412778e-03, -1.92586315e-03,
        -2.61825670e-04, -2.82020898e-04, -6.58043920e-04,
        -1.21086191e-03, -1.85757388e-03, -1.73998303e-03,
        -1.43382047e-03, -1.33599621e-03, -9.84765489e-04,
        -1.14968645e-03, -1.30315667e-03, -8.46881578e-04,
        -6.48393129e-04, -7.41518031e-04, -6.63791985e-04,
        -3.29986063e-04, -2.67809558e-04, -2.71622176e-04,
        -4.02151254e-04, -4.94131676e-04, -3.06328240e-04,
        -2.08798983e-04],
       [ 1.37042759e+01,  1.31632544e+01,  8.75928452e+00,
         5.93109046e+00,  5.42452359e+00,  4.99264712e+00,
         4.63026746e+00,  4.60402755e+00,  4.59796220e+00,
         4.55267008e+00,  4.44402908e+00,  4.20054036e+00,
         3.95786083e+00,  3.76781215e+00,  3.57185429e+00,
         3.45465082e+00,  3.31391497e+00,  3.11432740e+00,
         2.99384594e+00,  2.91758687e+00,  2.81716098e+00,
         2.71107232e+00,  2.66522277e+00,  2.63060540e+00,
         2.60490915e+00,  2.55980161e+00,  2.48366934e+00,
         2.43831436e+00]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8a091054-67a2-41d1-bf03-0d504096c5cf' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8a091054-67a2-41d1-bf03-0d504096c5cf' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
</div>
<div class="section" id="compare-to-mixsea-sensitivity-studies">
<h3>Compare to mixsea &amp; Sensitivity studies<a class="headerlink" href="#compare-to-mixsea-sensitivity-studies" title="Permalink to this headline">¶</a></h3>
<p>The real difference is because they do some funny interpolating of the spectrum that I do not understand: https://github.com/modscripps/mixsea/blob/2c1a27b5b18d8b28f1af17e6d7dbe0f505ef78d8/mixsea/helpers.py#L169-L178</p>
<p>If I comment out that interp step, spectra agree exactly.</p>
<p>Sensitivity</p>
<ol class="simple">
<li><p>The problem is that the cutoff wavenumber chosen depends a lot on spectrum; and then that determines how much of the GM spectrum is integrated. Taken together you get a lot of sensitivity just from that :/</p></li>
<li><p>Method of choosing the cutoff wavenumber matters too</p></li>
<li><p>So does Rω or shear-strain ratio.</p></li>
</ol>
<p>I think part of the disagreement is also because the mixsea thing isn’t using the same bins</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seg</span> <span class="o">=</span> <span class="n">segmented</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">pressure</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>

<span class="n">dp</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">N2</span> <span class="o">=</span> <span class="n">seg</span><span class="o">.</span><span class="n">N2gsw</span>
<span class="n">seg</span><span class="p">[</span><span class="s2">&quot;N2fit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">seg</span><span class="o">.</span><span class="n">N2</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">segment</span><span class="p">,</span> <span class="n">N2</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">seg</span><span class="o">.</span><span class="n">segment</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">ξ</span> <span class="o">=</span> <span class="p">(</span><span class="n">N2</span> <span class="o">-</span> <span class="n">seg</span><span class="o">.</span><span class="n">N2fit</span><span class="p">)</span> <span class="o">/</span> <span class="n">seg</span><span class="o">.</span><span class="n">N2fit</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">N2fit</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">Ptot</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">mixsea</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="n">ξ</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">dp</span><span class="p">,</span> <span class="n">ffttype</span><span class="o">=</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hamming&quot;</span><span class="p">)</span>

<span class="n">npts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ξ</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">window</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">get_window</span><span class="p">(</span><span class="s2">&quot;hann&quot;</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<span class="n">window</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">window</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">window</span><span class="p">))</span>
<span class="n">kz</span><span class="p">,</span> <span class="n">psd</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">periodogram</span><span class="p">(</span>
    <span class="n">ξ</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;hamming&quot;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">dp</span><span class="p">,</span> <span class="n">detrend</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="s2">&quot;density&quot;</span>
<span class="p">)</span>
<span class="c1"># psd /= np.sinc(kz * dp / 2 / np.pi) ** 2</span>

<span class="n">strain</span> <span class="o">=</span> <span class="n">mixsea</span><span class="o">.</span><span class="n">shearstrain</span><span class="o">.</span><span class="n">strain_polynomial_fits</span><span class="p">(</span>
    <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">gsw</span><span class="o">.</span><span class="n">z_from_p</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">pres_mean</span><span class="o">.</span><span class="n">data</span> <span class="o">-</span> <span class="mi">127</span> <span class="o">+</span> <span class="n">seg</span><span class="o">.</span><span class="n">segment</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">seg</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">data</span><span class="p">),</span>
    <span class="n">seg</span><span class="o">.</span><span class="n">ctd_temperature</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
    <span class="n">seg</span><span class="o">.</span><span class="n">ctd_salinity</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
    <span class="n">seg</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
    <span class="n">seg</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
    <span class="c1"># bin_width=64,</span>
    <span class="n">depth_bin</span><span class="o">=</span><span class="p">[</span><span class="n">seg</span><span class="o">.</span><span class="n">pres_mean</span><span class="o">.</span><span class="n">data</span><span class="p">],</span>
    <span class="n">window_size</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span>
<span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Ptot</span><span class="p">,</span> <span class="s2">&quot;x-&quot;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">imix</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mixsea</span><span class="o">.</span><span class="n">shearstrain</span><span class="o">.</span><span class="n">find_cutoff_wavenumber</span><span class="p">(</span><span class="n">Ptot</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">)</span>
<span class="n">dcpy</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">linex</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">imix</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Ptot</span><span class="p">[</span><span class="n">imix</span><span class="p">]),</span> <span class="n">m</span><span class="p">[</span><span class="n">imix</span><span class="p">]),</span>
    <span class="n">mixsea</span><span class="o">.</span><span class="n">shearstrain</span><span class="o">.</span><span class="n">gm_strain_variance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">imix</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">strain</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;N2mean&quot;</span><span class="p">]))[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">kz</span><span class="p">,</span> <span class="n">psd</span><span class="p">,</span> <span class="s2">&quot;.-&quot;</span><span class="p">)</span>
<span class="n">imix</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mixsea</span><span class="o">.</span><span class="n">shearstrain</span><span class="o">.</span><span class="n">find_cutoff_wavenumber</span><span class="p">(</span><span class="n">psd</span><span class="p">,</span> <span class="n">kz</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">)</span>
<span class="n">dcpy</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">linex</span><span class="p">(</span><span class="n">kz</span><span class="p">[</span><span class="n">imix</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">psd</span><span class="p">[</span><span class="n">imix</span><span class="p">],</span> <span class="n">kz</span><span class="p">[</span><span class="n">imix</span><span class="p">]),</span>
    <span class="n">mixsea</span><span class="o">.</span><span class="n">shearstrain</span><span class="o">.</span><span class="n">gm_strain_variance</span><span class="p">(</span><span class="n">kz</span><span class="p">,</span> <span class="n">imix</span><span class="p">,</span> <span class="n">N</span><span class="o">.</span><span class="n">data</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">1e-3</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">strain</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;N2&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">N2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">strain</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;N2smooth&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C0&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">seg</span><span class="o">.</span><span class="n">N2fit</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">strain</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;strain&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ξ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.19514013600229327 0.11266552715618153
0.1987434107341453 0.0940107853774018
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f0b547b8af0&gt;]
</pre></div>
</div>
<img alt="_images/iw-fine-devel_12_2.png" src="_images/iw-fine-devel_12_2.png" />
<img alt="_images/iw-fine-devel_12_3.png" src="_images/iw-fine-devel_12_3.png" />
<img alt="_images/iw-fine-devel_12_4.png" src="_images/iw-fine-devel_12_4.png" />
</div>
</div>
<p>GM spectrum is right</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># GM 75; Kunze et al (2017)</span>
<span class="n">E0</span> <span class="o">=</span> <span class="mf">6.3e-5</span>  <span class="c1"># nondim spectral energy level</span>
<span class="n">jstar</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># peak mode numebr</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">1300</span>  <span class="c1"># m; stratification length scale</span>
<span class="n">N0</span> <span class="o">=</span> <span class="mf">5.24e-3</span>  <span class="c1"># rad/s</span>
<span class="n">K_0</span> <span class="o">=</span> <span class="mf">5e-6</span>  <span class="c1"># m²/s for a mixing efficiency of Γ=0.2</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">N0</span>

<span class="n">kz</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>  <span class="c1"># np.fft.fftfreq(n=1024, d=0.1)[:64]</span>
<span class="n">kzstar</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">jstar</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="n">N0</span><span class="p">)</span>
<span class="n">ξgm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">E0</span> <span class="o">*</span> <span class="n">b</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">jstar</span> <span class="o">*</span> <span class="n">kz</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">kz</span> <span class="o">+</span> <span class="n">kzstar</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">kz</span><span class="p">,</span> <span class="n">ξgm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">ξgm</span><span class="p">,</span> <span class="n">kz</span><span class="p">))</span>

<span class="n">Sgm</span><span class="p">,</span> <span class="n">Pgm</span> <span class="o">=</span> <span class="n">mixsea</span><span class="o">.</span><span class="n">shearstrain</span><span class="o">.</span><span class="n">gm_strain_variance</span><span class="p">(</span><span class="n">kz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">kz</span><span class="p">)),</span> <span class="mf">5.24e-3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Sgm</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kz</span><span class="p">,</span> <span class="n">Pgm</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.22007432494266535
0.22007432494266535
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f0b66d978e0&gt;]
</pre></div>
</div>
<img alt="_images/iw-fine-devel_14_2.png" src="_images/iw-fine-devel_14_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coeffs</span> <span class="o">=</span> <span class="n">segmented</span><span class="o">.</span><span class="n">N2</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">deg</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;segment&quot;</span><span class="p">)</span>
<span class="n">smoothed</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">segmented</span><span class="o">.</span><span class="n">segment</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;polyfit_coefficients&quot;</span><span class="p">:</span> <span class="s2">&quot;N2smooth&quot;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">stacked</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">smoothed</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="s2">&quot;segment&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">pres</span><span class="o">=</span><span class="n">segmented</span><span class="o">.</span><span class="n">pres</span><span class="p">)</span>
    <span class="o">.</span><span class="n">stack</span><span class="p">({</span><span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="s2">&quot;segment&quot;</span><span class="p">)})</span>
<span class="p">)</span>
<span class="n">p0</span><span class="p">,</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">stacked</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stacked</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">N2smth</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">stacked</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;pres&quot;</span><span class="p">:</span> <span class="s2">&quot;pressure&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="s2">&quot;pressure&quot;</span><span class="p">})</span><span class="o">.</span><span class="n">N2smooth</span>
<span class="p">)</span>
<span class="n">N2smth</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">)</span>
<span class="n">mod</span><span class="o">.</span><span class="n">N2smooth</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;depth&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;kind&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f0b66b6f8b0&gt;,
 &lt;matplotlib.lines.Line2D at 0x7f0b66b6f8e0&gt;]
</pre></div>
</div>
<img alt="_images/iw-fine-devel_15_1.png" src="_images/iw-fine-devel_15_1.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="iw-fine-estimates.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Existing finestructure estimates</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="compare-Ke-estimates.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Compare different <span class="math notranslate nohighlight">\(K_e\)</span> estimates</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Deepak Cherian<br/>
    
        &copy; Copyright 2021.<br/>
      <div class="extra_footer">
        <div>
<script data-goatcounter="https://count.cherian.net/count"
        async src="count.js"></script>
</div>

      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>