

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>P06 CTD χpod analysis &#8212; Eddy Diffusivity</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Compare different \(K_e\) estimates" href="compare-Ke-estimates.html" />
    <link rel="prev" title="BoB ASIRI 2013 CTD χpod" href="BoB-ctd-chipod.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Eddy Diffusivity</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <p class="caption">
 <span class="caption-text">
  Moored χpod analysis
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="tao.html">
   TAO χpod analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tao.html#id1">
   —
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  CTD χpod analysis
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="BoB-ctd-chipod.html">
   BoB ASIRI 2013 CTD χpod
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   P06 CTD χpod analysis
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Ancillary analysis
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="compare-Ke-estimates.html">
   Compare different
   <span class="math notranslate nohighlight">
    \(K_e\)
   </span>
   estimates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="calc-gradients.html">
   Gradient calculation
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/P06.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/dcherian/eddydiff"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#read-ctd-pod-data-and-convert-to-netcdf">
   Read CTD χpod data and convert to netCDF
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#read-transect-ancillary-datasets">
   Read transect + ancillary datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plots">
   plots
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate">
   Calculate
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-2">
   Calculate 2
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calculate-3">
   Calculate 3
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="p06-ctd-pod-analysis">
<h1>P06 CTD χpod analysis<a class="headerlink" href="#p06-ctd-pod-analysis" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="kn">import</span> <span class="nn">dcpy</span>
<span class="kn">import</span> <span class="nn">seawater</span> <span class="k">as</span> <span class="nn">sw</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="read-ctd-pod-data-and-convert-to-netcdf">
<h2>Read CTD χpod data and convert to netCDF<a class="headerlink" href="#read-ctd-pod-data-and-convert-to-netcdf" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;/home/deepak/work/eddydiff/datasets/P06/P06-means.mat&#39;</span>

<span class="n">mat</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">squeeze_me</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">p06</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>

<span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cast&#39;</span><span class="p">,</span> <span class="s1">&#39;pres&#39;</span><span class="p">]</span>
<span class="n">coords</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cast&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;pres&#39;</span><span class="p">:</span> <span class="n">mat</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)}</span>

<span class="k">for</span> <span class="n">varname</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;chi&#39;</span><span class="p">,</span> <span class="s1">&#39;eps&#39;</span><span class="p">,</span> <span class="s1">&#39;Jq&#39;</span><span class="p">,</span> <span class="s1">&#39;KT&#39;</span><span class="p">,</span> <span class="s1">&#39;N2&#39;</span><span class="p">,</span> <span class="s1">&#39;dTdz&#39;</span><span class="p">,</span> <span class="s1">&#39;TPvar&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">]:</span>
    <span class="n">p06</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">mat</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">varname</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;dnum&#39;</span><span class="p">,</span> <span class="s1">&#39;dist&#39;</span><span class="p">]:</span>
    <span class="n">p06</span><span class="p">[</span><span class="n">varname</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">mat</span><span class="p">[</span><span class="n">varname</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cast&#39;</span><span class="p">],</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cast&#39;</span><span class="p">:</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;cast&#39;</span><span class="p">]})</span>

<span class="n">p06</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;dnum&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">})</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">dcpy</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">datenum2datetime</span><span class="p">(</span><span class="n">p06</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;sigma_0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">sw</span><span class="o">.</span><span class="n">pden</span><span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">p06</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">],</span> <span class="n">p06</span><span class="p">[</span><span class="s1">&#39;pres&#39;</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;sigma_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">sw</span><span class="o">.</span><span class="n">pden</span><span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">p06</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">],</span> <span class="n">p06</span><span class="p">[</span><span class="s1">&#39;pres&#39;</span><span class="p">],</span> <span class="mi">1000</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;sigma_2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">sw</span><span class="o">.</span><span class="n">pden</span><span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">p06</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">],</span> <span class="n">p06</span><span class="p">[</span><span class="s1">&#39;pres&#39;</span><span class="p">],</span> <span class="mi">2000</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;sigma_4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">sw</span><span class="o">.</span><span class="n">pden</span><span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">p06</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">],</span> <span class="n">p06</span><span class="p">[</span><span class="s1">&#39;pres&#39;</span><span class="p">],</span> <span class="mi">4000</span><span class="p">),</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">sw</span><span class="o">.</span><span class="n">dens</span><span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">p06</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">],</span> <span class="n">p06</span><span class="p">[</span><span class="s1">&#39;pres&#39;</span><span class="p">]),</span> <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span>
<span class="n">p06</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;pres&#39;</span><span class="p">:</span> <span class="s1">&#39;P&#39;</span><span class="p">})</span>
<span class="c1"># code expects P as pressure index vector; pres as actual 2D pressure</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;pres&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">broadcast</span><span class="p">(</span><span class="n">p06</span><span class="p">[</span><span class="s1">&#39;cast&#39;</span><span class="p">],</span> <span class="n">p06</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">])[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">p06</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">set_coords</span><span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;dist&#39;</span><span class="p">,</span> <span class="s1">&#39;pres&#39;</span><span class="p">])</span>

<span class="c1"># reset co-ords to match ECCO/argo fields.</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">][</span><span class="n">p06</span><span class="o">.</span><span class="n">lon</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">360</span>
<span class="n">p06</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;cast&#39;</span><span class="p">)</span>
<span class="n">p06</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">301</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;cast&#39;</span><span class="p">)</span>

<span class="c1"># fill in NaNs</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">interpolate_na</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;cast&#39;</span><span class="p">)</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">interpolate_na</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;cast&#39;</span><span class="p">)</span>

<span class="c1"># add in bathymetry</span>
<span class="n">etopo</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;/home/deepak/datasets/ETOPO2v2g_f4.nc4&#39;</span><span class="p">,</span> <span class="n">autoclose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mf">180.</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">etopo</span> <span class="o">=</span> <span class="n">dcpy</span><span class="o">.</span><span class="n">oceans</span><span class="o">.</span><span class="n">dataset_center_pacific</span><span class="p">(</span><span class="n">etopo</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="s1">&#39;lat&#39;</span><span class="p">}))</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;bathy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">etopo</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">p06</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">p06</span><span class="o">.</span><span class="n">lat</span><span class="p">)</span><span class="o">.</span><span class="n">z</span>

<span class="n">p06</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;P06 merged dataset&#39;</span>
<span class="n">p06</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;transect_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;P06&#39;</span>
<span class="n">p06</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s1">&#39;/home/deepak/work/eddydiff/datasets/P06/p06.nc&#39;</span><span class="p">)</span>
<span class="n">p06</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/home/deepak/miniconda3/envs/dcpy/lib/python3.7/site-packages/ipykernel_launcher.py:31: DeprecationWarning: dropping labels using list-like labels is deprecated; using dict-like arguments with `drop_sel`, e.g. `ds.drop_sel(dim=[labels]).
/home/deepak/miniconda3/envs/dcpy/lib/python3.7/site-packages/ipykernel_launcher.py:32: DeprecationWarning: dropping labels using list-like labels is deprecated; using dict-like arguments with `drop_sel`, e.g. `ds.drop_sel(dim=[labels]).
/home/deepak/miniconda3/envs/dcpy/lib/python3.7/site-packages/ipykernel_launcher.py:39: FutureWarning: The autoclose argument is no longer used by xarray.open_dataset() and is now ignored; it will be removed in a future version of xarray. If necessary, you can control the maximum number of simultaneous open files with xarray.set_options(file_cache_maxsize=...).
/home/deepak/miniconda3/envs/dcpy/lib/python3.7/site-packages/ipykernel_launcher.py:39: DeprecationWarning: dropping labels using list-like labels is deprecated; using dict-like arguments with `drop_sel`, e.g. `ds.drop_sel(dim=[labels]).
</pre>
</div>
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt, dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:  (P: 601, cast: 247)
Coordinates:
  * cast     (cast) int64 3 4 5 6 7 8 9 10 ... 242 243 244 245 246 247 248 249
  * P        (P) float32 0.0 10.0 20.0 30.0 40.0 ... 5970.0 5980.0 5990.0 6000.0
    lat      (cast) float64 -30.08 -30.08 -30.08 -30.08 ... -32.5 -32.5 -32.5
    lon      (cast) float64 153.6 153.7 153.7 153.8 ... 288.0 288.1 288.3 288.3
    time     (cast) datetime64[ns] 2017-07-04T15:05:44 ... 2017-09-29T08:10:46
    dist     (cast) float64 0.0 7.686 14.41 ... 1.161e+04 1.162e+04 1.163e+04
    pres     (cast, P) float32 0.0 10.0 20.0 30.0 ... 5980.0 5990.0 6000.0
Data variables:
    chi      (cast, P) float64 nan nan nan nan nan nan ... nan nan nan nan nan
    eps      (cast, P) float64 nan nan nan nan nan nan ... nan nan nan nan nan
    Jq       (cast, P) float64 nan nan nan nan nan nan ... nan nan nan nan nan
    KT       (cast, P) float64 nan nan nan nan nan nan ... nan nan nan nan nan
    N2       (cast, P) float64 nan nan nan nan nan nan ... nan nan nan nan nan
    dTdz     (cast, P) float64 nan nan nan nan nan nan ... nan nan nan nan nan
    TPvar    (cast, P) float64 0.0536 nan nan nan nan ... nan nan nan nan nan
    T        (cast, P) float64 nan nan nan nan nan nan ... nan nan nan nan nan
    S        (cast, P) float64 nan nan nan nan nan nan ... nan nan nan nan nan
    sigma_0  (cast, P) float64 nan nan nan nan nan nan ... nan nan nan nan nan
    sigma_1  (cast, P) float64 nan nan nan nan nan nan ... nan nan nan nan nan
    sigma_2  (cast, P) float64 nan nan nan nan nan nan ... nan nan nan nan nan
    sigma_4  (cast, P) float64 nan nan nan nan nan nan ... nan nan nan nan nan
    rho      (cast, P) float64 nan nan nan nan nan nan ... nan nan nan nan nan
    bathy    (cast) float64 -874.2 -1.849e+03 -1.945e+03 ... -1.143e+03 -539.5
Attributes:
    name:           P06 merged dataset
    transect_name:  P06</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-97e154bd-ae72-4d2d-ae40-67b59972ebaa' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-97e154bd-ae72-4d2d-ae40-67b59972ebaa' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>P</span>: 601</li><li><span class='xr-has-index'>cast</span>: 247</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-2c0007b1-8c4a-453c-9d3b-1d02ef6ebedb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2c0007b1-8c4a-453c-9d3b-1d02ef6ebedb' class='xr-section-summary' >Coordinates: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>cast</span></div><div class='xr-var-dims'>(cast)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>3 4 5 6 7 8 ... 245 246 247 248 249</div><input id='attrs-dd939c2c-747f-4e92-9d36-5ffb945b9562' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dd939c2c-747f-4e92-9d36-5ffb945b9562' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4bb9137c-beda-4033-ab5d-f96392fd20b7' class='xr-var-data-in' type='checkbox'><label for='data-4bb9137c-beda-4033-ab5d-f96392fd20b7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([  3,   4,   5, ..., 247, 248, 249])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>P</span></div><div class='xr-var-dims'>(P)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 10.0 20.0 ... 5990.0 6000.0</div><input id='attrs-c1320db3-d82d-4218-8da6-9bd998f8107f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c1320db3-d82d-4218-8da6-9bd998f8107f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9f05a553-faa7-43be-b62c-b01fbad5af00' class='xr-var-data-in' type='checkbox'><label for='data-9f05a553-faa7-43be-b62c-b01fbad5af00' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([   0.,   10.,   20., ..., 5980., 5990., 6000.], dtype=float32)</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(cast)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-30.08 -30.08 ... -32.5 -32.5</div><input id='attrs-4da26aa8-0b21-4165-9ca8-bd94e20cc5ce' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4da26aa8-0b21-4165-9ca8-bd94e20cc5ce' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9bef7569-e565-4064-9d0b-2c6528aab673' class='xr-var-data-in' type='checkbox'><label for='data-9bef7569-e565-4064-9d0b-2c6528aab673' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([-30.08000931, -30.07990701, -30.07994267, -30.07979357,
       -30.07972444, -30.07963117, -30.07963874, -30.0800002 ,
       -30.08017466, -30.08067745, -30.08041094, -30.08012064,
       -30.079636  , -30.08015508, -30.08017851, -30.07998496,
       -30.07938677, -30.07986012, -30.07956576, -30.0800244 ,
       -30.08002036, -30.07957675, -30.07988803, -30.3300538 ,
       -30.07967409, -30.0800866 , -30.08005776, -30.07989679,
       -30.07999033, -30.08008387, -30.08014646, -30.07996676,
       -30.07989603, -30.07982529, -30.08002398, -30.07981347,
       -30.07998012, -30.07990572, -30.07997626, -30.08005633,
       -30.07985824, -30.07989644, -30.07938865, -30.08000028,
       -30.07993029, -30.07993996, -30.07994963, -30.07991145,
       -30.07983285, -30.07996   , -30.08001475, -30.0800875 ,
       -30.08027628, -30.07949068, -30.08037286, -30.07955234,
       -30.07978068, -30.08016517, -30.08010256, -30.08003995,
       -30.079732  , -30.07981247, -30.0799932 , -30.08024533,
       -30.0799267 , -30.08015542, -30.07994162, -30.07999202,
       -30.07990461, -30.0798172 , -30.07972978, -30.07998194,
       -30.22892137, -30.37786079, -30.52680021, -30.9819651 ,
       -31.44032214, -31.89674896, -32.22817457, -32.49998046,
       -32.50004255, -32.49943328, -32.49924618, -32.49991781,
       -32.50000948, -32.50024586, -32.49981537, -32.50005688,
       -32.4997078 , -32.50005834, -32.49981161, -32.49978176,
       -32.50014335, -32.49987327, -32.49991956, -32.50022264,
       -32.50007172, -32.50000981, -32.5015    , -32.50002134,
       -32.50006002, -32.50011653, -32.50014588, -32.49949393,
       -32.49982383, -32.49981014, -32.49984547, -32.49989889,
       -32.49999309, -32.49959492, -32.49989563, -32.4997958 ,
       -32.50028495, -32.49998126, -32.49966822, -32.50058752,
       -32.50009719, -32.49991051, -32.49972382, -32.49934068,
       -32.49988841, -32.4996531 , -32.49989526, -32.4995631 ,
       -32.49992425, -32.49978828, -32.49970013, -32.49994992,
       -32.50002263, -32.4997709 , -32.50000719, -32.4998304 ,
       -32.49978203, -32.49994681, -32.49951663, -32.50011777,
       -32.50003216, -32.50002742, -32.50002268, -32.50001795,
       -32.49979187, -32.4995658 , -32.5002053 , -32.49983852,
       -32.50014317, -32.50103085, -32.50067051, -32.49990098,
       -32.5002384 , -32.50539054, -32.49999557, -32.50002401,
       -32.49978945, -32.49924079, -32.50010772, -32.49994551,
       -32.49999063, -32.50018241, -32.49994581, -32.49994974,
       -32.49997015, -32.49954306, -32.49981527, -32.49994644,
       -32.49931138, -32.50055101, -32.49971653, -32.49862709,
       -32.50069981, -32.50010346, -32.50041802, -32.50043414,
       -32.50022827, -32.49991409, -32.50010658, -32.50122387,
       -32.50019398, -32.50001844, -32.5008663 , -32.50019332,
       -32.50005819, -32.49958459, -32.50007425, -32.50043157,
       -32.49988585, -32.4999654 , -32.50051191, -32.50002141,
       -32.50082314, -32.50023167, -32.5007821 , -32.5000077 ,
       -32.49991089, -32.49997511, -32.50003933, -32.50010356,
       -32.50016778, -32.50016509, -32.49976072, -32.49993991,
       -32.50041287, -32.50036411, -32.50020519, -32.50003499,
       -32.50008865, -32.49996467, -32.50048838, -32.50033364,
       -32.50000353, -32.50010281, -32.49974529, -32.50004339,
       -32.4999657 , -32.49984503, -32.50002701, -32.49989069,
       -32.50023277, -32.50008455, -32.50019378, -32.49950448,
       -32.49968897, -32.50004811, -32.49996725, -32.50039084,
       -32.4999238 , -32.50067803, -32.49965734, -32.49999095,
       -32.5003174 , -32.49980376, -32.49983243, -32.49997115,
       -32.49979847, -32.49956607, -32.50029331, -32.4998111 ,
       -32.49967009, -32.49980749, -32.49975444, -32.49974506,
       -32.49951459, -32.50006636, -32.49992692, -32.49995602,
       -32.49987965, -32.50000403, -32.49998012])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(cast)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>153.6 153.7 153.7 ... 288.3 288.3</div><input id='attrs-8c014c07-c00a-4b62-af2e-763b29391155' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8c014c07-c00a-4b62-af2e-763b29391155' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-13ef5e3d-d5c3-4b4e-84fa-26909756b26a' class='xr-var-data-in' type='checkbox'><label for='data-13ef5e3d-d5c3-4b4e-84fa-26909756b26a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([153.59994049, 153.67986975, 153.74977509, 153.83373928,
       153.91985764, 153.96003583, 153.99978093, 154.15993738,
       154.50005908, 154.99991379, 155.48996752, 155.99025048,
       156.23201065, 156.50016696, 156.71021192, 156.92008395,
       157.12011463, 157.27994152, 157.39950356, 157.66980294,
       158.00003076, 158.33972223, 158.68061589, 159.07988723,
       159.50010286, 159.75005393, 160.00003858, 160.49971623,
       160.99986543, 161.50001464, 162.00014596, 162.49976586,
       163.00006963, 163.5003734 , 163.92055803, 164.1205346 ,
       164.33995194, 164.83024109, 165.12016102, 165.40926381,
       165.66956967, 166.067091  , 166.47007977, 167.00042679,
       167.25020124, 167.50007352, 167.74994579, 168.00043627,
       168.14194362, 168.25209783, 168.49957752, 168.99949172,
       169.49832964, 170.00028308, 170.22396474, 170.49818454,
       170.99993892, 171.15915115, 171.26954279, 171.37993444,
       171.49969805, 171.9994197 , 172.4998588 , 172.79919216,
       172.99987545, 173.15003345, 173.29986853, 173.4995707 ,
       173.99912582, 174.49868094, 174.99823606, 175.49990747,
       175.98054567, 176.46118387, 176.94182207, 177.3993005 ,
       177.85399683, 178.31028594, 178.63857596, 178.90984129,
       179.10344991, 179.42113635, 179.92185491, 180.50095584,
       180.74997892, 181.09069639, 181.35051016, 181.53018106,
       181.72150818, 182.0003126 , 182.33012434, 182.75019381,
       183.25000726, 183.7502328 , 184.25004387, 184.74052292,
       185.16011509, 185.6702591 , 186.14518   , 186.61685705,
       187.08983661, 187.58060094, 187.91354724, 188.08027665,
       188.23996977, 188.41033799, 188.75021346, 189.25083145,
       189.75009724, 190.24993981, 190.90156785, 191.55526175,
       192.2066992 , 192.85842541, 193.50833239, 194.1844112 ,
       194.83635838, 195.5054839 , 196.17460941, 196.8367485 ,
       197.51150811, 198.1664535 , 198.85023063, 199.54407964,
       200.28331543, 201.02345269, 201.79057996, 202.38341402,
       203.05362766, 203.72419071, 204.39339229, 205.0631566 ,
       205.73157741, 206.40155883, 207.07076886, 207.74152169,
       208.41160329, 209.08162775, 209.75165221, 210.42167667,
       210.72622122, 211.03076578, 211.82048556, 212.61029957,
       213.40090376, 214.29057669, 215.17993931, 216.06968428,
       216.9595332 , 217.74816065, 218.74034774, 219.63001466,
       220.51966967, 221.41191781, 222.30114858, 223.19191833,
       224.08216219, 224.97238795, 225.86219213, 226.75431145,
       227.64173185, 228.53376457, 229.42189338, 230.31171148,
       231.20060515, 232.03125945, 232.86202953, 233.69127385,
       234.12355667, 234.82870277, 235.57972786, 236.25688535,
       237.00111309, 237.78408077, 238.66378999, 239.4452746 ,
       240.27417238, 241.10436118, 241.93443314, 242.76439285,
       243.59460453, 244.42451573, 245.25472563, 246.08411452,
       246.9143004 , 247.60455655, 248.29513487, 248.98465808,
       249.67444987, 250.40958104, 251.05362587, 251.74417698,
       252.43415039, 253.12411421, 253.81407804, 254.50404186,
       255.19400569, 255.88470099, 256.57379632, 257.26454015,
       257.95386376, 258.64437902, 259.33499524, 260.22495557,
       261.11490086, 262.00466599, 262.89513573, 263.78501903,
       264.67469982, 265.56588692, 266.45519487, 267.34463424,
       268.23477488, 269.12476876, 270.01478078, 270.90394506,
       271.79516246, 272.68481092, 273.57469422, 274.46415112,
       275.35474206, 276.24435847, 277.13304069, 278.02374421,
       278.91456401, 279.80670804, 280.69445721, 281.58476078,
       282.47519567, 283.36426631, 284.25458568, 285.14439209,
       286.03518736, 286.80381697, 286.91782081, 287.0452288 ,
       287.17664917, 287.31747009, 287.44226043, 287.52442071,
       287.59567404, 287.66434715, 287.80426707, 287.97559135,
       288.13227635, 288.25101035, 288.34135038])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>(cast)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2017-07-04T15:05:44 ... 2017-09-...</div><input id='attrs-1aa8e530-4fb1-463e-8d12-1a1c2f5200b6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1aa8e530-4fb1-463e-8d12-1a1c2f5200b6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d973ccb8-1793-4792-bb62-4ea42bb4aa86' class='xr-var-data-in' type='checkbox'><label for='data-d973ccb8-1793-4792-bb62-4ea42bb4aa86' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([&#x27;2017-07-04T15:05:44.000000000&#x27;, &#x27;2017-07-04T19:58:21.000000000&#x27;,
       &#x27;2017-07-05T00:40:38.000000000&#x27;, &#x27;2017-07-05T05:27:54.000000000&#x27;,
       &#x27;2017-07-05T10:33:11.000000000&#x27;, &#x27;2017-07-05T17:01:14.000000000&#x27;,
       &#x27;2017-07-05T23:58:09.000000000&#x27;, &#x27;2017-07-06T07:10:37.000000000&#x27;,
       &#x27;2017-07-06T13:38:15.000000000&#x27;, &#x27;2017-07-06T20:52:41.000000000&#x27;,
       &#x27;2017-07-07T04:14:37.000000000&#x27;, &#x27;2017-07-07T10:39:14.000000000&#x27;,
       &#x27;2017-07-07T16:35:13.000000000&#x27;, &#x27;2017-07-07T23:18:29.000000000&#x27;,
       &#x27;2017-07-08T04:46:09.000000000&#x27;, &#x27;2017-07-08T10:13:22.000000000&#x27;,
       &#x27;2017-07-08T15:40:00.000000000&#x27;, &#x27;2017-07-08T20:37:00.000000000&#x27;,
       &#x27;2017-07-09T01:08:00.000000000&#x27;, &#x27;2017-07-09T05:26:41.000000000&#x27;,
       &#x27;2017-07-09T09:36:40.000000000&#x27;, &#x27;2017-07-09T14:12:24.000000000&#x27;,
       &#x27;2017-07-09T19:08:24.000000000&#x27;, &#x27;2017-07-10T00:34:13.000000000&#x27;,
       &#x27;2017-07-10T05:46:25.000000000&#x27;, &#x27;2017-07-10T09:46:51.000000000&#x27;,
       &#x27;2017-07-10T13:35:38.000000000&#x27;, &#x27;2017-07-10T18:04:39.000000000&#x27;,
                                 &#x27;NaT&#x27;, &#x27;2017-07-11T02:54:28.000000000&#x27;,
       &#x27;2017-07-11T07:06:22.000000000&#x27;, &#x27;2017-07-11T11:20:40.000000000&#x27;,
                                 &#x27;NaT&#x27;, &#x27;2017-07-11T19:58:27.000000000&#x27;,
       &#x27;2017-07-12T00:25:55.000000000&#x27;, &#x27;2017-07-12T04:35:55.000000000&#x27;,
       &#x27;2017-07-12T08:52:03.000000000&#x27;, &#x27;2017-07-12T15:08:22.000000000&#x27;,
       &#x27;2017-07-12T20:02:48.000000000&#x27;, &#x27;2017-07-13T01:12:51.000000000&#x27;,
       &#x27;2017-07-13T06:01:39.000000000&#x27;, &#x27;2017-07-13T11:08:32.000000000&#x27;,
       &#x27;2017-07-13T16:31:41.000000000&#x27;, &#x27;2017-07-13T22:26:08.000000000&#x27;,
       &#x27;2017-07-14T02:55:23.000000000&#x27;,                           &#x27;NaT&#x27;,
       &#x27;2017-07-14T09:48:21.000000000&#x27;, &#x27;2017-07-14T13:02:52.000000000&#x27;,
       &#x27;2017-07-14T16:24:54.000000000&#x27;, &#x27;2017-07-14T21:09:01.000000000&#x27;,
       &#x27;2017-07-15T01:50:34.000000000&#x27;, &#x27;2017-07-15T07:27:04.000000000&#x27;,
       &#x27;2017-07-15T12:59:39.000000000&#x27;, &#x27;2017-07-15T18:32:40.000000000&#x27;,
       &#x27;2017-07-15T22:53:15.000000000&#x27;, &#x27;2017-07-16T03:28:33.000000000&#x27;,
       &#x27;2017-07-16T08:40:11.000000000&#x27;, &#x27;2017-07-16T12:46:41.000000000&#x27;,
                                 &#x27;NaT&#x27;, &#x27;2017-07-16T19:10:30.000000000&#x27;,
       &#x27;2017-07-16T23:24:55.000000000&#x27;, &#x27;2017-07-17T04:57:22.000000000&#x27;,
       &#x27;2017-07-17T10:30:43.000000000&#x27;, &#x27;2017-07-17T15:10:35.000000000&#x27;,
       &#x27;2017-07-17T19:20:16.000000000&#x27;, &#x27;2017-07-17T23:47:53.000000000&#x27;,
       &#x27;2017-07-18T04:10:09.000000000&#x27;, &#x27;2017-07-18T08:56:44.000000000&#x27;,
                                 &#x27;NaT&#x27;,                           &#x27;NaT&#x27;,
       &#x27;2017-07-19T02:48:58.000000000&#x27;, &#x27;2017-07-19T09:26:23.000000000&#x27;,
                                 &#x27;NaT&#x27;,                           &#x27;NaT&#x27;,
       &#x27;2017-07-21T04:59:24.000000000&#x27;, &#x27;2017-07-23T21:55:14.000000000&#x27;,
       &#x27;2017-07-24T04:54:33.000000000&#x27;, &#x27;2017-07-24T11:32:17.000000000&#x27;,
       &#x27;2017-07-24T17:08:23.000000000&#x27;, &#x27;2017-07-24T21:23:11.000000000&#x27;,
       &#x27;2017-07-25T01:28:55.000000000&#x27;, &#x27;2017-07-25T05:44:45.000000000&#x27;,
       &#x27;2017-07-25T11:04:43.000000000&#x27;, &#x27;2017-07-25T17:05:09.000000000&#x27;,
       &#x27;2017-07-25T20:28:04.000000000&#x27;, &#x27;2017-07-26T00:04:01.000000000&#x27;,
       &#x27;2017-07-26T04:23:49.000000000&#x27;, &#x27;2017-07-26T09:12:49.000000000&#x27;,
       &#x27;2017-07-26T14:50:57.000000000&#x27;, &#x27;2017-07-26T21:12:58.000000000&#x27;,
       &#x27;2017-07-27T03:41:16.000000000&#x27;, &#x27;2017-07-27T10:25:08.000000000&#x27;,
       &#x27;2017-07-27T18:00:07.000000000&#x27;, &#x27;2017-07-28T01:04:33.000000000&#x27;,
       &#x27;2017-07-28T08:15:43.000000000&#x27;, &#x27;2017-07-28T15:30:39.000000000&#x27;,
       &#x27;2017-07-28T22:14:05.000000000&#x27;, &#x27;2017-07-29T05:34:06.000000000&#x27;,
       &#x27;2017-07-29T13:19:37.000000000&#x27;, &#x27;2017-07-29T21:02:50.000000000&#x27;,
       &#x27;2017-07-30T04:27:43.000000000&#x27;, &#x27;2017-07-30T11:50:25.000000000&#x27;,
       &#x27;2017-07-30T18:13:16.000000000&#x27;, &#x27;2017-07-30T23:54:16.000000000&#x27;,
       &#x27;2017-07-31T06:57:23.000000000&#x27;, &#x27;2017-07-31T11:35:29.000000000&#x27;,
       &#x27;2017-07-31T17:38:16.000000000&#x27;, &#x27;2017-08-01T00:44:39.000000000&#x27;,
       &#x27;2017-08-01T07:43:39.000000000&#x27;, &#x27;2017-08-01T14:42:49.000000000&#x27;,
       &#x27;2017-08-01T22:16:17.000000000&#x27;, &#x27;2017-08-02T06:03:17.000000000&#x27;,
       &#x27;2017-08-02T13:45:55.000000000&#x27;, &#x27;2017-08-02T21:39:43.000000000&#x27;,
       &#x27;2017-08-03T05:09:23.000000000&#x27;, &#x27;2017-08-03T12:47:26.000000000&#x27;,
       &#x27;2017-08-03T20:53:12.000000000&#x27;,                           &#x27;NaT&#x27;,
       &#x27;2017-08-04T20:52:07.000000000&#x27;, &#x27;2017-08-05T12:56:57.000000000&#x27;,
       &#x27;2017-08-05T21:01:08.000000000&#x27;, &#x27;2017-08-06T22:34:17.000000000&#x27;,
       &#x27;2017-08-07T07:12:46.000000000&#x27;, &#x27;2017-08-07T13:46:39.000000000&#x27;,
       &#x27;2017-08-08T07:03:17.000000000&#x27;, &#x27;2017-08-08T15:54:13.000000000&#x27;,
       &#x27;2017-08-09T00:36:28.000000000&#x27;, &#x27;2017-08-09T09:04:28.000000000&#x27;,
       &#x27;2017-08-09T17:02:01.000000000&#x27;, &#x27;2017-08-10T00:36:02.000000000&#x27;,
       &#x27;2017-08-10T08:19:59.000000000&#x27;, &#x27;2017-08-10T15:41:07.000000000&#x27;,
       &#x27;2017-08-10T23:15:20.000000000&#x27;, &#x27;2017-08-11T06:47:01.000000000&#x27;,
       &#x27;2017-08-11T14:25:39.000000000&#x27;, &#x27;2017-08-11T22:27:30.000000000&#x27;,
       &#x27;2017-08-12T06:43:18.000000000&#x27;,                           &#x27;NaT&#x27;,
                                 &#x27;NaT&#x27;, &#x27;2017-08-13T06:25:48.000000000&#x27;,
                                 &#x27;NaT&#x27;, &#x27;2017-08-25T02:05:50.000000000&#x27;,
       &#x27;2017-08-25T10:36:25.000000000&#x27;, &#x27;2017-08-25T19:09:16.000000000&#x27;,
       &#x27;2017-08-26T04:49:39.000000000&#x27;, &#x27;2017-08-26T19:06:42.000000000&#x27;,
       &#x27;2017-08-27T05:06:12.000000000&#x27;, &#x27;2017-08-28T03:23:01.000000000&#x27;,
       &#x27;2017-08-28T12:39:45.000000000&#x27;, &#x27;2017-08-28T22:15:07.000000000&#x27;,
       &#x27;2017-08-29T07:26:42.000000000&#x27;, &#x27;2017-08-29T16:18:34.000000000&#x27;,
       &#x27;2017-08-30T01:26:43.000000000&#x27;, &#x27;2017-08-30T10:04:16.000000000&#x27;,
       &#x27;2017-08-30T19:04:11.000000000&#x27;, &#x27;2017-08-31T04:29:58.000000000&#x27;,
       &#x27;2017-08-31T13:17:19.000000000&#x27;, &#x27;2017-08-31T22:14:30.000000000&#x27;,
       &#x27;2017-09-01T06:49:51.000000000&#x27;, &#x27;2017-09-02T16:17:35.000000000&#x27;,
       &#x27;2017-09-03T01:02:41.000000000&#x27;, &#x27;2017-09-03T09:27:45.000000000&#x27;,
       &#x27;2017-09-03T17:41:13.000000000&#x27;, &#x27;2017-09-04T02:20:03.000000000&#x27;,
       &#x27;2017-09-04T10:44:08.000000000&#x27;, &#x27;2017-09-04T18:48:41.000000000&#x27;,
       &#x27;2017-09-05T02:26:10.000000000&#x27;, &#x27;2017-09-05T10:01:13.000000000&#x27;,
       &#x27;2017-09-05T16:02:14.000000000&#x27;, &#x27;2017-09-05T23:57:32.000000000&#x27;,
       &#x27;2017-09-06T07:10:34.000000000&#x27;, &#x27;2017-09-06T13:56:27.000000000&#x27;,
       &#x27;2017-09-06T22:07:12.000000000&#x27;, &#x27;2017-09-07T05:46:39.000000000&#x27;,
       &#x27;2017-09-07T13:16:50.000000000&#x27;, &#x27;2017-09-07T21:42:26.000000000&#x27;,
       &#x27;2017-09-08T05:17:26.000000000&#x27;, &#x27;2017-09-08T12:48:33.000000000&#x27;,
       &#x27;2017-09-08T21:25:31.000000000&#x27;, &#x27;2017-09-09T04:54:47.000000000&#x27;,
       &#x27;2017-09-09T12:09:40.000000000&#x27;, &#x27;2017-09-09T19:24:27.000000000&#x27;,
       &#x27;2017-09-10T03:43:38.000000000&#x27;, &#x27;2017-09-10T11:06:29.000000000&#x27;,
       &#x27;2017-09-10T18:01:01.000000000&#x27;, &#x27;2017-09-11T00:59:53.000000000&#x27;,
       &#x27;2017-09-11T07:08:14.000000000&#x27;, &#x27;2017-09-11T13:31:03.000000000&#x27;,
       &#x27;2017-09-11T21:15:31.000000000&#x27;, &#x27;2017-09-12T04:07:15.000000000&#x27;,
       &#x27;2017-09-12T10:33:53.000000000&#x27;, &#x27;2017-09-12T17:02:13.000000000&#x27;,
       &#x27;2017-09-13T00:26:06.000000000&#x27;,                           &#x27;NaT&#x27;,
                                 &#x27;NaT&#x27;,                           &#x27;NaT&#x27;,
       &#x27;2017-09-14T04:11:01.000000000&#x27;, &#x27;2017-09-14T10:51:50.000000000&#x27;,
       &#x27;2017-09-14T17:38:39.000000000&#x27;, &#x27;2017-09-15T01:16:08.000000000&#x27;,
       &#x27;2017-09-15T08:15:16.000000000&#x27;, &#x27;2017-09-15T15:01:16.000000000&#x27;,
       &#x27;2017-09-15T22:40:31.000000000&#x27;, &#x27;2017-09-16T06:31:54.000000000&#x27;,
       &#x27;2017-09-16T14:22:56.000000000&#x27;, &#x27;2017-09-16T22:21:55.000000000&#x27;,
       &#x27;2017-09-17T06:08:57.000000000&#x27;, &#x27;2017-09-17T13:58:50.000000000&#x27;,
       &#x27;2017-09-17T22:50:07.000000000&#x27;, &#x27;2017-09-18T06:51:52.000000000&#x27;,
       &#x27;2017-09-18T14:55:28.000000000&#x27;, &#x27;2017-09-19T00:00:51.000000000&#x27;,
       &#x27;2017-09-19T07:52:44.000000000&#x27;, &#x27;2017-09-19T15:51:17.000000000&#x27;,
       &#x27;2017-09-20T00:42:37.000000000&#x27;, &#x27;2017-09-20T08:20:42.000000000&#x27;,
       &#x27;2017-09-20T16:07:36.000000000&#x27;, &#x27;2017-09-21T01:00:20.000000000&#x27;,
       &#x27;2017-09-21T09:06:54.000000000&#x27;, &#x27;2017-09-21T18:20:24.000000000&#x27;,
       &#x27;2017-09-22T02:11:47.000000000&#x27;, &#x27;2017-09-22T09:53:55.000000000&#x27;,
       &#x27;2017-09-22T18:52:54.000000000&#x27;, &#x27;2017-09-23T02:57:22.000000000&#x27;,
       &#x27;2017-09-23T10:41:41.000000000&#x27;, &#x27;2017-09-23T19:27:49.000000000&#x27;,
       &#x27;2017-09-24T03:08:26.000000000&#x27;, &#x27;2017-09-24T10:50:39.000000000&#x27;,
       &#x27;2017-09-24T19:39:05.000000000&#x27;, &#x27;2017-09-25T03:52:37.000000000&#x27;,
       &#x27;2017-09-25T12:10:00.000000000&#x27;, &#x27;2017-09-25T20:45:28.000000000&#x27;,
       &#x27;2017-09-26T05:26:15.000000000&#x27;, &#x27;2017-09-26T13:17:58.000000000&#x27;,
       &#x27;2017-09-26T18:54:12.000000000&#x27;, &#x27;2017-09-27T00:35:11.000000000&#x27;,
       &#x27;2017-09-27T06:50:58.000000000&#x27;, &#x27;2017-09-27T13:26:08.000000000&#x27;,
       &#x27;2017-09-27T19:32:40.000000000&#x27;, &#x27;2017-09-28T01:02:55.000000000&#x27;,
       &#x27;2017-09-28T05:58:11.000000000&#x27;, &#x27;2017-09-28T10:21:41.000000000&#x27;,
       &#x27;2017-09-28T15:43:18.000000000&#x27;, &#x27;2017-09-28T20:44:19.000000000&#x27;,
       &#x27;2017-09-29T00:59:02.000000000&#x27;, &#x27;2017-09-29T04:56:02.000000000&#x27;,
       &#x27;2017-09-29T08:10:46.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>dist</span></div><div class='xr-var-dims'>(cast)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 7.686 ... 1.162e+04 1.163e+04</div><input id='attrs-a8cf9c35-8442-420f-9fe0-f5e3d6b8ccd4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a8cf9c35-8442-420f-9fe0-f5e3d6b8ccd4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-250dd371-1daa-4797-bd43-ee895b1f8cfd' class='xr-var-data-in' type='checkbox'><label for='data-250dd371-1daa-4797-bd43-ee895b1f8cfd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([0.00000000e+00, 7.68561616e+00, 1.44073747e+01, 2.24809853e+01,
       3.07617263e+01, 3.46250903e+01, 3.84467966e+01, 5.38467322e+01,
       8.65511365e+01, 1.34614527e+02, 1.81735430e+02, 2.29840055e+02,
       2.53086614e+02, 2.78871294e+02, 2.99068149e+02, 3.19248404e+02,
       3.38482545e+02, 3.53850860e+02, 3.65347436e+02, 3.91338197e+02,
       4.23091269e+02, 4.55754431e+02, 4.88533192e+02, 5.35893157e+02,
       5.84909293e+02, 6.08943429e+02, 6.32980704e+02, 6.81027259e+02,
       6.81027259e+02, 6.81027259e+02, 7.29117367e+02, 7.77158332e+02,
       7.77158332e+02, 7.77158332e+02, 8.17561252e+02, 8.36790044e+02,
       8.57888164e+02, 9.05031981e+02, 9.32909270e+02, 9.60707967e+02,
       9.85737717e+02, 1.02396146e+03, 1.06271105e+03, 1.11370681e+03,
       1.13772390e+03, 1.13772390e+03, 1.13772390e+03, 1.16180985e+03,
       1.17541652e+03, 1.18600843e+03, 1.20980486e+03, 1.25787412e+03,
       1.30583983e+03, 1.35410534e+03, 1.37561370e+03, 1.40198149e+03,
       1.45022789e+03, 1.46553702e+03, 1.46553702e+03, 1.46553702e+03,
       1.47705296e+03, 1.52510385e+03, 1.57322366e+03, 1.60200606e+03,
       1.62130279e+03, 1.63574126e+03, 1.65014867e+03, 1.66935106e+03,
       1.66935106e+03, 1.66935106e+03, 1.66935106e+03, 1.71758939e+03,
       1.71758939e+03, 1.71758939e+03, 1.71758939e+03, 1.78442192e+03,
       1.85121630e+03, 1.91780854e+03, 1.96589245e+03, 2.00539527e+03,
       2.02353981e+03, 2.05331280e+03, 2.10023932e+03, 2.15451161e+03,
       2.17784948e+03, 2.20978069e+03, 2.23412987e+03, 2.25096824e+03,
       2.26889903e+03, 2.29502799e+03, 2.32593721e+03, 2.36530522e+03,
       2.41214661e+03, 2.45902658e+03, 2.50586776e+03, 2.55183428e+03,
       2.59115741e+03, 2.63896689e+03, 2.68347530e+03, 2.72767970e+03,
       2.77200622e+03, 2.81799946e+03, 2.84920236e+03, 2.86482805e+03,
       2.87979421e+03, 2.89576076e+03, 2.92761315e+03, 2.97452996e+03,
       3.02132001e+03, 3.06816422e+03, 3.12923345e+03, 3.19049622e+03,
       3.25154741e+03, 3.31262558e+03, 3.37353347e+03, 3.43689398e+03,
       3.49799274e+03, 3.49799274e+03, 3.49799274e+03, 3.56004720e+03,
       3.62328439e+03, 3.68466450e+03, 3.74874666e+03, 3.81377277e+03,
       3.88305242e+03, 3.95241647e+03, 4.02431004e+03, 4.07986918e+03,
       4.14268004e+03, 4.20552372e+03, 4.26823980e+03, 4.33100860e+03,
       4.39365157e+03, 4.45644076e+03, 4.51915776e+03, 4.58201931e+03,
       4.64481773e+03, 4.64481773e+03, 4.64481773e+03, 4.64481773e+03,
       4.64481773e+03, 4.64481773e+03, 4.71882855e+03, 4.79284806e+03,
       4.86694165e+03, 4.95031923e+03, 5.03366743e+03, 5.11705202e+03,
       5.20044652e+03, 5.27435474e+03, 5.36733934e+03, 5.45071683e+03,
       5.53409331e+03, 5.61771319e+03, 5.70105017e+03, 5.78453100e+03,
       5.86796260e+03, 5.95139239e+03, 6.03478270e+03, 6.11839008e+03,
       6.20155708e+03, 6.28515654e+03, 6.36839019e+03, 6.45178197e+03,
       6.53508738e+03, 6.61293453e+03, 6.69079230e+03, 6.76850794e+03,
       6.80902128e+03, 6.87510566e+03, 6.94548978e+03, 7.00895109e+03,
       7.07869812e+03, 7.15207597e+03, 7.23452025e+03, 7.30775872e+03,
       7.38544055e+03, 7.46324381e+03, 7.54103588e+03, 7.61881734e+03,
       7.69662273e+03, 7.77440023e+03, 7.85220573e+03, 7.92993390e+03,
       8.00773686e+03, 8.07242611e+03, 8.13714535e+03, 8.20176568e+03,
       8.26641111e+03, 8.33530551e+03, 8.39566357e+03, 8.46038017e+03,
       8.52504290e+03, 8.52504290e+03, 8.52504290e+03, 8.52504290e+03,
       8.52504290e+03, 8.58977312e+03, 8.65435356e+03, 8.71908857e+03,
       8.78369026e+03, 8.84840345e+03, 8.91312618e+03, 8.99653107e+03,
       9.07993460e+03, 9.16332128e+03, 9.24677383e+03, 9.33017123e+03,
       9.41354988e+03, 9.49706980e+03, 9.58041374e+03, 9.66377002e+03,
       9.74719191e+03, 9.83060014e+03, 9.91401004e+03, 9.99734047e+03,
       1.00808632e+04, 1.01642389e+04, 1.02476365e+04, 1.03309945e+04,
       1.04144590e+04, 1.04978319e+04, 1.05811171e+04, 1.06645916e+04,
       1.07480770e+04, 1.08316864e+04, 1.09148841e+04, 1.09983214e+04,
       1.10817708e+04, 1.11650923e+04, 1.12485312e+04, 1.13319218e+04,
       1.14154052e+04, 1.14874396e+04, 1.14981241e+04, 1.15100646e+04,
       1.15223810e+04, 1.15355785e+04, 1.15472736e+04, 1.15549735e+04,
       1.15616512e+04, 1.15680874e+04, 1.15812004e+04, 1.15972565e+04,
       1.16119407e+04, 1.16230682e+04, 1.16315346e+04])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>pres</span></div><div class='xr-var-dims'>(cast, P)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 10.0 20.0 ... 5990.0 6000.0</div><input id='attrs-f658de4b-b393-4073-af9c-1e70c122de06' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f658de4b-b393-4073-af9c-1e70c122de06' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c8fceba9-4518-4216-9f07-b8dcfda6cb20' class='xr-var-data-in' type='checkbox'><label for='data-c8fceba9-4518-4216-9f07-b8dcfda6cb20' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[   0.,   10.,   20., ..., 5980., 5990., 6000.],
       [   0.,   10.,   20., ..., 5980., 5990., 6000.],
       [   0.,   10.,   20., ..., 5980., 5990., 6000.],
       ...,
       [   0.,   10.,   20., ..., 5980., 5990., 6000.],
       [   0.,   10.,   20., ..., 5980., 5990., 6000.],
       [   0.,   10.,   20., ..., 5980., 5990., 6000.]], dtype=float32)</pre></li></ul></div></li><li class='xr-section-item'><input id='section-e8e99404-b828-4370-bf3b-1fe7a8d06d02' class='xr-section-summary-in' type='checkbox'  ><label for='section-e8e99404-b828-4370-bf3b-1fe7a8d06d02' class='xr-section-summary' >Data variables: <span>(15)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>chi</span></div><div class='xr-var-dims'>(cast, P)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-70752f12-c6f6-4291-886d-6492595d6db2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-70752f12-c6f6-4291-886d-6492595d6db2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4f852a3c-e447-42fa-a9be-5106d2d70cba' class='xr-var-data-in' type='checkbox'><label for='data-4f852a3c-e447-42fa-a9be-5106d2d70cba' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>eps</span></div><div class='xr-var-dims'>(cast, P)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-1bd1ae76-57be-4b1d-8141-fd2c46551514' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1bd1ae76-57be-4b1d-8141-fd2c46551514' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5e04ecfc-7f68-4768-9194-8fed7c64f68d' class='xr-var-data-in' type='checkbox'><label for='data-5e04ecfc-7f68-4768-9194-8fed7c64f68d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>Jq</span></div><div class='xr-var-dims'>(cast, P)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-b8341fb8-c30a-43d7-ab6a-519cb32c2af9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b8341fb8-c30a-43d7-ab6a-519cb32c2af9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3ceac3ee-a6a6-41c1-bbc7-4f36d74113f2' class='xr-var-data-in' type='checkbox'><label for='data-3ceac3ee-a6a6-41c1-bbc7-4f36d74113f2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>KT</span></div><div class='xr-var-dims'>(cast, P)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-a984c73e-c451-4f89-9de6-82abc46c8d56' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a984c73e-c451-4f89-9de6-82abc46c8d56' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-29b04399-4fdf-40c5-9b6f-3f1e0a544b3c' class='xr-var-data-in' type='checkbox'><label for='data-29b04399-4fdf-40c5-9b6f-3f1e0a544b3c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>N2</span></div><div class='xr-var-dims'>(cast, P)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-c63f70c2-021e-46bc-a04d-105807bc959c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c63f70c2-021e-46bc-a04d-105807bc959c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-57b4b1c8-4e86-4c51-b0f9-fe1a964b7430' class='xr-var-data-in' type='checkbox'><label for='data-57b4b1c8-4e86-4c51-b0f9-fe1a964b7430' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>dTdz</span></div><div class='xr-var-dims'>(cast, P)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-9adc9cb0-f6c9-43cd-85e6-9043944d67ec' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9adc9cb0-f6c9-43cd-85e6-9043944d67ec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3a300f62-c315-4d67-850e-e3aca9946dbe' class='xr-var-data-in' type='checkbox'><label for='data-3a300f62-c315-4d67-850e-e3aca9946dbe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>TPvar</span></div><div class='xr-var-dims'>(cast, P)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0536 nan nan nan ... nan nan nan</div><input id='attrs-5b2aa5f1-8bb5-49a0-8c48-ec2df4153e18' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5b2aa5f1-8bb5-49a0-8c48-ec2df4153e18' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e819553-5245-4c01-a46c-d079724a2d43' class='xr-var-data-in' type='checkbox'><label for='data-2e819553-5245-4c01-a46c-d079724a2d43' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[5.36029897e-02,            nan,            nan, ...,
                   nan,            nan,            nan],
       [1.07341527e+00,            nan, 5.03130563e-03, ...,
                   nan,            nan,            nan],
       [3.76621502e-01,            nan,            nan, ...,
                   nan,            nan,            nan],
       ...,
       [6.60413969e-02, 3.40193418e-01, 6.44606830e-02, ...,
                   nan,            nan,            nan],
       [1.65111004e-02,            nan, 5.05989054e-04, ...,
                   nan,            nan,            nan],
       [8.21409091e-03, 3.32978061e-03, 2.79942610e-03, ...,
                   nan,            nan,            nan]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>T</span></div><div class='xr-var-dims'>(cast, P)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-65995146-202f-4822-b67f-ba86e48e457b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-65995146-202f-4822-b67f-ba86e48e457b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e3183d35-f58e-417f-be5b-0ca56b2d7773' class='xr-var-data-in' type='checkbox'><label for='data-e3183d35-f58e-417f-be5b-0ca56b2d7773' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[        nan,         nan,         nan, ...,         nan,
                nan,         nan],
       [        nan,         nan, 21.88434386, ...,         nan,
                nan,         nan],
       [        nan,         nan,         nan, ...,         nan,
                nan,         nan],
       ...,
       [        nan,         nan, 11.69442893, ...,         nan,
                nan,         nan],
       [        nan,         nan,         nan, ...,         nan,
                nan,         nan],
       [        nan,         nan, 11.62930248, ...,         nan,
                nan,         nan]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>S</span></div><div class='xr-var-dims'>(cast, P)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-0faa3c20-7521-4616-8c99-65ebb2d92d1f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0faa3c20-7521-4616-8c99-65ebb2d92d1f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-599d4f16-d074-424a-a0c5-e581e935dd4b' class='xr-var-data-in' type='checkbox'><label for='data-599d4f16-d074-424a-a0c5-e581e935dd4b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[        nan,         nan,         nan, ...,         nan,
                nan,         nan],
       [        nan,         nan, 35.75225647, ...,         nan,
                nan,         nan],
       [        nan,         nan,         nan, ...,         nan,
                nan,         nan],
       ...,
       [        nan,         nan, 34.43951389, ...,         nan,
                nan,         nan],
       [        nan,         nan,         nan, ...,         nan,
                nan,         nan],
       [        nan,         nan, 34.5394576 , ...,         nan,
                nan,         nan]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>sigma_0</span></div><div class='xr-var-dims'>(cast, P)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-030aadea-04d6-4032-ba47-c1f41b4a2ee7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-030aadea-04d6-4032-ba47-c1f41b4a2ee7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ddc7986e-eaf8-4c78-bb39-a00fe7c3563c' class='xr-var-data-in' type='checkbox'><label for='data-ddc7986e-eaf8-4c78-bb39-a00fe7c3563c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[          nan,           nan,           nan, ...,           nan,
                  nan,           nan],
       [          nan,           nan, 1024.82313693, ...,           nan,
                  nan,           nan],
       [          nan,           nan,           nan, ...,           nan,
                  nan,           nan],
       ...,
       [          nan,           nan, 1026.21188892, ...,           nan,
                  nan,           nan],
       [          nan,           nan,           nan, ...,           nan,
                  nan,           nan],
       [          nan,           nan, 1026.30176141, ...,           nan,
                  nan,           nan]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>sigma_1</span></div><div class='xr-var-dims'>(cast, P)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-4ed2f387-4b1b-4c4e-834a-59ffe89033ee' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4ed2f387-4b1b-4c4e-834a-59ffe89033ee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-32bb23ea-53e2-44e4-9cbe-3f7e8c94aaf4' class='xr-var-data-in' type='checkbox'><label for='data-32bb23ea-53e2-44e4-9cbe-3f7e8c94aaf4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[          nan,           nan,           nan, ...,           nan,
                  nan,           nan],
       [          nan,           nan, 1029.06214421, ...,           nan,
                  nan,           nan],
       [          nan,           nan,           nan, ...,           nan,
                  nan,           nan],
       ...,
       [          nan,           nan, 1030.63539984, ...,           nan,
                  nan,           nan],
       [          nan,           nan,           nan, ...,           nan,
                  nan,           nan],
       [          nan,           nan, 1030.72589544, ...,           nan,
                  nan,           nan]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>sigma_2</span></div><div class='xr-var-dims'>(cast, P)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-4ee37fa6-7ff5-4dcf-a6e0-95095877a444' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4ee37fa6-7ff5-4dcf-a6e0-95095877a444' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ed92499-2b23-443b-9aff-4143fcf2d191' class='xr-var-data-in' type='checkbox'><label for='data-2ed92499-2b23-443b-9aff-4143fcf2d191' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[          nan,           nan,           nan, ...,           nan,
                  nan,           nan],
       [          nan,           nan, 1033.20836311, ...,           nan,
                  nan,           nan],
       [          nan,           nan,           nan, ...,           nan,
                  nan,           nan],
       ...,
       [          nan,           nan, 1034.96067346, ...,           nan,
                  nan,           nan],
       [          nan,           nan,           nan, ...,           nan,
                  nan,           nan],
       [          nan,           nan, 1035.05177191, ...,           nan,
                  nan,           nan]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>sigma_4</span></div><div class='xr-var-dims'>(cast, P)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-e102b44d-22ce-4b33-bbb4-42d2aee4a59b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e102b44d-22ce-4b33-bbb4-42d2aee4a59b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e1d63e49-95cc-4199-9065-68ae522c7833' class='xr-var-data-in' type='checkbox'><label for='data-e1d63e49-95cc-4199-9065-68ae522c7833' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[          nan,           nan,           nan, ...,           nan,
                  nan,           nan],
       [          nan,           nan, 1041.23401845, ...,           nan,
                  nan,           nan],
       [          nan,           nan,           nan, ...,           nan,
                  nan,           nan],
       ...,
       [          nan,           nan, 1043.32676274, ...,           nan,
                  nan,           nan],
       [          nan,           nan,           nan, ...,           nan,
                  nan,           nan],
       [          nan,           nan, 1043.41899576, ...,           nan,
                  nan,           nan]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>rho</span></div><div class='xr-var-dims'>(cast, P)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-88475d00-1262-4553-b626-c2cb3cb95b41' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-88475d00-1262-4553-b626-c2cb3cb95b41' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-41eaa5d7-a7d1-4654-92c4-acd93ac95864' class='xr-var-data-in' type='checkbox'><label for='data-41eaa5d7-a7d1-4654-92c4-acd93ac95864' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([[          nan,           nan,           nan, ...,           nan,
                  nan,           nan],
       [          nan,           nan, 1024.90884568, ...,           nan,
                  nan,           nan],
       [          nan,           nan,           nan, ...,           nan,
                  nan,           nan],
       ...,
       [          nan,           nan, 1026.30133851, ...,           nan,
                  nan,           nan],
       [          nan,           nan,           nan, ...,           nan,
                  nan,           nan],
       [          nan,           nan, 1026.39122364, ...,           nan,
                  nan,           nan]])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span>bathy</span></div><div class='xr-var-dims'>(cast)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-874.2 -1.849e+03 ... -539.5</div><input id='attrs-a5b4843c-782a-439e-a675-115ecfa3137a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a5b4843c-782a-439e-a675-115ecfa3137a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-89b03b6c-a919-4d5f-bf96-cd52e4b3d005' class='xr-var-data-in' type='checkbox'><label for='data-89b03b6c-a919-4d5f-bf96-cd52e4b3d005' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>z</dd><dt><span>actual_range :</span></dt><dd>[-10722.   8046.]</dd></dl></div><pre class='xr-var-data'>array([ -874.17507883, -1848.79442417, -1945.17018176, -2069.63408006,
       -3116.94592845, -3775.84042297, -4240.40698517, -4808.12647042,
       -4587.5893637 , -4702.15351045, -4823.24865498, -4641.6903253 ,
       -4720.37051288, -4678.65268491, -5159.54903722, -4401.56196613,
       -4175.75317141, -3514.06914488, -3057.55691038, -1940.33313239,
       -1977.78240967, -2642.21514488, -3133.69183712, -2505.04191007,
       -2600.08139354, -2122.18866479, -1634.88483436, -1540.46731552,
       -1342.31660256, -1324.97813205, -1192.45249783, -1154.03441216,
       -1231.97784578, -1414.76174082, -1953.41536734, -2463.76490292,
       -3135.06408377, -3152.86174591, -3185.53627977, -3380.37491341,
       -3002.99570862, -2838.06732352, -2990.59167304, -2593.50433495,
       -2062.07492401, -1224.14176719, -1023.80998674,  -839.9409198 ,
       -1826.55136618, -3380.0204404 , -3199.03795909, -3331.44469024,
       -2612.74141463, -2778.11538561, -2037.15762305, -2694.93402352,
       -2117.31177792, -1674.83938418,  -804.83507494, -1221.69066128,
       -2176.28638163, -2787.26864659, -2212.1563357 , -1345.69207641,
       -1438.57304893, -1638.22387887, -1676.22212369, -2458.06302911,
       -3421.71507962, -3783.70333191, -4042.6369748 , -4297.56687751,
       -4218.26606931, -4248.40172853, -4267.93178288, -4199.91453886,
       -3899.93711186, -3384.31242858, -2409.08307918, -1680.827225  ,
       -2169.98817859, -2844.9654722 , -3080.35438663, -3080.38537295,
        -616.0166312 , -2053.50191403, -3455.92213995, -4371.62872364,
       -5172.9730969 , -5816.66124462, -7380.82504899, -7363.57997675,
       -6127.50360836, -5774.62120039, -5832.45994161, -5770.86187611,
       -5748.87797599, -5859.10024157, -5735.58090629, -5857.60877615,
       -6004.56212786, -5761.09723336, -5276.2136944 , -4016.44592774,
       -2649.93536815, -4867.16709683, -5467.03110371, -5741.55249906,
       -5775.84886533, -5547.81682091, -5373.66232174, -5539.3528469 ,
       -5587.03734994, -5339.98671056, -5218.52987827, -5200.91531125,
       -6107.32234558, -5315.96991415, -5398.10830749, -5368.11169245,
       -5371.41487576, -5491.77066003, -5279.13221299, -5541.39632076,
       -5573.54275039, -5453.89416177, -5714.61932217, -5498.08310364,
       -5396.73257323, -5405.53426132, -5357.91095599, -5191.05034381,
       -5242.00036468, -5215.71122574, -5186.26719981, -5118.39203598,
       -5129.28873914, -5200.73440515, -5126.93509629, -5309.45000421,
       -5618.69516738, -5018.0773941 , -4522.88103216, -4623.71241066,
       -4988.26656745, -5056.61067992, -5107.37126168, -5081.78287678,
       -5166.05022067, -5162.92497677, -5065.92461907, -4825.41957731,
       -4579.08916158, -4612.69399444, -4518.35428119, -4534.52066835,
       -4561.28817275, -4117.79138551, -4338.14527943, -4231.83641708,
       -4145.37123111, -3964.88171183, -3783.38652871, -3419.64059933,
       -4041.01527045, -3989.66968059, -1377.67555146, -3058.64998897,
       -4169.25166954, -3514.97562098, -3453.43770182, -3770.82760551,
       -3475.37819809, -3685.08884464, -3436.27094768, -3496.33076585,
       -3185.72167224, -3398.35179003, -3442.20288609, -3285.36212032,
       -3164.61736351, -2899.97646526, -2978.41877905, -3028.04561531,
       -2567.68581486, -2380.86229931, -2483.13108889, -3066.52444199,
       -3346.230302  , -2345.64654696, -3692.69705323, -3121.84349917,
       -3261.66568507, -3151.8512399 , -3384.08242316, -3351.22522201,
       -3379.74967708, -3425.45540864, -3555.48977523, -3522.2327222 ,
       -3454.81034915, -3604.47514059, -3614.48395311, -3767.56041625,
       -3825.49097254, -3550.48808549, -3617.00881048, -3926.55551268,
       -3888.66881823, -3735.55525169, -3738.36706736, -4405.52314955,
       -3515.15690646, -3739.59261868, -3736.00792092, -3520.27738749,
       -3536.31044612, -3816.16272664, -3887.99335427, -3875.39012219,
       -3904.57129841, -3827.34935711, -3791.10096046, -3878.21565489,
       -3982.86148069, -4000.65257925, -3841.4460646 , -4176.37760332,
       -4206.61610295, -4204.47470138, -4296.50652107, -4134.12754103,
       -4077.64222637, -3964.51919194, -4459.97234673, -4699.148015  ,
       -5579.63765956, -6005.67712106, -4975.79941081, -4141.98522374,
       -3478.64994143, -2640.12009791, -2169.12641121, -2461.5939514 ,
       -2136.05858444, -1143.12683365,  -539.464119  ])</pre></li></ul></div></li><li class='xr-section-item'><input id='section-2bc332ce-7146-4935-b7c9-053677e4cbeb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2bc332ce-7146-4935-b7c9-053677e4cbeb' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>name :</span></dt><dd>P06 merged dataset</dd><dt><span>transect_name :</span></dt><dd>P06</dd></dl></div></li></ul></div></div></div></div>
</div>
<hr class="docutils" />
</div>
<hr class="docutils" />
<div class="section" id="read-transect-ancillary-datasets">
<h2>Read transect + ancillary datasets<a class="headerlink" href="#read-transect-ancillary-datasets" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">eddydiff</span> <span class="k">as</span> <span class="nn">ed</span>

<span class="n">p06</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;/home/deepak/work/eddydiff/datasets/P06/p06.nc&#39;</span><span class="p">,</span> <span class="n">autoclose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">bathy</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">bathy</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">p06</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p06</span><span class="p">[</span><span class="s1">&#39;KT&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">3e-3</span><span class="p">)</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;bathy&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bathy</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;KtTz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">KT</span> <span class="o">*</span> <span class="n">p06</span><span class="o">.</span><span class="n">dTdz</span>
<span class="n">p06</span>

<span class="n">eccograd</span><span class="p">,</span> <span class="n">argograd</span><span class="p">,</span> <span class="n">cole</span><span class="p">,</span> <span class="n">aber</span> <span class="o">=</span> <span class="n">ed</span><span class="o">.</span><span class="n">read_all_datasets</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span> <span class="n">transect</span><span class="o">=</span><span class="n">p06</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/home/deepak/miniconda3/envs/dcpy/lib/python3.7/site-packages/ipykernel_launcher.py:3: FutureWarning: The autoclose argument is no longer used by xarray.open_dataset() and is now ignored; it will be removed in a future version of xarray. If necessary, you can control the maximum number of simultaneous open files with xarray.set_options(file_cache_maxsize=...).
  This is separate from the ipykernel package so we can avoid doing imports until
/home/deepak/miniconda3/envs/dcpy/lib/python3.7/site-packages/dask/array/numpy_compat.py:40: RuntimeWarning: invalid value encountered in true_divide
  x = np.divide(x1, x2, out)
</pre>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">argograd</span><span class="o">.</span><span class="n">Smean</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;cast&#39;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7f173e54d470&gt;
</pre></div>
</div>
<div class="stderr docutils container">
<pre class="stderr literal-block">/home/deepak/anaconda3/lib/python3.6/site-packages/_pytest/fixtures.py:847: DeprecationWarning: The `convert` argument is deprecated in favor of `converter`.  It will be removed after 2019/01.
  params = attr.ib(convert=attr.converters.optional(tuple))
/home/deepak/anaconda3/lib/python3.6/site-packages/_pytest/fixtures.py:849: DeprecationWarning: The `convert` argument is deprecated in favor of `converter`.  It will be removed after 2019/01.
  ids = attr.ib(default=None, convert=_ensure_immutable_ids)
</pre>
</div>
<img alt="_images/P06_6_2.png" src="_images/P06_6_2.png" />
</div>
</div>
</div>
<div class="section" id="plots">
<h2>plots<a class="headerlink" href="#plots" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">eps</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;cast&#39;</span><span class="p">)</span>
<span class="n">p06</span><span class="o">.</span><span class="n">rho</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;cast&#39;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">levels</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">rho</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="mi">20</span><span class="p">,</span> <span class="n">retbins</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">cast</span><span class="p">,</span> <span class="mi">6100</span><span class="p">,</span> <span class="o">-</span><span class="n">p06</span><span class="o">.</span><span class="n">bathy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="o">/</span><span class="mf">1.6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/P06_8_0.png" src="_images/P06_8_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p06</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;cast&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdYlBu</span><span class="p">)</span>
<span class="n">p06</span><span class="o">.</span><span class="n">rho</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;cast&#39;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">levels</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">rho</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="mi">20</span><span class="p">,</span> <span class="n">retbins</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">cast</span><span class="p">,</span> <span class="mi">6100</span><span class="p">,</span> <span class="o">-</span><span class="n">p06</span><span class="o">.</span><span class="n">bathy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="o">/</span><span class="mf">1.6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/P06_9_0.png" src="_images/P06_9_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sciviscolor</span> <span class="k">as</span> <span class="nn">svc</span>

<span class="n">svc</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p06</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="c1">### p06[&#39;KT&#39;].attrs[&#39;long_name&#39;] = &#39;$K_T$&#39;</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;KT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;m$^2$/s&#39;</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Pressure&#39;</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;dbar&#39;</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Longitude&#39;</span>
<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;deg. East&#39;</span>

<span class="n">logKT</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">p06</span><span class="p">[</span><span class="s1">&#39;KT&#39;</span><span class="p">])</span>
<span class="n">logKT</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">KT</span><span class="o">.</span><span class="n">attrs</span>
<span class="n">logKT</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;log$_</span><span class="si">{10}</span><span class="s1">$ $K_T$&#39;</span>
<span class="n">logKT</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdYlBu_r</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">sigma_4</span> <span class="o">-</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> 
                                  <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">levels</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">sigma_4</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">retbins</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="mi">6100</span><span class="p">,</span> <span class="o">-</span><span class="n">p06</span><span class="o">.</span><span class="n">bathy</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="o">/</span><span class="mf">2.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Potential density contours and log $K_T$ for the P06 GOSHIP section&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;../images/p06-kt.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/home/deepak/anaconda3/lib/python3.6/site-packages/matplotlib/contour.py:1000: UserWarning: The following kwargs were not used by contour: 'labels'
  s)
</pre>
</div>
<img alt="_images/P06_12_1.png" src="_images/P06_12_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1024.6</span><span class="p">,</span> 
        <span class="mf">1025.6</span><span class="p">,</span> <span class="mf">1025.8</span><span class="p">,</span> 
        <span class="mf">1026.0</span><span class="p">,</span> <span class="mf">1026.25</span><span class="p">,</span> <span class="mf">1026.5</span><span class="p">,</span> <span class="mf">1026.75</span><span class="p">,</span> 
        <span class="mf">1027.0</span><span class="p">,</span> <span class="mf">1027.1</span><span class="p">,</span> <span class="mf">1027.2</span><span class="p">,</span> <span class="mf">1027.3</span><span class="p">,</span> <span class="mf">1027.4</span><span class="p">,</span> <span class="mf">1027.5</span><span class="p">,</span> <span class="mf">1027.6</span><span class="p">,</span> <span class="mf">1027.7</span><span class="p">,</span> <span class="mf">1027.8</span><span class="p">,</span> <span class="mf">1027.9</span><span class="p">]</span>
<span class="n">dcpy</span><span class="o">.</span><span class="n">oceans</span><span class="o">.</span><span class="n">TSplot</span><span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">p06</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">],</span> <span class="n">p06</span><span class="o">.</span><span class="n">pres</span><span class="p">,</span> <span class="n">rho_levels</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/P06_13_0.png" src="_images/P06_13_0.png" />
</div>
</div>
<hr class="docutils" />
</div>
<hr class="docutils" />
<div class="section" id="calculate">
<h2>Calculate<a class="headerlink" href="#calculate" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nbins</span> <span class="o">=</span> <span class="mi">18</span>

<span class="n">p06</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p06</span><span class="p">[</span><span class="s1">&#39;sigma_0&#39;</span><span class="p">]</span>
<span class="n">eccograd</span><span class="p">[</span><span class="s1">&#39;ρmean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eccograd</span><span class="p">[</span><span class="s1">&#39;sigma_0&#39;</span><span class="p">]</span>


<span class="n">eccoKe</span> <span class="o">=</span> <span class="n">ed</span><span class="o">.</span><span class="n">process_transect_1d</span><span class="p">(</span><span class="n">p06</span><span class="p">,</span> <span class="n">eccograd</span><span class="p">,</span> <span class="s1">&#39;ECCO&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="n">nbins</span><span class="p">)</span>
<span class="n">ed</span><span class="o">.</span><span class="n">plot_bar_Ke</span><span class="p">(</span><span class="n">eccoKe</span><span class="p">,</span> <span class="n">Ke_log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">argoKe</span> <span class="o">=</span> <span class="n">ed</span><span class="o">.</span><span class="n">process_transect_1d</span><span class="p">(</span><span class="n">p06</span><span class="p">,</span> <span class="n">argograd</span><span class="p">,</span> <span class="s1">&#39;ARGO&#39;</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="n">nbins</span><span class="p">)</span>
<span class="n">ed</span><span class="o">.</span><span class="n">plot_bar_Ke</span><span class="p">(</span><span class="n">argoKe</span><span class="p">,</span> <span class="n">Ke_log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/P06_15_0.png" src="_images/P06_15_0.png" />
<img alt="_images/P06_15_1.png" src="_images/P06_15_1.png" />
</div>
</div>
<hr class="docutils" />
</div>
<hr class="docutils" />
<div class="section" id="calculate-2">
<h2>Calculate 2<a class="headerlink" href="#calculate-2" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">eddydiff</span> <span class="k">as</span> <span class="nn">ed</span>

<span class="n">p06</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s2">&quot;/home/deepak/work/eddydiff/datasets/P06/p06.nc&quot;</span><span class="p">)</span>
<span class="n">bathy</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">bathy</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">p06</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">p06</span><span class="p">[</span><span class="s2">&quot;KT&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">1e-3</span><span class="p">)</span>
<span class="n">p06</span><span class="p">[</span><span class="s2">&quot;bathy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bathy</span>
<span class="n">p06</span><span class="p">[</span><span class="s2">&quot;KtTz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">KT</span> <span class="o">*</span> <span class="n">p06</span><span class="o">.</span><span class="n">dTdz</span>
<span class="n">p06</span>

<span class="k">if</span> <span class="s2">&quot;eccograd&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
    <span class="n">eccograd</span><span class="p">,</span> <span class="n">argograd</span><span class="p">,</span> <span class="n">cole</span><span class="p">,</span> <span class="n">aber</span> <span class="o">=</span> <span class="n">ed</span><span class="o">.</span><span class="n">read_all_datasets</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;monthly&quot;</span><span class="p">,</span> <span class="n">transect</span><span class="o">=</span><span class="n">p06</span><span class="p">)</span>

<span class="c1"># use sigma_0</span>
<span class="n">p06</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p06</span><span class="p">[</span><span class="s2">&quot;sigma_0&quot;</span><span class="p">]</span>
<span class="n">eccograd</span><span class="p">[</span><span class="s2">&quot;ρmean&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eccograd</span><span class="p">[</span><span class="s2">&quot;sigma_0&quot;</span><span class="p">]</span>

<span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1024.6</span><span class="p">,</span>
        <span class="mf">1025.6</span><span class="p">,</span> <span class="mf">1025.8</span><span class="p">,</span>
        <span class="mf">1026.0</span><span class="p">,</span> <span class="mf">1026.15</span><span class="p">,</span> <span class="mf">1026.3</span><span class="p">,</span> <span class="mf">1026.45</span><span class="p">,</span> <span class="mf">1026.6</span><span class="p">,</span> <span class="mf">1026.8</span><span class="p">,</span> 
        <span class="mf">1027.0</span><span class="p">,</span> <span class="mf">1027.1</span><span class="p">,</span> <span class="mf">1027.2</span><span class="p">,</span> <span class="mf">1027.3</span><span class="p">,</span> <span class="mf">1027.4</span><span class="p">,</span> <span class="mf">1027.5</span><span class="p">,</span> <span class="mf">1027.6</span><span class="p">,</span> <span class="mf">1027.7</span><span class="p">,</span> <span class="mf">1027.8</span><span class="p">,</span> <span class="mf">1027.9</span><span class="p">]</span>
<span class="n">trdens</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">ed</span><span class="o">.</span><span class="n">bin_to_density_space</span><span class="p">(</span><span class="n">p06</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>

<span class="n">eccograd</span><span class="p">[</span><span class="s2">&quot;dist&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">dist</span>
<span class="n">eccodens</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ed</span><span class="o">.</span><span class="n">bin_to_density_space</span><span class="p">(</span><span class="n">eccograd</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s2">&quot;ρmean&quot;</span><span class="p">:</span> <span class="s2">&quot;rho&quot;</span><span class="p">}),</span> <span class="n">bins</span><span class="p">)</span>

<span class="n">newKe</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
<span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;KT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trdens</span><span class="o">.</span><span class="n">KT</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span>
<span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trdens</span><span class="o">.</span><span class="n">chi</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span>
<span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;KtTz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trdens</span><span class="o">.</span><span class="n">KtTz</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span>
<span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;dTiso&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eccodens</span><span class="o">.</span><span class="n">dTiso</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">))</span>
<span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;dTmdz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eccodens</span><span class="o">.</span><span class="n">dTdz</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">))</span>
<span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;dTdz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trdens</span><span class="o">.</span><span class="n">dTdz</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span>

<span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;Ke&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;KtTz&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;dTmdz&quot;</span><span class="p">]))</span> <span class="o">/</span> <span class="p">(</span>
    <span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;dTiso&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
<span class="p">)</span>

<span class="n">ed</span><span class="o">.</span><span class="n">plot_bar_Ke</span><span class="p">(</span><span class="n">newKe</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/home/deepak/miniconda3/envs/dcpy/lib/python3.7/site-packages/dask/array/numpy_compat.py:40: RuntimeWarning: invalid value encountered in true_divide
  x = np.divide(x1, x2, out)
</pre>
</div>
<img alt="_images/P06_17_1.png" src="_images/P06_17_1.png" />
</div>
</div>
<p>The above really awesome plot results after a few tweaks.</p>
<ol class="simple">
<li><p>Doing things in σ_0.</p></li>
<li><p>Handcrafted density bins using the T-S diagram as guide.
This is really important. Had to fiddle around slightly to not get negative
values. Biggest improvement is that I can now resolve thermocline and coarsen
the abyss. This is necessary because the big signal is in the thermocline and
the abyssal values need to account for topography. Automatically choosing
bins by pandas.cut/pandas.qcut would put too many bins down deep and fewer in
the thermocline.</p></li>
<li><p>Throwing out all KT &gt; 1e-3. This is really important. Will need to QC the
values coming out of the CTD_chipod analysis code.</p></li>
<li><p>Redid (vectorized) the bin-averaging by cast. This is a better way to do it I
think. Have to use pandas so I can groupby using multiple variables.</p></li>
<li><p>I tried fitting straight lines to the bin-averaged ECCO field to get dTiso
but this seems to under-estimate values. Currently I bin-average dTiso and
use that. This might not be crazy because it mirrors what I do with χ and we
know that χ has to go along with the appropriate local gradients. i.e. if
high χ coincides with high dTiso locally, we want the averaged dTiso to be
biased high since averaged χ will be biased high.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">Trms</span> <span class="o">=</span> <span class="n">trdens</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span>
<span class="n">Trms</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;RMS potential temp.&quot;</span>
<span class="n">Trms</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;°C&quot;</span>
<span class="n">Trms</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;rho&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">newKe</span><span class="o">.</span><span class="n">Ke</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">newKe</span><span class="o">.</span><span class="n">Ke</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;rho&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$σ_0$ [kg/m$^3$]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$σ_0$ [kg/m$^3$]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$K_e [m^2/s^2]$ &quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">newKe</span><span class="o">.</span><span class="n">Ke</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">newKe</span><span class="o">.</span><span class="n">Ke</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">),</span> <span class="n">trdens</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">),</span> <span class="s2">&quot;.-&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cole</span><span class="o">.</span><span class="n">diffusivity</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">),</span> <span class="n">cole</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;χpod estimate&quot;</span><span class="p">,</span> <span class="s2">&quot;Cole et al. (2015)&quot;</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Pressure [dbar]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$K_e [m^2/s]$ &quot;</span><span class="p">)</span>

<span class="n">dcpy</span><span class="o">.</span><span class="n">oceans</span><span class="o">.</span><span class="n">TSplot</span><span class="p">(</span>
    <span class="n">p06</span><span class="o">.</span><span class="n">S</span><span class="p">,</span>
    <span class="n">p06</span><span class="p">[</span><span class="s2">&quot;T&quot;</span><span class="p">],</span>
    <span class="n">rho_levels</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
    <span class="n">hexbin</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">plot_distrib</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">transect_name</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;../images/p06.png&quot;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/home/deepak/work/python/xarray/xarray/core/nanops.py:142: RuntimeWarning: Mean of empty slice
  return np.nanmean(a, axis=axis, dtype=dtype)
</pre>
</div>
<img alt="_images/P06_19_1.png" src="_images/P06_19_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">zvec</span> <span class="o">=</span> <span class="n">trdens</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span>
<span class="n">rhovec</span> <span class="o">=</span> <span class="n">newKe</span><span class="o">.</span><span class="n">rho</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">newKe</span><span class="o">.</span><span class="n">Ke</span><span class="p">,</span> <span class="n">zvec</span><span class="p">,</span> <span class="s2">&quot;.-&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cole</span><span class="o">.</span><span class="n">diffusivity</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">),</span> <span class="n">cole</span><span class="o">.</span><span class="n">P</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Pressure [dbar]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Transect-wide mean $K_e [m^2/s]$ &quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># https://matplotlib.org/gallery/subplots_axes_and_figures/fahrenheit_celsius_scales.html</span>
<span class="n">ax_z</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax_rho</span> <span class="o">=</span> <span class="n">ax_z</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">ax_rho</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">ax_z</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">())</span>
<span class="n">ax_rho</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax_rho</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">rr</span> <span class="o">-</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">rr</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">ax_z</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">(),</span> <span class="n">zvec</span><span class="p">,</span> <span class="n">rhovec</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">ax_rho</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$σ_0$ [kg/m$^3$]&quot;</span><span class="p">)</span>
<span class="n">ax_rho</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ax_z</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">aber</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">K_OC_LAT</span><span class="p">,</span>
        <span class="n">aber</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">K_OC_PSI</span><span class="p">,</span>
        <span class="n">aber</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">K_OC_SST</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s2">&quot;ro&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="p">[</span><span class="s2">&quot;χpod estimate&quot;</span><span class="p">,</span> <span class="s2">&quot;Cole et al. (2015)&quot;</span><span class="p">,</span> <span class="s2">&quot;Abernathey &amp; Marshall (2013)&quot;</span><span class="p">],</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">dcpy</span><span class="o">.</span><span class="n">oceans</span><span class="o">.</span><span class="n">TSplot</span><span class="p">(</span>
    <span class="n">p06</span><span class="o">.</span><span class="n">S</span><span class="p">,</span> <span class="n">p06</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rho_levels</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hexbin</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plot_distrib</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">p06</span><span class="o">.</span><span class="n">transect_name</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="c1"># plt.savefig(&quot;../images/p06-Ke.png&quot;, bbox_inches=&quot;tight&quot;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/home/deepak/work/python/xarray/xarray/core/nanops.py:142: RuntimeWarning: Mean of empty slice
  return np.nanmean(a, axis=axis, dtype=dtype)
</pre>
</div>
<img alt="_images/P06_20_1.png" src="_images/P06_20_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">newKe</span><span class="o">.</span><span class="n">Ke</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">newKe</span><span class="o">.</span><span class="n">Ke</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">cast</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">240</span><span class="p">))</span> <span class="c1">#.coarsen(cast=5).mean().plot(x=&quot;cast&quot;, norm=mpl.colors.LogNorm(0.1, 5e3), robust=True)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">259</span><span class="o">-</span><span class="mi">9</span><span class="n">f6bb7b7d953</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">newKe</span><span class="o">.</span><span class="n">Ke</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">newKe</span><span class="o">.</span><span class="n">Ke</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">cast</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">240</span><span class="p">))</span> <span class="c1">#.coarsen(cast=5).mean().plot(x=&quot;cast&quot;, norm=mpl.colors.LogNorm(0.1, 5e3), robust=True)</span>

<span class="nn">~/work/python/xarray/xarray/core/dataarray.py</span> in <span class="ni">isel</span><span class="nt">(self, indexers, drop, missing_dims, **indexers_kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1051</span>         <span class="c1"># lists, or zero or one-dimensional np.ndarray&#39;s</span>
<span class="g g-Whitespace">   </span><span class="mi">1052</span> 
<span class="ne">-&gt; </span><span class="mi">1053</span>         <span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">indexers</span><span class="p">,</span> <span class="n">missing_dims</span><span class="o">=</span><span class="n">missing_dims</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1054</span> 
<span class="g g-Whitespace">   </span><span class="mi">1055</span>         <span class="n">coords</span> <span class="o">=</span> <span class="p">{}</span>

<span class="nn">~/work/python/xarray/xarray/core/variable.py</span> in <span class="ni">isel</span><span class="nt">(self, indexers, missing_dims, **indexers_kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1062</span> 
<span class="g g-Whitespace">   </span><span class="mi">1063</span>         <span class="n">key</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">indexers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span> <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1064</span>         <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1065</span> 
<span class="g g-Whitespace">   </span><span class="mi">1066</span>     <span class="k">def</span> <span class="nf">squeeze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

<span class="nn">~/work/python/xarray/xarray/core/variable.py</span> in <span class="ni">__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span>         <span class="n">array</span> <span class="err">`</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="err">`</span> <span class="n">directly</span><span class="o">.</span>
<span class="g g-Whitespace">    </span><span class="mi">703</span>         <span class="s2">&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">704</span><span class="s2">         dims, indexer, new_order = self._broadcast_indexes(key)</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span><span class="s2">         data = as_indexable(self._data)[indexer]</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span><span class="s2">         if new_order:</span>

<span class="nn">~/work/python/xarray/xarray/core/variable.py</span> in <span class="ni">_broadcast_indexes</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">    </span><span class="mi">541</span><span class="s2"> </span>
<span class="g g-Whitespace">    </span><span class="mi">542</span><span class="s2">         if all(isinstance(k, BASIC_INDEXING_TYPES) for k in key):</span>
<span class="ne">--&gt; </span><span class="mi">543</span><span class="s2">             return self._broadcast_indexes_basic(key)</span>
<span class="g g-Whitespace">    </span><span class="mi">544</span><span class="s2"> </span>
<span class="g g-Whitespace">    </span><span class="mi">545</span><span class="s2">         self._validate_indexers(key)</span>

<span class="nn">~/work/python/xarray/xarray/core/variable.py</span> in <span class="ni">_broadcast_indexes_basic</span><span class="nt">(self, key)</span>
<span class="nn">    569             dim for k, dim</span> in <span class="ni">zip(key, self.dims) if not isinstance</span><span class="nt">(k, integer_types)</span>
<span class="g g-Whitespace">    </span><span class="mi">570</span><span class="s2">         )</span>
<span class="ne">--&gt; </span><span class="mi">571</span><span class="s2">         return dims, BasicIndexer(key), None</span>
<span class="g g-Whitespace">    </span><span class="mi">572</span><span class="s2"> </span>
<span class="g g-Whitespace">    </span><span class="mi">573</span><span class="s2">     def _validate_indexers(self, key):</span>

<span class="nn">~/work/python/xarray/xarray/core/indexing.py</span> in <span class="ni">__init__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">    </span><span class="mi">376</span><span class="s2">             new_key.append(k)</span>
<span class="g g-Whitespace">    </span><span class="mi">377</span><span class="s2"> </span>
<span class="ne">--&gt; </span><span class="mi">378</span><span class="s2">         super().__init__(new_key)</span>
<span class="g g-Whitespace">    </span><span class="mi">379</span><span class="s2"> </span>
<span class="g g-Whitespace">    </span><span class="mi">380</span><span class="s2"> </span>

<span class="nn">~/work/python/xarray/xarray/core/indexing.py</span> in <span class="ni">__init__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span><span class="s2">         if type(self) is ExplicitIndexer:</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span><span class="s2">             raise TypeError(&quot;cannot instantiate base ExplicitIndexer objects&quot;)</span>
<span class="ne">--&gt; </span><span class="mi">331</span><span class="s2">         self._key = tuple(key)</span>
<span class="g g-Whitespace">    </span><span class="mi">332</span><span class="s2"> </span>
<span class="g g-Whitespace">    </span><span class="mi">333</span><span class="s2">     @property</span>

<span class="ne">TypeError</span>: descriptor &#39;_key&#39; for &#39;ExplicitIndexer&#39; objects doesn&#39;t apply to &#39;BasicIndexer&#39; object
</pre></div>
</div>
</div>
</div>
<p>Linear fits to ECCO T along ρ surfaces in the along-transect direction doesn’t work. The field has too much curvature</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># recalculate gradients from mean fields in density space</span>
<span class="n">dTiso</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">eccodens</span><span class="o">.</span><span class="n">rho</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">dTiso</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;dTiso&quot;</span>
<span class="n">dTdz</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">eccodens</span><span class="o">.</span><span class="n">rho</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">dTdz</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;dTdz&quot;</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">rr</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">eccodens</span><span class="o">.</span><span class="n">rho</span><span class="p">):</span>
    <span class="n">Tvec</span> <span class="o">=</span> <span class="n">eccodens</span><span class="o">.</span><span class="n">Tmean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">rho</span><span class="o">=</span><span class="n">rr</span><span class="p">)</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">Tvec</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Tvec</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">r_value</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">std_err</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">linregress</span><span class="p">(</span>
            <span class="n">eccodens</span><span class="o">.</span><span class="n">dist</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">Tvec</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="n">dTiso</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">slope</span>

<span class="n">dTdz</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">eccodens</span><span class="o">.</span><span class="n">Tmean</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">),</span> <span class="n">eccodens</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">))</span>

<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dTiso</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;rho&quot;</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eccodens</span><span class="o">.</span><span class="n">dTiso</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;rho&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5e-6</span><span class="p">])</span>
<span class="n">f</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="s2">&quot;recalculated from density-averaged field&quot;</span><span class="p">,</span>
        <span class="s2">&quot;along-transect mean of local gradient&quot;</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="n">dTdz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;rho&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">eccodens</span><span class="o">.</span><span class="n">dTdz</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;rho&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f1727a84630&gt;]
</pre></div>
</div>
<img alt="_images/P06_23_1.png" src="_images/P06_23_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nn</span> <span class="o">=</span> <span class="mi">6</span>

<span class="n">Tvec</span> <span class="o">=</span> <span class="n">eccodens</span><span class="o">.</span><span class="n">Tmean</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">rho</span><span class="o">=</span><span class="n">nn</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">Tvec</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eccodens</span><span class="o">.</span><span class="n">dist</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">Tvec</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">],</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">eccodens</span><span class="o">.</span><span class="n">dist</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="n">Tvec</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">+</span> <span class="n">dTiso</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">rho</span><span class="o">=</span><span class="n">nn</span><span class="p">)</span> <span class="o">*</span>  <span class="p">(</span><span class="n">eccodens</span><span class="o">.</span><span class="n">dist</span><span class="o">-</span><span class="n">eccodens</span><span class="o">.</span><span class="n">dist</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f1725c2a6d8&gt;]
</pre></div>
</div>
<img alt="_images/P06_24_1.png" src="_images/P06_24_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">argograd</span><span class="o">.</span><span class="n">dTiso</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fd75806b350&gt;
</pre></div>
</div>
<img alt="_images/P06_25_1.png" src="_images/P06_25_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eccograd</span><span class="o">.</span><span class="n">dTiso</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;cast&#39;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fd75a8a8510&gt;
</pre></div>
</div>
<img alt="_images/P06_26_1.png" src="_images/P06_26_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clim</span> <span class="o">=</span> <span class="n">eccograd</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">clim</span> <span class="o">=</span> <span class="n">clim</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">trmean</span><span class="p">,</span> <span class="n">ρbins</span> <span class="o">=</span> <span class="n">ed</span><span class="o">.</span><span class="n">average_transect_1d</span><span class="p">(</span><span class="n">p06</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    
<span class="n">climrho</span> <span class="o">=</span> <span class="n">clim</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">clim</span><span class="o">.</span><span class="n">ρmean</span><span class="p">,</span> <span class="n">ρbins</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cole</span><span class="o">.</span><span class="n">diffusivity</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(),</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;cast&#39;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">55</span><span class="o">-</span><span class="mi">05</span><span class="n">ef08ea103d</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">cole</span><span class="o">.</span><span class="n">diffusivity</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(),</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;cast&#39;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;mpl&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cole</span><span class="o">.</span><span class="n">diffusivity</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;cast&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f1730d097b8&gt;]
</pre></div>
</div>
<img alt="_images/P06_29_1.png" src="_images/P06_29_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clim</span> <span class="o">=</span> <span class="n">eccograd</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">transect</span> <span class="o">=</span> <span class="n">p06</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">P</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">))</span>

<span class="n">trmean</span><span class="p">,</span> <span class="n">ρbins</span> <span class="o">=</span> <span class="n">ed</span><span class="o">.</span><span class="n">average_transect_1d</span><span class="p">(</span><span class="n">transect</span><span class="p">,</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">gradmean</span> <span class="o">=</span> <span class="n">ed</span><span class="o">.</span><span class="n">average_clim</span><span class="p">(</span><span class="n">clim</span><span class="p">,</span> <span class="n">transect</span><span class="p">,</span> <span class="n">ρbins</span><span class="p">)</span>

<span class="n">Ke</span> <span class="o">=</span> <span class="n">ed</span><span class="o">.</span><span class="n">estimate_Ke</span><span class="p">(</span><span class="n">trmean</span><span class="p">,</span> <span class="n">gradmean</span><span class="p">)</span>
<span class="n">Ke</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chi</th>
      <th>KtTz</th>
      <th>dTdz</th>
      <th>dTmdz</th>
      <th>dTiso</th>
      <th>KT</th>
      <th>Ke</th>
    </tr>
    <tr>
      <th>rho</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>(1024.8000000000002, 1026.7]</th>
      <td>1.340903e-07</td>
      <td>1.843108e-06</td>
      <td>0.021105</td>
      <td>0.021170</td>
      <td>4.694987e-06</td>
      <td>0.000118</td>
      <td>1271.439129</td>
    </tr>
    <tr>
      <th>(1026.7, 1027.5]</th>
      <td>8.350073e-08</td>
      <td>1.431120e-06</td>
      <td>0.026548</td>
      <td>0.023706</td>
      <td>3.095114e-06</td>
      <td>0.000058</td>
      <td>816.732447</td>
    </tr>
    <tr>
      <th>(1027.5, 1028.2]</th>
      <td>6.809042e-08</td>
      <td>1.229691e-06</td>
      <td>0.024866</td>
      <td>0.026552</td>
      <td>2.792055e-06</td>
      <td>0.000053</td>
      <td>178.802085</td>
    </tr>
    <tr>
      <th>(1028.2, 1028.9]</th>
      <td>3.888472e-08</td>
      <td>9.499299e-07</td>
      <td>0.018603</td>
      <td>0.019622</td>
      <td>1.978210e-06</td>
      <td>0.000053</td>
      <td>205.196687</td>
    </tr>
    <tr>
      <th>(1028.9, 1029.4]</th>
      <td>1.696346e-08</td>
      <td>6.028373e-07</td>
      <td>0.011949</td>
      <td>0.011681</td>
      <td>1.093078e-06</td>
      <td>0.000053</td>
      <td>1205.030222</td>
    </tr>
    <tr>
      <th>(1029.4, 1029.9]</th>
      <td>1.025537e-08</td>
      <td>4.112075e-07</td>
      <td>0.008578</td>
      <td>0.009867</td>
      <td>4.934073e-07</td>
      <td>0.000047</td>
      <td>4396.180518</td>
    </tr>
    <tr>
      <th>(1029.9, 1030.4]</th>
      <td>6.098227e-09</td>
      <td>3.541930e-07</td>
      <td>0.006906</td>
      <td>0.006893</td>
      <td>3.572366e-07</td>
      <td>0.000053</td>
      <td>4761.760099</td>
    </tr>
    <tr>
      <th>(1030.4, 1030.9]</th>
      <td>5.922741e-09</td>
      <td>3.396340e-07</td>
      <td>0.006503</td>
      <td>0.005814</td>
      <td>3.952476e-07</td>
      <td>0.000051</td>
      <td>6315.357062</td>
    </tr>
    <tr>
      <th>(1030.9, 1031.4]</th>
      <td>4.479737e-09</td>
      <td>3.283833e-07</td>
      <td>0.006106</td>
      <td>0.005641</td>
      <td>3.961862e-07</td>
      <td>0.000056</td>
      <td>2468.021433</td>
    </tr>
    <tr>
      <th>(1031.4, 1031.9]</th>
      <td>4.335862e-09</td>
      <td>3.358884e-07</td>
      <td>0.005741</td>
      <td>0.005445</td>
      <td>3.654930e-07</td>
      <td>0.000059</td>
      <td>2536.931307</td>
    </tr>
    <tr>
      <th>(1031.9, 1032.4]</th>
      <td>3.778694e-09</td>
      <td>3.191589e-07</td>
      <td>0.005229</td>
      <td>0.006691</td>
      <td>3.008868e-07</td>
      <td>0.000064</td>
      <td>-2719.446279</td>
    </tr>
    <tr>
      <th>(1032.4, 1032.9]</th>
      <td>2.663402e-09</td>
      <td>2.663522e-07</td>
      <td>0.004435</td>
      <td>0.005343</td>
      <td>2.868961e-07</td>
      <td>0.000064</td>
      <td>-1111.907562</td>
    </tr>
    <tr>
      <th>(1032.9, 1033.4]</th>
      <td>2.050237e-09</td>
      <td>2.458359e-07</td>
      <td>0.003670</td>
      <td>0.002568</td>
      <td>1.781828e-07</td>
      <td>0.000071</td>
      <td>12403.643288</td>
    </tr>
    <tr>
      <th>(1033.4, 1033.9]</th>
      <td>1.563165e-09</td>
      <td>2.117540e-07</td>
      <td>0.003097</td>
      <td>0.003163</td>
      <td>1.434013e-07</td>
      <td>0.000068</td>
      <td>5439.135721</td>
    </tr>
    <tr>
      <th>(1033.9, 1034.4]</th>
      <td>1.084065e-09</td>
      <td>1.862677e-07</td>
      <td>0.002532</td>
      <td>0.002644</td>
      <td>1.283914e-07</td>
      <td>0.000076</td>
      <td>3006.651780</td>
    </tr>
    <tr>
      <th>(1034.4, 1034.9]</th>
      <td>8.051773e-10</td>
      <td>1.646219e-07</td>
      <td>0.002085</td>
      <td>0.002116</td>
      <td>1.193445e-07</td>
      <td>0.000082</td>
      <td>3804.070508</td>
    </tr>
    <tr>
      <th>(1034.9, 1035.4]</th>
      <td>5.643653e-10</td>
      <td>1.386612e-07</td>
      <td>0.001779</td>
      <td>0.001680</td>
      <td>1.091446e-07</td>
      <td>0.000080</td>
      <td>4130.684457</td>
    </tr>
    <tr>
      <th>(1035.4, 1035.9]</th>
      <td>3.849335e-10</td>
      <td>1.173186e-07</td>
      <td>0.001456</td>
      <td>NaN</td>
      <td>1.000824e-07</td>
      <td>0.000083</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>(1035.9, 1036.4]</th>
      <td>2.681242e-10</td>
      <td>1.045344e-07</td>
      <td>0.001217</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000090</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>(1036.4, 1036.9]</th>
      <td>2.172361e-10</td>
      <td>9.460649e-08</td>
      <td>0.001071</td>
      <td>NaN</td>
      <td>8.956461e-08</td>
      <td>0.000094</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compare_transect_clim</span><span class="p">(</span><span class="n">transect</span><span class="p">,</span> <span class="n">clim</span><span class="p">):</span>

    <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">aa</span><span class="p">,</span> <span class="p">(</span><span class="n">trvar</span><span class="p">,</span> <span class="n">climvar</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
        <span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="s2">&quot;rho&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Tmean&quot;</span><span class="p">,</span> <span class="s2">&quot;Smean&quot;</span><span class="p">,</span> <span class="s2">&quot;ρmean&quot;</span><span class="p">])</span>
    <span class="p">):</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">transect</span><span class="p">[</span><span class="n">trvar</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="mi">20</span><span class="p">,</span> <span class="n">retbins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="p">(</span>
            <span class="n">clim</span><span class="p">[</span><span class="n">climvar</span><span class="p">]</span>
            <span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="o">**</span><span class="n">ed</span><span class="o">.</span><span class="n">get_region_from_transect</span><span class="p">(</span><span class="n">p06</span><span class="p">))</span>
            <span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">aa</span><span class="p">],</span>
                <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span>
                <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">RdYlBu</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="p">(</span>
            <span class="n">transect</span><span class="p">[</span><span class="n">trvar</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">aa</span><span class="p">],</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="n">trname</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">transect</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;transect_name&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;transect_name&quot;</span> <span class="ow">in</span> <span class="n">transect</span><span class="o">.</span><span class="n">attrs</span>
        <span class="k">else</span> <span class="s2">&quot;transect&quot;</span>
    <span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Compare &quot;</span> <span class="o">+</span> <span class="n">trname</span> <span class="o">+</span> <span class="s2">&quot; vs &quot;</span> <span class="o">+</span> <span class="n">clim</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>


<span class="n">compare_transect_clim</span><span class="p">(</span><span class="n">p06</span><span class="p">,</span> <span class="n">eccograd</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">2400</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="c1">#  compare_transect_clim(p06, argograd)</span>
<span class="c1"># plt.gca().set_ylim((2400, 0))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-19-6a0f5cf774f5&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">21</span> 
<span class="g g-Whitespace">     </span><span class="mi">22</span> 
<span class="ne">---&gt; </span><span class="mi">23</span> <span class="n">compare_transect_clim</span><span class="p">(</span><span class="n">p06</span><span class="p">,</span> <span class="n">eccograd</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">8</span><span class="p">))</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">2400</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="g g-Whitespace">     </span><span class="mi">25</span> <span class="c1">#  compare_transect_clim(p06, argograd)</span>

<span class="nn">~/work/python/xarray/xarray/core/dataset.py</span> in <span class="ni">sel</span><span class="nt">(self, indexers, method, tolerance, drop, **indexers_kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1507</span>         <span class="n">indexers</span> <span class="o">=</span> <span class="n">either_dict_or_kwargs</span><span class="p">(</span><span class="n">indexers</span><span class="p">,</span> <span class="n">indexers_kwargs</span><span class="p">,</span> <span class="s1">&#39;sel&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1508</span>         <span class="n">pos_indexers</span><span class="p">,</span> <span class="n">new_indexes</span> <span class="o">=</span> <span class="n">remap_label_indexers</span><span class="p">(</span>
<span class="ne">-&gt; </span><span class="mi">1509</span>             <span class="bp">self</span><span class="p">,</span> <span class="n">indexers</span><span class="o">=</span><span class="n">indexers</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">tolerance</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1510</span>         <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">indexers</span><span class="o">=</span><span class="n">pos_indexers</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="n">drop</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1511</span>         <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">_replace_indexes</span><span class="p">(</span><span class="n">new_indexes</span><span class="p">)</span>

<span class="nn">~/work/python/xarray/xarray/core/coordinates.py</span> in <span class="ni">remap_label_indexers</span><span class="nt">(obj, indexers, method, tolerance, **indexers_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">353</span> 
<span class="g g-Whitespace">    </span><span class="mi">354</span>     <span class="n">pos_indexers</span><span class="p">,</span> <span class="n">new_indexes</span> <span class="o">=</span> <span class="n">indexing</span><span class="o">.</span><span class="n">remap_label_indexers</span><span class="p">(</span>
<span class="ne">--&gt; </span><span class="mi">355</span>         <span class="n">obj</span><span class="p">,</span> <span class="n">v_indexers</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">tolerance</span>
<span class="g g-Whitespace">    </span><span class="mi">356</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">357</span>     <span class="c1"># attach indexer&#39;s coordinate to pos_indexers</span>

<span class="nn">~/work/python/xarray/xarray/core/indexing.py</span> in <span class="ni">remap_label_indexers</span><span class="nt">(data_obj, indexers, method, tolerance)</span>
<span class="g g-Whitespace">    </span><span class="mi">235</span>     <span class="n">new_indexes</span> <span class="o">=</span> <span class="p">{}</span>
<span class="g g-Whitespace">    </span><span class="mi">236</span> 
<span class="ne">--&gt; </span><span class="mi">237</span>     <span class="n">dim_indexers</span> <span class="o">=</span> <span class="n">get_dim_indexers</span><span class="p">(</span><span class="n">data_obj</span><span class="p">,</span> <span class="n">indexers</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">238</span>     <span class="k">for</span> <span class="n">dim</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">dim_indexers</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">239</span>         <span class="k">try</span><span class="p">:</span>

<span class="nn">~/work/python/xarray/xarray/core/indexing.py</span> in <span class="ni">get_dim_indexers</span><span class="nt">(data_obj, indexers)</span>
<span class="g g-Whitespace">    </span><span class="mi">203</span>     <span class="k">if</span> <span class="n">invalid</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">204</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dimensions or multi-index levels </span><span class="si">%r</span><span class="s2"> do not exist&quot;</span>
<span class="ne">--&gt; </span><span class="mi">205</span>                          <span class="o">%</span> <span class="n">invalid</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span> 
<span class="g g-Whitespace">    </span><span class="mi">207</span>     <span class="n">level_indexers</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>

<span class="ne">ValueError</span>: dimensions or multi-index levels [&#39;time&#39;] do not exist
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
</div>
<hr class="docutils" />
<div class="section" id="calculate-3">
<h2>Calculate 3<a class="headerlink" href="#calculate-3" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">aimport</span> <span class="n">eddydiff</span>
<span class="kn">import</span> <span class="nn">eddydiff</span> <span class="k">as</span> <span class="nn">ed</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ed</span><span class="o">.</span><span class="n">eddydiff</span><span class="o">.</span><span class="n">format_ecco2</span><span class="p">(</span><span class="n">kecco</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt, dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:     (lat: 360, lon: 720, pres: 50)
Coordinates:
  * lat         (lat) float64 -89.75 -89.25 -88.75 -88.25 ... 88.75 89.25 89.75
  * lon         (lon) float64 -179.8 -179.2 -178.8 -178.2 ... 178.8 179.2 179.8
  * pres        (pres) float64 1.0 2.0 3.0 4.0 5.0 ... 46.0 47.0 48.0 49.0 50.0
Data variables:
    Kgm_ECCOv4  (lat, lon, pres) float32 nan nan nan nan nan ... nan nan nan nan
Attributes:
    title:          Bolus Velocity Coefficient (ECCO v4 Estimate; Forget et a...
    Format:         native grid (nctiles w. 52 tiles)
    source:         ECCO consortium (http://ecco-group.org/)
    institution:    MIT
    history:         files revision history :\n    2016/05/07 : release of re...
    references:     Forget, G., J.-M. Campin, P. Heimbach, C. N. Hill, R. M. ...
    _FillValue:     nan
    missing_value:  nan
    Conventions:    CF-1.6
    date:           10-May-2016</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-832be6d1-7e29-4baf-a385-85fbec711dfd' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-832be6d1-7e29-4baf-a385-85fbec711dfd' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 360</li><li><span class='xr-has-index'>lon</span>: 720</li><li><span class='xr-has-index'>pres</span>: 50</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-0d01488f-aa84-463b-b755-2bcc0dfb919a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0d01488f-aa84-463b-b755-2bcc0dfb919a' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-89.75 -89.25 ... 89.25 89.75</div><input id='attrs-a5ca09ee-026f-44c0-998a-bf90dd0ba9a1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a5ca09ee-026f-44c0-998a-bf90dd0ba9a1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-db9532ee-4bc2-4b8c-917f-595f2ae11c9a' class='xr-var-data-in' type='checkbox'><label for='data-db9532ee-4bc2-4b8c-917f-595f2ae11c9a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([-89.75, -89.25, -88.75, ...,  88.75,  89.25,  89.75])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-179.8 -179.2 ... 179.2 179.8</div><input id='attrs-62dd4c73-9e63-45f7-8dbf-3c743f1f3c16' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-62dd4c73-9e63-45f7-8dbf-3c743f1f3c16' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-616f86ae-7612-4580-b90f-278a58ba3c41' class='xr-var-data-in' type='checkbox'><label for='data-616f86ae-7612-4580-b90f-278a58ba3c41' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([-179.75, -179.25, -178.75, ...,  178.75,  179.25,  179.75])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>pres</span></div><div class='xr-var-dims'>(pres)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 2.0 3.0 4.0 ... 48.0 49.0 50.0</div><input id='attrs-06c8f4a8-61fa-4123-8d12-6538964d9655' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-06c8f4a8-61fa-4123-8d12-6538964d9655' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-427b275a-4749-4c14-accd-1e69607ad3e5' class='xr-var-data-in' type='checkbox'><label for='data-427b275a-4749-4c14-accd-1e69607ad3e5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>array index 3</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><pre class='xr-var-data'>array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12., 13., 14.,
       15., 16., 17., 18., 19., 20., 21., 22., 23., 24., 25., 26., 27., 28.,
       29., 30., 31., 32., 33., 34., 35., 36., 37., 38., 39., 40., 41., 42.,
       43., 44., 45., 46., 47., 48., 49., 50.])</pre></li></ul></div></li><li class='xr-section-item'><input id='section-29eb1295-abbb-4b76-b2db-ae522be37e1a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-29eb1295-abbb-4b76-b2db-ae522be37e1a' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Kgm_ECCOv4</span></div><div class='xr-var-dims'>(lat, lon, pres)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-5abb898e-b64a-4904-9cc7-fedeca0365cd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5abb898e-b64a-4904-9cc7-fedeca0365cd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e306ea6d-46cd-416b-8ca1-42e99c3b4159' class='xr-var-data-in' type='checkbox'><label for='data-e306ea6d-46cd-416b-8ca1-42e99c3b4159' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Bolus Velocity Coefficient (ECCO v4 Estimate; Forget et al 2015a,b,2016)</dd><dt><span>units :</span></dt><dd>m^2/s</dd></dl></div><pre class='xr-var-data'>array([[[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       ...,

       [[659.4894 , 500.91663, 320.21997, ...,       nan,       nan,
               nan],
        [660.7585 , 502.7165 , 322.60538, ...,       nan,       nan,
               nan],
        [662.02216, 504.51074, 324.98486, ...,       nan,       nan,
               nan],
        ...,
        [655.61163, 495.4347 , 312.96793, ...,       nan,       nan,
               nan],
        [656.9137 , 497.27267, 315.39694, ...,       nan,       nan,
               nan],
        [658.20605, 499.1001 , 317.81445, ...,       nan,       nan,
               nan]],

       [[603.9421 , 434.1819 , 238.91277, ...,       nan,       nan,
               nan],
        [604.6996 , 435.15845, 240.00772, ...,       nan,       nan,
               nan],
        [605.4477 , 436.12415, 241.09155, ...,       nan,       nan,
               nan],
        ...,
        [601.6406 , 431.22247, 235.60126, ...,       nan,       nan,
               nan],
        [602.41565, 432.2176 , 236.71368, ...,       nan,       nan,
               nan],
        [603.1812 , 433.20172, 237.8149 , ...,       nan,       nan,
               nan]],

       [[554.81036, 379.41898, 189.04736, ...,       nan,       nan,
               nan],
        [555.0568 , 379.70895, 189.2995 , ...,       nan,       nan,
               nan],
        [555.29944, 379.99478, 189.54868, ...,       nan,       nan,
               nan],
        ...,
        [554.06714, 378.54477, 188.28748, ...,       nan,       nan,
               nan],
        [554.31366, 378.83453, 188.53893, ...,       nan,       nan,
               nan],
        [554.5586 , 379.1227 , 188.78952, ...,       nan,       nan,
               nan]]], dtype=float32)</pre></li></ul></div></li><li class='xr-section-item'><input id='section-f5d3fe45-ad7a-42c8-85a5-39c7e38f5032' class='xr-section-summary-in' type='checkbox'  ><label for='section-f5d3fe45-ad7a-42c8-85a5-39c7e38f5032' class='xr-section-summary' >Attributes: <span>(10)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>Bolus Velocity Coefficient (ECCO v4 Estimate; Forget et al 2015a,b,2016) -- ECCO v4 ocean state estimate, release 2 -- 1992-2011</dd><dt><span>Format :</span></dt><dd>native grid (nctiles w. 52 tiles)</dd><dt><span>source :</span></dt><dd>ECCO consortium (http://ecco-group.org/)</dd><dt><span>institution :</span></dt><dd>MIT</dd><dt><span>history :</span></dt><dd> files revision history :
    2016/05/07 : release of remote sensed variables (GF)
    2015/12/12 : second release of ECCO v4 (GF)
    2014/02/04 : initial release of ECCO v4 (GF)
 estimate revision history :
    r4it12   : include geothermal heating, targeted bottom
      viscosity, and 2000-2011 wind stress adjustments that
      were omitted in r4it11; adjust global mean precipitation
      to closely match aviso global mean time series; put
      adjusted forcing fields on llc90 grid.
    r4it11   : reduce background vertical viscosity
    r4it10   : cleanup control vector adjustments
    r4it9    : optim. global mean sea level alone
    r4it0-8  : full adjoint iterations, omitting
      global mean sea level altimetry constraint.</dd><dt><span>references :</span></dt><dd>Forget, G., J.-M. Campin, P. Heimbach, C. N. Hill, R. M. Ponte, 
 and C. Wunsch, 2015: ECCO version 4: an integrated framework for 
 non-linear inverse modeling and global ocean state estimation. 
 Geoscientific Model Development, 8, 3071-3104, doi:10.5194/gmd-8-3071-2015 
Forget, G., D. Ferreira, and X. Liang, 2015: On the observability of turbulent 
 transport rates by argo: supporting evidence from an inversion experiment. 
 Ocean Science, 11, 839853, doi:10.5194/os-11-839-2015 
Forget, G., J.-M. Campin, P. Heimbach, C. N. Hill, R. M. Ponte, and C. Wunsch, 2016: 
 ECCO version 4: Second Release, http://hdl.handle.net/1721.1/102062</dd><dt><span>_FillValue :</span></dt><dd>nan</dd><dt><span>missing_value :</span></dt><dd>nan</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>date :</span></dt><dd>10-May-2016</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kecco</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s2">&quot;../datasets/ecco/interp_Kgm_ECCOv4.nc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">ed</span><span class="o">.</span><span class="n">eddydiff</span><span class="o">.</span><span class="n">format_ecco2</span><span class="p">)</span><span class="o">.</span><span class="n">Kgm_ECCOv4</span>
<span class="n">kecco</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt, dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;Kgm_ECCOv4&#x27; (lat: 360, lon: 720, pres: 50)&gt;
array([[[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       ...,

       [[449.7568 , 269.2915 , 146.21722, ...,       nan,       nan,
               nan],
        [449.26746, 269.019  , 146.27124, ...,       nan,       nan,
               nan],
        [448.78452, 268.7531 , 146.32971, ...,       nan,       nan,
               nan],
        ...,
        [451.28967, 270.1708 , 146.09207, ...,       nan,       nan,
               nan],
        [450.76907, 269.86832, 146.12814, ...,       nan,       nan,
               nan],
        [450.25885, 269.57617, 146.1708 , ...,       nan,       nan,
               nan]],

       [[488.71448, 306.11115, 164.50214, ...,       nan,       nan,
               nan],
        [488.2017 , 305.6677 , 164.3479 , ...,       nan,       nan,
               nan],
        [487.69604, 305.23145, 164.19669, ...,       nan,       nan,
               nan],
        ...,
        [490.2769 , 307.46857, 164.97755, ...,       nan,       nan,
               nan],
        [489.7501 , 307.00974, 164.81644, ...,       nan,       nan,
               nan],
        [489.23047, 306.55817, 164.65837, ...,       nan,       nan,
               nan]],

       [[521.16046, 340.92065, 172.53606, ...,       nan,       nan,
               nan],
        [520.9415 , 340.68723, 172.3936 , ...,       nan,       nan,
               nan],
        [520.72534, 340.4571 , 172.25227, ...,       nan,       nan,
               nan],
        ...,
        [521.8189 , 341.62262, 172.96187, ...,       nan,       nan,
               nan],
        [521.60065, 341.38974, 172.82086, ...,       nan,       nan,
               nan],
        [521.38165, 341.15634, 172.6784 , ...,       nan,       nan,
               nan]]], dtype=float32)
Coordinates:
  * lat      (lat) float64 -89.75 -89.25 -88.75 -88.25 ... 88.75 89.25 89.75
  * lon      (lon) float64 0.25 0.75 1.25 1.75 2.25 ... 358.2 358.8 359.2 359.8
  * pres     (pres) float64 5.0 15.0 25.0 35.0 ... 5.039e+03 5.461e+03 5.906e+03
Attributes:
    long_name:  Bolus Velocity Coefficient (ECCO v4 Estimate; Forget et al 20...
    units:      m^2/s</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'Kgm_ECCOv4'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 360</li><li><span class='xr-has-index'>lon</span>: 720</li><li><span class='xr-has-index'>pres</span>: 50</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-c64799bc-6d36-4f8b-abca-91ac55222694' class='xr-array-in' type='checkbox' ><label for='section-c64799bc-6d36-4f8b-abca-91ac55222694' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>nan nan nan nan nan nan nan ... 967.74115 972.6106 nan nan nan nan</span></div><pre class='xr-array-data'>array([[[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       [[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        ...,
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan]],

       ...,

       [[449.7568 , 269.2915 , 146.21722, ...,       nan,       nan,
               nan],
        [449.26746, 269.019  , 146.27124, ...,       nan,       nan,
               nan],
        [448.78452, 268.7531 , 146.32971, ...,       nan,       nan,
               nan],
        ...,
        [451.28967, 270.1708 , 146.09207, ...,       nan,       nan,
               nan],
        [450.76907, 269.86832, 146.12814, ...,       nan,       nan,
               nan],
        [450.25885, 269.57617, 146.1708 , ...,       nan,       nan,
               nan]],

       [[488.71448, 306.11115, 164.50214, ...,       nan,       nan,
               nan],
        [488.2017 , 305.6677 , 164.3479 , ...,       nan,       nan,
               nan],
        [487.69604, 305.23145, 164.19669, ...,       nan,       nan,
               nan],
        ...,
        [490.2769 , 307.46857, 164.97755, ...,       nan,       nan,
               nan],
        [489.7501 , 307.00974, 164.81644, ...,       nan,       nan,
               nan],
        [489.23047, 306.55817, 164.65837, ...,       nan,       nan,
               nan]],

       [[521.16046, 340.92065, 172.53606, ...,       nan,       nan,
               nan],
        [520.9415 , 340.68723, 172.3936 , ...,       nan,       nan,
               nan],
        [520.72534, 340.4571 , 172.25227, ...,       nan,       nan,
               nan],
        ...,
        [521.8189 , 341.62262, 172.96187, ...,       nan,       nan,
               nan],
        [521.60065, 341.38974, 172.82086, ...,       nan,       nan,
               nan],
        [521.38165, 341.15634, 172.6784 , ...,       nan,       nan,
               nan]]], dtype=float32)</pre></div></li><li class='xr-section-item'><input id='section-d0cc3555-b03f-4f5a-8664-71d6109d0d5b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d0cc3555-b03f-4f5a-8664-71d6109d0d5b' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-89.75 -89.25 ... 89.25 89.75</div><input id='attrs-c75a29c6-cb54-49d2-adf0-89eb54489151' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c75a29c6-cb54-49d2-adf0-89eb54489151' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2bfcb924-8056-440f-9f9e-b3f5e3121592' class='xr-var-data-in' type='checkbox'><label for='data-2bfcb924-8056-440f-9f9e-b3f5e3121592' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([-89.75, -89.25, -88.75, ...,  88.75,  89.25,  89.75])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.25 0.75 1.25 ... 359.2 359.8</div><input id='attrs-5971773a-0e8e-4e72-9ce9-3d8de2d772aa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5971773a-0e8e-4e72-9ce9-3d8de2d772aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d6ba22ff-6269-4f73-8fac-2283a2604169' class='xr-var-data-in' type='checkbox'><label for='data-d6ba22ff-6269-4f73-8fac-2283a2604169' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([2.5000e-01, 7.5000e-01, 1.2500e+00, ..., 3.5875e+02, 3.5925e+02,
       3.5975e+02])</pre></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>pres</span></div><div class='xr-var-dims'>(pres)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.0 15.0 ... 5.461e+03 5.906e+03</div><input id='attrs-161fbdbf-fbcc-4020-b351-9078083fca54' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-161fbdbf-fbcc-4020-b351-9078083fca54' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d3e67692-3069-40ee-9ec9-bc75d1b4a878' class='xr-var-data-in' type='checkbox'><label for='data-d3e67692-3069-40ee-9ec9-bc75d1b4a878' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><pre class='xr-var-data'>array([5.000000e+00, 1.500000e+01, 2.500000e+01, 3.500000e+01, 4.500000e+01,
       5.500000e+01, 6.500000e+01, 7.500500e+01, 8.502500e+01, 9.509500e+01,
       1.053100e+02, 1.158700e+02, 1.271500e+02, 1.397400e+02, 1.544700e+02,
       1.724000e+02, 1.947350e+02, 2.227100e+02, 2.574700e+02, 2.999300e+02,
       3.506800e+02, 4.099300e+02, 4.774700e+02, 5.527100e+02, 6.347350e+02,
       7.224000e+02, 8.144700e+02, 9.097400e+02, 1.007155e+03, 1.105905e+03,
       1.205535e+03, 1.306205e+03, 1.409150e+03, 1.517095e+03, 1.634175e+03,
       1.765135e+03, 1.914150e+03, 2.084035e+03, 2.276225e+03, 2.491250e+03,
       2.729250e+03, 2.990250e+03, 3.274250e+03, 3.581250e+03, 3.911250e+03,
       4.264250e+03, 4.640250e+03, 5.039250e+03, 5.461250e+03, 5.906250e+03])</pre></li></ul></div></li><li class='xr-section-item'><input id='section-dfa36cf7-4775-4e82-b545-0ca7d7449a85' class='xr-section-summary-in' type='checkbox'  checked><label for='section-dfa36cf7-4775-4e82-b545-0ca7d7449a85' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Bolus Velocity Coefficient (ECCO v4 Estimate; Forget et al 2015a,b,2016)</dd><dt><span>units :</span></dt><dd>m^2/s</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kecco</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="n">p06</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="n">p06</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">pres</span><span class="o">=</span><span class="n">p06</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fd6c9b508d0&gt;]
</pre></div>
</div>
<img alt="_images/P06_36_1.png" src="_images/P06_36_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kecco</span><span class="o">.</span><span class="n">interp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7fd6d66d1dd0&gt;
</pre></div>
</div>
<img alt="_images/P06_37_1.png" src="_images/P06_37_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">newKe</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
<span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;KT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trdens</span><span class="o">.</span><span class="n">KT</span> <span class="c1">#.mean(dim=&quot;cast&quot;)</span>
<span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trdens</span><span class="o">.</span><span class="n">chi</span><span class="c1"># .mean(dim=&quot;cast&quot;)</span>
<span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;KtTz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trdens</span><span class="o">.</span><span class="n">KtTz</span><span class="c1">#.mean(dim=&quot;cast&quot;)</span>
<span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;dTiso&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eccodens</span><span class="o">.</span><span class="n">dTiso</span><span class="p">)</span>
<span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;dTmdz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eccodens</span><span class="o">.</span><span class="n">dTdia</span><span class="p">)</span>
<span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;dTdz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trdens</span><span class="o">.</span><span class="n">dTdz</span> <span class="c1">#.mean(dim=&quot;cast&quot;)</span>
<span class="n">newKe</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;pres&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">trdens</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span>
<span class="c1"># newKe = newKe.sel(cast=slice(242)).coarsen(cast=60).mean()</span>
<span class="c1"># newKe = newKe.mean(&quot;cast&quot;)</span>
<span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;Ke&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;chi&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;KtTz&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;dTmdz&quot;</span><span class="p">]))</span> <span class="o">/</span> <span class="p">(</span>
    <span class="n">newKe</span><span class="p">[</span><span class="s2">&quot;dTiso&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
<span class="p">)</span>
<span class="c1"># ed.plot_bar_Ke(newKe.to_dataframe())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fullmean</span> <span class="o">=</span> <span class="n">newKe</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cole</span><span class="o">.</span><span class="n">diffusivity</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">cast</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">242</span><span class="p">))</span><span class="o">.</span><span class="n">coarsen</span><span class="p">(</span><span class="n">cast</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/home/deepak/work/python/xarray/xarray/core/nanops.py:142: RuntimeWarning: Mean of empty slice
  return np.nanmean(a, axis=axis, dtype=dtype)
</pre>
</div>
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fd6d6915290&gt;,
 &lt;matplotlib.lines.Line2D at 0x7fd6d6915490&gt;,
 &lt;matplotlib.lines.Line2D at 0x7fd6d6915650&gt;,
 &lt;matplotlib.lines.Line2D at 0x7fd6d6915810&gt;,
 &lt;matplotlib.lines.Line2D at 0x7fd6d69159d0&gt;,
 &lt;matplotlib.lines.Line2D at 0x7fd6d6915b90&gt;]
</pre></div>
</div>
<img alt="_images/P06_40_2.png" src="_images/P06_40_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fullmean</span><span class="o">.</span><span class="n">Ke</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;pres&#39;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
<span class="n">newKe</span><span class="o">.</span><span class="n">Ke</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">newKe</span><span class="o">.</span><span class="n">Ke</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;cast&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;pres&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eccograd</span><span class="p">,</span> <span class="n">argograd</span><span class="p">,</span> <span class="n">cole</span><span class="p">,</span> <span class="n">aber</span> <span class="o">=</span> <span class="n">ed</span><span class="o">.</span><span class="n">read_all_datasets</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;monthly&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">norm</span><span class="p">):</span>
    <span class="n">hdl</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">280</span><span class="p">))</span>
        <span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">dcpy</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">liney</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">360</span><span class="o">-</span><span class="mi">140</span><span class="p">,</span> <span class="mi">360</span><span class="o">-</span><span class="mi">110</span><span class="p">,</span> <span class="mi">360</span><span class="o">-</span><span class="mi">125</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hdl</span>


<span class="n">plot</span><span class="p">(</span>
    <span class="n">eccograd</span><span class="o">.</span><span class="n">dTiso</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pres</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">),</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="mf">5e-7</span><span class="p">,</span> <span class="mf">5e-6</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">h1</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span>
    <span class="n">argograd</span><span class="o">.</span><span class="n">dTiso</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pres</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">),</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="mf">5e-7</span><span class="p">,</span> <span class="mf">5e-6</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">plot</span><span class="p">(</span>
    <span class="n">eccograd</span><span class="o">.</span><span class="n">dTiso</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pres</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">),</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="mf">5e-8</span><span class="p">,</span> <span class="mf">5e-7</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">h2</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span>
    <span class="n">argograd</span><span class="o">.</span><span class="n">dTiso</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pres</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">),</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(</span><span class="mf">5e-8</span><span class="p">,</span> <span class="mf">5e-7</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>

<span class="n">dcpy</span><span class="o">.</span><span class="n">plots</span><span class="o">.</span><span class="n">label_subplots</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="n">f</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;../images/ecco-argo-grad-epac.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/home/deepak/miniconda3/envs/dcpy/lib/python3.7/site-packages/dask/array/numpy_compat.py:40: RuntimeWarning: invalid value encountered in true_divide
  x = np.divide(x1, x2, out)
/home/deepak/miniconda3/envs/dcpy/lib/python3.7/site-packages/dask/array/numpy_compat.py:40: RuntimeWarning: invalid value encountered in true_divide
  x = np.divide(x1, x2, out)
/home/deepak/miniconda3/envs/dcpy/lib/python3.7/site-packages/dask/array/numpy_compat.py:40: RuntimeWarning: invalid value encountered in true_divide
  x = np.divide(x1, x2, out)
/home/deepak/miniconda3/envs/dcpy/lib/python3.7/site-packages/dask/array/numpy_compat.py:40: RuntimeWarning: invalid value encountered in true_divide
  x = np.divide(x1, x2, out)
/home/deepak/miniconda3/envs/dcpy/lib/python3.7/site-packages/matplotlib/colors.py:1171: RuntimeWarning: invalid value encountered in less_equal
  mask |= resdat &lt;= 0
</pre>
</div>
<img alt="_images/P06_43_1.png" src="_images/P06_43_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">argograd</span><span class="o">.</span><span class="n">dTiso</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">280</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pres</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="stderr docutils container">
<pre class="stderr literal-block">/home/deepak/miniconda3/envs/dcpy/lib/python3.7/site-packages/dask/array/numpy_compat.py:40: RuntimeWarning: invalid value encountered in true_divide
  x = np.divide(x1, x2, out)
</pre>
</div>
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x7f16aa8b2b10&gt;
</pre></div>
</div>
<img alt="_images/P06_44_2.png" src="_images/P06_44_2.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="BoB-ctd-chipod.html" title="previous page">BoB ASIRI 2013 CTD χpod</a>
    <a class='right-next' id="next-link" href="compare-Ke-estimates.html" title="next page">Compare different <span class="math notranslate nohighlight">\(K_e\)</span> estimates</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Deepak Cherian<br/>
        
            &copy; Copyright 2020.<br/>
          <div class="extra_footer">
            <div>
<script data-goatcounter="https://count.cherian.net/count"
        async src="count.js"></script>
</div>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>