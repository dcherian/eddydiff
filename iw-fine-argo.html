
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Argo finescale estimates &#8212; Eddy Diffusivity</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Existing finestructure estimates" href="iw-fine-estimates.html" />
    <link rel="prev" title="NATRE micro vs finescale" href="natre-finescale.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Eddy Diffusivity</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Moored χpod analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="tao.html">
   TAO (0, 140) χpod
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="equix.html">
   EQUIX
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  CTD χpod analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="BoB-ctd-chipod.html">
   BoB ASIRI 2013 CTD χpod
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="P06.html">
   P06 CTD χpod analysis
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  NATRE analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="natre.html">
   NATRE variance budget
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="natre-finescale.html">
   NATRE micro vs finescale
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Finestructure analysis
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Argo finescale estimates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="iw-fine-estimates.html">
   Existing finestructure estimates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="iw-fine-devel.html">
   Finescale Mixing Parametrizations: Development
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Ancillary analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="compare-Ke-estimates.html">
   Compare different
   <span class="math notranslate nohighlight">
    \(K_e\)
   </span>
   estimates
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="equix-vs-tao.html">
   χpods: EQUIX vs TAO
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eqpac-ts-diagrams.html">
   T-S diagrams from TAO &amp; Argo at (0, 145W→135W)
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/iw-fine-argo.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/dcherian/eddydiff"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/dcherian/eddydiff/master?urlpath=tree/notebooks/iw-fine-argo.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#natre-region">
   NATRE region
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#experiment-with-conservative-interpolation-of">
     Experiment with conservative interpolation of ε
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#do-variance-budget-terms">
     Do variance budget terms
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#density-bin-averaged">
     density bin averaged
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pressure-bin-averaged">
     pressure bin averaged
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#debugging-profile-estimates">
   Debugging profile estimates
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bad-profiles">
     Bad profiles
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="argo-finescale-estimates">
<h1>Argo finescale estimates<a class="headerlink" href="#argo-finescale-estimates" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark

<span class="kn">import</span> <span class="nn">argopy</span>
<span class="kn">import</span> <span class="nn">cf_xarray</span> <span class="k">as</span> <span class="nn">cfxr</span>
<span class="kn">import</span> <span class="nn">dask</span>
<span class="kn">import</span> <span class="nn">dcpy</span>
<span class="kn">import</span> <span class="nn">gsw</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">mixsea</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">scipy.integrate</span>
<span class="kn">import</span> <span class="nn">seawater</span> <span class="k">as</span> <span class="nn">sw</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">from</span> <span class="nn">dcpy.finestructure</span> <span class="kn">import</span> <span class="n">estimate_turb_segment</span><span class="p">,</span> <span class="n">process_argo_profile</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">loadmat</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;bmh&quot;</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">140</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;lines.linewidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">dirname</span> <span class="o">=</span> <span class="s2">&quot;/home/deepak/datasets/finestructure/&quot;</span>

<span class="o">%</span><span class="k">watermark</span> -iv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>seawater  : 3.3.4
gsw       : 3.4.0
numpy     : 1.20.2
mixsea    : 0.1.0
scipy     : 1.5.3
xarray    : 0.17.1.dev3+g48378c4b1
argopy    : 0.1.7
eddydiff  : 0.1
dask      : 2021.6.2
pandas    : 1.2.3
dcpy      : 0.1
matplotlib: 3.4.1
cf_xarray : 0.4.1.dev21+gab9dc66
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">distributed</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">threads_per_worker</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">memory_limit</span><span class="o">=</span><span class="s2">&quot;24GB&quot;</span><span class="p">,</span> <span class="n">processes</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">client</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
    <div>
        <div style="
            width: 24px;
            height: 24px;
            background-color: #e1e1e1;
            border: 3px solid #9D9D9D;
            border-radius: 5px;
            position: absolute;"> </div>
        <div style="margin-left: 48px;">
            <h3 style="margin-bottom: 0px;">Client</h3>
            <p style="color: #9D9D9D; margin-bottom: 0px;">Client-fe7fad73-e442-11eb-b83d-0028f8270ea7</p>
            <table style="width: 100%; text-align: left;">

        <tr>
            <td style="text-align: left;"><strong>Connection method:</strong> Cluster object</td>
            <td style="text-align: left;"><strong>Cluster type:</strong> LocalCluster</td>
        </tr>

        <tr>
            <td style="text-align: left;">
                <strong>Dashboard: </strong>
                <a href="http://192.168.0.10:8787/status">http://192.168.0.10:8787/status</a>
            </td>
            <td style="text-align: left;"></td>
        </tr>

            </table>

        <details>
        <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Cluster Info</h3></summary>

    <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output">
        <div style="
            width: 24px;
            height: 24px;
            background-color: #e1e1e1;
            border: 3px solid #9D9D9D;
            border-radius: 5px;
            position: absolute;"> </div>
        <div style="margin-left: 48px;">
            <h3 style="margin-bottom: 0px; margin-top: 0px;">LocalCluster</h3>
            <p style="color: #9D9D9D; margin-bottom: 0px;">b08d7d51</p>
            <table style="width: 100%; text-align: left;">

    <tr>
        <td style="text-align: left;"><strong>Status:</strong> running</td>
        <td style="text-align: left;"><strong>Using processes:</strong> False</td>
    </tr>

    <tr>
        <td style="text-align: left;">
            <strong>Dashboard:</strong> <a href="http://192.168.0.10:8787/status">http://192.168.0.10:8787/status</a>
        </td>
        <td style="text-align: left;"><strong>Workers:</strong> 1</td>
    </tr>
    <tr>
        <td style="text-align: left;">
            <strong>Total threads:</strong>
            7
        </td>
        <td style="text-align: left;">
            <strong>Total memory:</strong>
            22.35 GiB
        </td>
    </tr>

            </table>
            <details>
            <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Scheduler Info</h3></summary>

<div style="">

    <div>
        <div style="
            width: 24px;
            height: 24px;
            background-color: #FFF7E5;
            border: 3px solid #FF6132;
            border-radius: 5px;
            position: absolute;"> </div>
        <div style="margin-left: 48px;">
            <h3 style="margin-bottom: 0px;">Scheduler</h3>
            <p style="color: #9D9D9D; margin-bottom: 0px;">Scheduler-b14b4c2d-4960-4ff7-8f07-3768f7e30757</p>
            <table style="width: 100%; text-align: left;">
                <tr>
                    <td style="text-align: left;"><strong>Comm:</strong> inproc://192.168.0.10/1554493/1</td>
                    <td style="text-align: left;"><strong>Workers:</strong> 1</td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Dashboard:</strong> <a href="http://192.168.0.10:8787/status">http://192.168.0.10:8787/status</a>
                    </td>
                    <td style="text-align: left;">
                        <strong>Total threads:</strong>
                        7
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Started:</strong>
                        Just now
                    </td>
                    <td style="text-align: left;">
                        <strong>Total memory:</strong>
                        22.35 GiB
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <details style="margin-left: 48px;">
    <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Workers</h3></summary>

    <div style="margin-bottom: 20px;">
        <div style="width: 24px;
                    height: 24px;
                    background-color: #DBF5FF;
                    border: 3px solid #4CC9FF;
                    border-radius: 5px;
                    position: absolute;"> </div>
        <div style="margin-left: 48px;">
        <details>
            <summary>
                <h4 style="margin-bottom: 0px; display: inline;">Worker: 0</h4>
            </summary>
            <table style="width: 100%; text-align: left;">
                <tr>
                    <td style="text-align: left;"><strong>Comm: </strong> inproc://192.168.0.10/1554493/3</td>
                    <td style="text-align: left;"><strong>Total threads: </strong> 7</td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Dashboard: </strong>
                        <a href="http://192.168.0.10:35059/status">http://192.168.0.10:35059/status</a>
                    </td>
                    <td style="text-align: left;">
                        <strong>Memory: </strong>
                        22.35 GiB
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;"><strong>Nanny: </strong> None</td>
                    <td style="text-align: left;"></td>
                </tr>
                <tr>
                    <td colspan="2" style="text-align: left;">
                        <strong>Local directory: </strong>
                        /tmp/dask-worker-space/worker-appvqnjj
                    </td>
                </tr>


            </table>
        </details>
        </div>
    </div>

    </details>
</div>

            </details>
        </div>
    </div>

        </details>

        </div>
    </div>
</div></div>
</div>
<div class="section" id="natre-region">
<h2>NATRE region<a class="headerlink" href="#natre-region" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>

<span class="n">dsets</span> <span class="o">=</span> <span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;./argo_natre_*.nc&quot;</span><span class="p">)]</span>
<span class="n">argo</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dsets</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;N_POINTS&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span><span class="o">.</span><span class="n">argo</span><span class="o">.</span><span class="n">point2profile</span><span class="p">()</span><span class="o">.</span><span class="n">set_coords</span><span class="p">(</span><span class="s2">&quot;PRES&quot;</span><span class="p">)</span>
<span class="p">)</span>  <span class="c1"># .isel(N_POINTS=slice(10000))</span>
<span class="n">argo</span><span class="o">.</span><span class="n">PRES</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;standard_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sea_water_pressure&quot;</span>
<span class="n">argo</span><span class="o">.</span><span class="n">PRES</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;positive&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;down&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">argo</span><span class="o">.</span><span class="n">TIME</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">argo</span><span class="o">.</span><span class="n">TIME</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;N_OBS&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;N_OBS&#39;)
</pre></div>
</div>
<img alt="_images/iw-fine-argo_5_1.png" src="_images/iw-fine-argo_5_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">dask</span>

<span class="n">argo_good</span> <span class="o">=</span> <span class="n">argo</span><span class="o">.</span><span class="n">query</span><span class="p">({</span><span class="s2">&quot;N_PROF&quot;</span><span class="p">:</span> <span class="s2">&quot;DIRECTION == &#39;A&#39; &amp; DATA_MODE == &#39;D&#39;&quot;</span><span class="p">})</span>

<span class="c1"># doesn&#39;t do anything</span>
<span class="c1"># too_coarse = (argo_good.PRES.diff(&quot;N_LEVELS&quot;) &gt; 20).all(&quot;N_LEVELS&quot;)</span>
<span class="c1"># argo_good = argo_good.isel(N_PROF=~too_coarse)</span>

<span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">dask</span><span class="o">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">argomix</span><span class="o">.</span><span class="n">process_profile</span><span class="p">)(</span><span class="n">argo_good</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">N_PROF</span><span class="o">=</span><span class="n">idx</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">argo_good</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s2">&quot;N_PROF&quot;</span><span class="p">])</span>
<span class="p">]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">tasks</span><span class="p">,</span> <span class="n">scheduler</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>distributed.comm.inproc - WARNING - Closing dangling queue in &lt;InProc  local=inproc://192.168.0.10/1554493/1 remote=inproc://192.168.0.10/1554493/8&gt;
/home/deepak/work/python/dcpy/dcpy/finestructure.py:86: RuntimeWarning: invalid value encountered in sqrt
  N = np.sqrt(N2fit.mean()).item()
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_index</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span><span class="n">dim</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="n">dim</span><span class="p">])})</span>
    <span class="n">ds</span><span class="p">[</span><span class="s2">&quot;pressure&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s2">&quot;pressure&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_base_variable</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">ds</span>


<span class="n">renamed</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">rename_dims</span><span class="p">({</span><span class="s2">&quot;pressure&quot;</span><span class="p">:</span> <span class="s2">&quot;pressure_&quot;</span><span class="p">})</span>
    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">set_index</span><span class="p">,</span> <span class="s2">&quot;pressure_&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="s2">&quot;profile&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">combined</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">renamed</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;profile&quot;</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s2">&quot;outer&quot;</span><span class="p">)</span>
<span class="n">combined</span><span class="o">.</span><span class="n">pressure</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;positive&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;down&quot;</span>
<span class="n">combined</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                (pressure_: 20, profile: 3583, nbnds: 2)
Coordinates: (12/13)
  * pressure_              (pressure_) int64 0 1 2 3 4 5 6 ... 14 15 16 17 18 19
    flag                   (profile, pressure_) float64 -1.0 -1.0 ... -1.0 nan
    pressure               (profile, pressure_) float64 nan nan nan ... nan nan
    npts                   (profile, pressure_) float64 0.0 0.0 0.0 ... 0.0 nan
    γmean                  (profile, pressure_) float64 nan nan nan ... nan nan
    latitude               (profile) float64 23.08 23.79 23.11 ... 26.0 27.96
    ...                     ...
    γ_bounds               (profile, pressure_, nbnds) float64 nan nan ... nan
    p_bounds               (profile, pressure_, nbnds) float64 nan nan ... nan
    CONFIG_MISSION_NUMBER  (profile) int64 1 1 1 1 1 1 1 1 1 ... 5 4 2 5 2 2 5 2
    PLATFORM_NUMBER        (profile) int64 1900073 1900072 ... 4901585 6902572
    CYCLE_NUMBER           (profile) int64 103 104 104 105 ... 180 181 229 182
    DIRECTION              &lt;U1 &#x27;A&#x27;
Dimensions without coordinates: profile, nbnds
Data variables: (12/14)
    ε                      (profile, pressure_) float64 nan nan nan ... nan nan
    Kρ                     (profile, pressure_) float64 nan nan nan ... nan nan
    N2mean                 (profile, pressure_) float64 nan nan nan ... nan nan
    ξvar                   (profile, pressure_) float64 nan nan nan ... nan nan
    ξvargm                 (profile, pressure_) float64 nan nan nan ... nan nan
    Tzlin                  (profile, pressure_) float64 nan nan nan ... nan nan
    ...                     ...
    Tmld                   (profile) float64 112.4 95.1 112.3 ... 77.88 89.6
    σmld                   (profile) float64 92.4 95.1 112.3 ... 80.2 77.88 89.6
    Tmode                  (profile) float64 132.5 135.3 132.2 ... 79.96 99.7
    σmode                  (profile) float64 132.5 115.1 132.2 ... 79.96 99.7
    χ                      (profile, pressure_) float64 nan nan nan ... nan nan
    KtTz                   (profile, pressure_) float64 nan nan nan ... nan nan</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-090bc996-21a7-4b32-bd0a-6c48501a2037' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-090bc996-21a7-4b32-bd0a-6c48501a2037' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>pressure_</span>: 20</li><li><span>profile</span>: 3583</li><li><span>nbnds</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-fbd7e500-d5cd-4765-87a3-0db2e717c569' class='xr-section-summary-in' type='checkbox'  checked><label for='section-fbd7e500-d5cd-4765-87a3-0db2e717c569' class='xr-section-summary' >Coordinates: <span>(13)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>pressure_</span></div><div class='xr-var-dims'>(pressure_)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 14 15 16 17 18 19</div><input id='attrs-fb5478c7-0c25-42f5-bb96-9bb1a55b7a6d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fb5478c7-0c25-42f5-bb96-9bb1a55b7a6d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3435144d-8418-4cca-bbb6-da0dcd392ce1' class='xr-var-data-in' type='checkbox'><label for='data-3435144d-8418-4cca-bbb6-da0dcd392ce1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>flag</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-1.0 -1.0 -1.0 ... -1.0 -1.0 nan</div><input id='attrs-8d147c0f-1313-437e-8fb9-f9455136a1aa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8d147c0f-1313-437e-8fb9-f9455136a1aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9c5d5fa9-ae62-4bf0-8198-f178beecab1c' class='xr-var-data-in' type='checkbox'><label for='data-9c5d5fa9-ae62-4bf0-8198-f178beecab1c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>flag_values :</span></dt><dd>[-2, -1, 1, 2, 3, 4, 5]</dd><dt><span>flag_meanings :</span></dt><dd>too_coarse too_short N²_variance_too_high too_unstratified too_little_bandwidth no_internal_waves good_data</dd></dl></div><div class='xr-var-data'><pre>array([[-1., -1., -1., ..., -1., nan, nan],
       [-1., -1., -1., ..., -1., nan, nan],
       [-1., -1., -1., ..., -1., nan, nan],
       ...,
       [ 5.,  5., -1., ..., -1., -1., -1.],
       [ 5.,  5.,  5., ..., nan, nan, nan],
       [ 5.,  5., -1., ..., -1., -1., nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pressure</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-ec8325ca-6e38-44e2-9e63-0fb0e8c371d2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ec8325ca-6e38-44e2-9e63-0fb0e8c371d2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2efcc88a-c6ab-4fc5-a298-4cb61cb6e1c4' class='xr-var-data-in' type='checkbox'><label for='data-2efcc88a-c6ab-4fc5-a298-4cb61cb6e1c4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Z</dd><dt><span>standard_name :</span></dt><dd>sea_water_pressure</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>bounds :</span></dt><dd>p_bounds</dd></dl></div><div class='xr-var-data'><pre>array([[         nan,          nan,          nan, ...,          nan,
                 nan,          nan],
       [         nan,          nan,          nan, ...,          nan,
                 nan,          nan],
       [         nan,          nan,          nan, ...,          nan,
                 nan,          nan],
       ...,
       [209.99999619, 285.05000305,          nan, ...,          nan,
                 nan,          nan],
       [200.97999954, 302.        , 400.        , ...,          nan,
                 nan,          nan],
       [209.79999542, 280.04999542,          nan, ...,          nan,
                 nan,          nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>npts</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 nan</div><input id='attrs-33509624-da80-4f3a-a370-eee21f1d2a75' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-33509624-da80-4f3a-a370-eee21f1d2a75' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ca142796-a5c8-4f3b-93fe-4a3ef8057cbf' class='xr-var-data-in' type='checkbox'><label for='data-ca142796-a5c8-4f3b-93fe-4a3ef8057cbf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>number of points in segment</dd></dl></div><div class='xr-var-data'><pre>array([[  0.,   0.,   0., ...,   0.,  nan,  nan],
       [  0.,   0.,   0., ...,   0.,  nan,  nan],
       [  0.,   0.,   0., ...,   0.,  nan,  nan],
       ...,
       [ 19.,  14.,   4., ...,   0.,   0.,   0.],
       [100.,  99.,  99., ...,  nan,  nan,  nan],
       [ 19.,  15.,   4., ...,   0.,   0.,  nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>γmean</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-025d1b51-47ce-4d30-bb2c-71aae06d1283' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-025d1b51-47ce-4d30-bb2c-71aae06d1283' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bee67d38-3305-480b-b430-ed2221b4ddc9' class='xr-var-data-in' type='checkbox'><label for='data-bee67d38-3305-480b-b430-ed2221b4ddc9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>γ_bounds</dd><dt><span>long_name :</span></dt><dd>$γ_n$</dd><dt><span>standard_name :</span></dt><dd>neutral_density</dd><dt><span>units :</span></dt><dd>kg/m3</dd><dt><span>valid_min :</span></dt><dd>0.0</dd><dt><span>valid_max :</span></dt><dd>43.0</dd><dt><span>resolution :</span></dt><dd>0.001</dd><dt><span>casted :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><pre>array([[        nan,         nan,         nan, ...,         nan,
                nan,         nan],
       [        nan,         nan,         nan, ...,         nan,
                nan,         nan],
       [        nan,         nan,         nan, ...,         nan,
                nan,         nan],
       ...,
       [26.48515563, 26.65522995,         nan, ...,         nan,
                nan,         nan],
       [26.36340187, 26.65571826, 26.86758021, ...,         nan,
                nan,         nan],
       [26.46223804, 26.63708881,         nan, ...,         nan,
                nan,         nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>23.08 23.79 23.11 ... 26.0 27.96</div><input id='attrs-4d57cf61-a76f-4bb9-ac5e-253e417303cb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4d57cf61-a76f-4bb9-ac5e-253e417303cb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d16a1e6d-abce-4571-be8f-ae08fb28f839' class='xr-var-data-in' type='checkbox'><label for='data-d16a1e6d-abce-4571-be8f-ae08fb28f839' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([23.079  , 23.785  , 23.115  , ..., 27.692  , 26.00449, 27.961  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-34.05 -25.58 ... -32.41 -27.37</div><input id='attrs-0635864a-fcbe-4526-ade8-93c68fccbdbc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0635864a-fcbe-4526-ade8-93c68fccbdbc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e219f042-f587-4d14-a8b9-1ffbce923aa4' class='xr-var-data-in' type='checkbox'><label for='data-e219f042-f587-4d14-a8b9-1ffbce923aa4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-34.046  , -25.578  , -34.184  , ..., -27.586  , -32.41227,
       -27.371  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>γ_bounds</span></div><div class='xr-var-dims'>(profile, pressure_, nbnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-ea23fb71-7dfd-4ffa-87a5-30c313b983b5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ea23fb71-7dfd-4ffa-87a5-30c313b983b5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-20f7b340-6771-4326-a903-f29869f8d147' class='xr-var-data-in' type='checkbox'><label for='data-20f7b340-6771-4326-a903-f29869f8d147' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[        nan,         nan],
        [        nan,         nan],
        [        nan,         nan],
        ...,
        [        nan,         nan],
        [        nan,         nan],
        [        nan,         nan]],

       [[        nan,         nan],
        [        nan,         nan],
        [        nan,         nan],
        ...,
        [        nan,         nan],
        [        nan,         nan],
        [        nan,         nan]],

       [[        nan,         nan],
        [        nan,         nan],
        [        nan,         nan],
        ...,
...
        ...,
        [        nan,         nan],
        [        nan,         nan],
        [        nan,         nan]],

       [[26.01802761, 26.67128058],
        [26.37578484, 26.86517511],
        [26.67407304, 27.01725056],
        ...,
        [        nan,         nan],
        [        nan,         nan],
        [        nan,         nan]],

       [[26.18965179, 26.68132286],
        [26.48551074, 26.79334891],
        [        nan,         nan],
        ...,
        [        nan,         nan],
        [        nan,         nan],
        [        nan,         nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>p_bounds</span></div><div class='xr-var-dims'>(profile, pressure_, nbnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-edf887b2-44b6-4315-8762-9dc275985670' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-edf887b2-44b6-4315-8762-9dc275985670' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8762a50c-3d6f-4c19-bd29-a14c60b7673b' class='xr-var-data-in' type='checkbox'><label for='data-8762a50c-3d6f-4c19-bd29-a14c60b7673b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[         nan,          nan],
        [         nan,          nan],
        [         nan,          nan],
        ...,
        [         nan,          nan],
        [         nan,          nan],
        [         nan,          nan]],

       [[         nan,          nan],
        [         nan,          nan],
        [         nan,          nan],
        ...,
        [         nan,          nan],
        [         nan,          nan],
        [         nan,          nan]],

       [[         nan,          nan],
        [         nan,          nan],
        [         nan,          nan],
        ...,
...
        ...,
        [         nan,          nan],
        [         nan,          nan],
        [         nan,          nan]],

       [[101.95999908, 300.        ],
        [204.        , 400.        ],
        [302.        , 498.        ],
        ...,
        [         nan,          nan],
        [         nan,          nan],
        [         nan,          nan]],

       [[119.69999695, 299.8999939 ],
        [209.69999695, 350.3999939 ],
        [         nan,          nan],
        ...,
        [         nan,          nan],
        [         nan,          nan],
        [         nan,          nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>CONFIG_MISSION_NUMBER</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 1 1 1 1 1 1 1 ... 5 4 2 5 2 2 5 2</div><input id='attrs-5d360aca-1e4f-4172-bbf9-93c2e4ec532b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5d360aca-1e4f-4172-bbf9-93c2e4ec532b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d62c38fe-7b1f-48a0-bb77-c6cbf24449e1' class='xr-var-data-in' type='checkbox'><label for='data-d62c38fe-7b1f-48a0-bb77-c6cbf24449e1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1, 1, 1, ..., 2, 5, 2])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>PLATFORM_NUMBER</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1900073 1900072 ... 4901585 6902572</div><input id='attrs-827c53b3-f69f-470b-a858-00c132f7a623' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-827c53b3-f69f-470b-a858-00c132f7a623' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e4911e7e-676d-45c6-8fd0-c997d1d4c7bf' class='xr-var-data-in' type='checkbox'><label for='data-e4911e7e-676d-45c6-8fd0-c997d1d4c7bf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1900073, 1900072, 1900073, ..., 6902572, 4901585, 6902572])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>CYCLE_NUMBER</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>103 104 104 105 ... 180 181 229 182</div><input id='attrs-3aaa09e7-9e6e-46f0-af41-e6f99fead701' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3aaa09e7-9e6e-46f0-af41-e6f99fead701' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-48071656-88ba-4172-ba00-fa42bae32077' class='xr-var-data-in' type='checkbox'><label for='data-48071656-88ba-4172-ba00-fa42bae32077' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([103, 104, 104, ..., 181, 229, 182])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DIRECTION</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;A&#x27;</div><input id='attrs-56c6a2e2-adf4-4896-bac0-19a1da61befa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-56c6a2e2-adf4-4896-bac0-19a1da61befa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-50b1b5c4-5c6b-49f7-9fc2-3c1a7579f87a' class='xr-var-data-in' type='checkbox'><label for='data-50b1b5c4-5c6b-49f7-9fc2-3c1a7579f87a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(&#x27;A&#x27;, dtype=&#x27;&lt;U1&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6dc01cc0-d82b-4509-9566-85324e0116c2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6dc01cc0-d82b-4509-9566-85324e0116c2' class='xr-section-summary' >Data variables: <span>(14)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ε</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-c21aa100-e6c2-4932-a708-be3d4662d6b3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c21aa100-e6c2-4932-a708-be3d4662d6b3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8f52fc1a-a69c-40d3-b513-d3579d5b6085' class='xr-var-data-in' type='checkbox'><label for='data-8f52fc1a-a69c-40d3-b513-d3579d5b6085' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$ε$</dd><dt><span>units :</span></dt><dd>W/kg</dd></dl></div><div class='xr-var-data'><pre>array([[           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       ...,
       [3.88852199e-10, 1.51102548e-10,            nan, ...,
                   nan,            nan,            nan],
       [1.97608548e-09, 2.68533632e-10, 2.89201090e-10, ...,
                   nan,            nan,            nan],
       [1.00190030e-09, 4.46281609e-10,            nan, ...,
                   nan,            nan,            nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Kρ</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-b16aefc3-e67c-4a11-9168-0ff3de02f7f2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b16aefc3-e67c-4a11-9168-0ff3de02f7f2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7f475088-c86d-4229-ad0b-c694daac9eed' class='xr-var-data-in' type='checkbox'><label for='data-7f475088-c86d-4229-ad0b-c694daac9eed' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$K_ρ$</dd><dt><span>units :</span></dt><dd>m²/s</dd></dl></div><div class='xr-var-data'><pre>array([[           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       ...,
       [3.59037654e-06, 1.43011102e-06,            nan, ...,
                   nan,            nan,            nan],
       [1.28061120e-05, 2.24881020e-06, 3.34742500e-06, ...,
                   nan,            nan,            nan],
       [7.85027337e-06, 4.29463023e-06,            nan, ...,
                   nan,            nan,            nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>N2mean</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-0737a8a3-ced7-42e9-8648-910266a2ddcc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0737a8a3-ced7-42e9-8648-910266a2ddcc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cd7b549a-057e-4d2b-aab2-112e5acc5c65' class='xr-var-data-in' type='checkbox'><label for='data-cd7b549a-057e-4d2b-aab2-112e5acc5c65' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$N²$</dd><dt><span>description :</span></dt><dd>mean of quadratic fit of N² with pressure</dd></dl></div><div class='xr-var-data'><pre>array([[           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       ...,
       [2.20933756e-05, 2.15535867e-05,            nan, ...,
                   nan,            nan,            nan],
       [3.14779142e-05, 2.43592211e-05, 1.76240853e-05, ...,
                   nan,            nan,            nan],
       [2.60349795e-05, 2.11982850e-05,            nan, ...,
                   nan,            nan,            nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ξvar</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-a1a81997-799c-4924-938b-a80163c98130' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a1a81997-799c-4924-938b-a80163c98130' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-519b4e6f-ab65-4e23-a243-be9dc84f9387' class='xr-var-data-in' type='checkbox'><label for='data-519b4e6f-ab65-4e23-a243-be9dc84f9387' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$ξ$</dd><dt><span>description :</span></dt><dd>strain variance</dd></dl></div><div class='xr-var-data'><pre>array([[       nan,        nan,        nan, ...,        nan,        nan,
               nan],
       [       nan,        nan,        nan, ...,        nan,        nan,
               nan],
       [       nan,        nan,        nan, ...,        nan,        nan,
               nan],
       ...,
       [0.09462641, 0.05380143,        nan, ...,        nan,        nan,
               nan],
       [0.21496643, 0.21644211, 0.21566597, ...,        nan,        nan,
               nan],
       [0.13632284, 0.10018238,        nan, ...,        nan,        nan,
               nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ξvargm</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-dd2309d6-a961-41ea-a033-f9219e1c0404' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dd2309d6-a961-41ea-a033-f9219e1c0404' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c5edc6a9-18b5-4b05-89e1-e3524c899ad6' class='xr-var-data-in' type='checkbox'><label for='data-c5edc6a9-18b5-4b05-89e1-e3524c899ad6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$ξ_{gm}$</dd><dt><span>description :</span></dt><dd>GM strain variance</dd></dl></div><div class='xr-var-data'><pre>array([[       nan,        nan,        nan, ...,        nan,        nan,
               nan],
       [       nan,        nan,        nan, ...,        nan,        nan,
               nan],
       [       nan,        nan,        nan, ...,        nan,        nan,
               nan],
       ...,
       [0.10710723, 0.09636968,        nan, ...,        nan,        nan,
               nan],
       [0.12808864, 0.30392183, 0.24419597, ...,        nan,        nan,
               nan],
       [0.10559203, 0.10383195,        nan, ...,        nan,        nan,
               nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Tzlin</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-35b77d0b-5357-4c34-8cac-640175849514' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-35b77d0b-5357-4c34-8cac-640175849514' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3dd49c97-52b8-4e89-821c-ba3ff3f5d87e' class='xr-var-data-in' type='checkbox'><label for='data-3dd49c97-52b8-4e89-821c-ba3ff3f5d87e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$T_z^{lin}$</dd><dt><span>description :</span></dt><dd>linear fit of T vs pressure</dd></dl></div><div class='xr-var-data'><pre>array([[       nan,        nan,        nan, ...,        nan,        nan,
               nan],
       [       nan,        nan,        nan, ...,        nan,        nan,
               nan],
       [       nan,        nan,        nan, ...,        nan,        nan,
               nan],
       ...,
       [0.02004671, 0.01860232,        nan, ...,        nan,        nan,
               nan],
       [0.02470548, 0.02164925, 0.01549148, ...,        nan,        nan,
               nan],
       [0.02100139, 0.01878803,        nan, ...,        nan,        nan,
               nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Tzmean</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-c8c42016-2287-414a-b721-0d81fa0a43ba' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c8c42016-2287-414a-b721-0d81fa0a43ba' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aba5a4ce-a028-41b4-81e6-089774069b03' class='xr-var-data-in' type='checkbox'><label for='data-aba5a4ce-a028-41b4-81e6-089774069b03' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$T_z^{quad}$</dd><dt><span>description :</span></dt><dd>mean of quadratic fit of Tz with pressure; like N² fitting for strain</dd></dl></div><div class='xr-var-data'><pre>array([[       nan,        nan,        nan, ...,        nan,        nan,
               nan],
       [       nan,        nan,        nan, ...,        nan,        nan,
               nan],
       [       nan,        nan,        nan, ...,        nan,        nan,
               nan],
       ...,
       [0.02031759, 0.01885456,        nan, ...,        nan,        nan,
               nan],
       [0.02481122, 0.02162229, 0.0155682 , ...,        nan,        nan,
               nan],
       [0.02120085, 0.01871869,        nan, ...,        nan,        nan,
               nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>mean_dTdz_seg</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-18abaf90-0dd0-4dd0-873f-2313d62852f4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-18abaf90-0dd0-4dd0-873f-2313d62852f4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-70a932fe-2117-4651-a499-188858a88387' class='xr-var-data-in' type='checkbox'><label for='data-70a932fe-2117-4651-a499-188858a88387' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>mean of dTdz values in segment</dd><dt><span>long_name :</span></dt><dd>$⟨T_z⟩$</dd></dl></div><div class='xr-var-data'><pre>array([[       nan,        nan,        nan, ...,        nan,        nan,
               nan],
       [       nan,        nan,        nan, ...,        nan,        nan,
               nan],
       [       nan,        nan,        nan, ...,        nan,        nan,
               nan],
       ...,
       [0.02099382, 0.01903718,        nan, ...,        nan,        nan,
               nan],
       [0.02480703, 0.02181404, 0.0155757 , ...,        nan,        nan,
               nan],
       [0.02209709, 0.01862588,        nan, ...,        nan,        nan,
               nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Tmld</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>112.4 95.1 112.3 ... 77.88 89.6</div><input id='attrs-001ca5a9-d2e6-41f1-a8eb-b420947bb703' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-001ca5a9-d2e6-41f1-a8eb-b420947bb703' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d1b172f1-0162-4f2e-a0ab-bb9038a2371a' class='xr-var-data-in' type='checkbox'><label for='data-d1b172f1-0162-4f2e-a0ab-bb9038a2371a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>description :</span></dt><dd>ΔT criterion applied first time</dd></dl></div><div class='xr-var-data'><pre>array([112.40000153,  95.09999847, 112.30000305, ...,  80.19999695,
        77.87999725,  89.59999847])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>σmld</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>92.4 95.1 112.3 ... 80.2 77.88 89.6</div><input id='attrs-371b70c2-eee2-43c8-a491-532fd4ea1f18' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-371b70c2-eee2-43c8-a491-532fd4ea1f18' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f749f746-1da2-43fa-9e28-7c93c509f739' class='xr-var-data-in' type='checkbox'><label for='data-f749f746-1da2-43fa-9e28-7c93c509f739' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>description :</span></dt><dd>Δσ criterion applied first time</dd></dl></div><div class='xr-var-data'><pre>array([ 92.40000153,  95.09999847, 112.30000305, ...,  80.19999695,
        77.87999725,  89.59999847])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Tmode</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>132.5 135.3 132.2 ... 79.96 99.7</div><input id='attrs-fa98352b-f39f-495f-8c4f-e60ec4ea7b15' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fa98352b-f39f-495f-8c4f-e60ec4ea7b15' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0244760f-58d1-47ab-823f-4ceb74b2aadf' class='xr-var-data-in' type='checkbox'><label for='data-0244760f-58d1-47ab-823f-4ceb74b2aadf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>description :</span></dt><dd>ΔT criterion applied second time</dd></dl></div><div class='xr-var-data'><pre>array([132.5       , 135.30000305, 132.19999695, ...,  90.19999695,
        79.95999908,  99.69999695])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>σmode</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>132.5 115.1 132.2 ... 79.96 99.7</div><input id='attrs-0d98d10f-3b98-4115-8740-601ddac01222' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0d98d10f-3b98-4115-8740-601ddac01222' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8fd8b03d-2aff-40a5-80d5-77dafc4e41e3' class='xr-var-data-in' type='checkbox'><label for='data-8fd8b03d-2aff-40a5-80d5-77dafc4e41e3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>description :</span></dt><dd>Δσ criterion applied second time</dd></dl></div><div class='xr-var-data'><pre>array([132.5       , 115.09999847, 132.19999695, ...,  90.19999695,
        79.95999908,  99.69999695])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>χ</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-71805eb3-c2ae-48a4-baac-458894010772' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-71805eb3-c2ae-48a4-baac-458894010772' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6c7b52a0-e77d-476b-8a88-1e0eaf668c32' class='xr-var-data-in' type='checkbox'><label for='data-6c7b52a0-e77d-476b-8a88-1e0eaf668c32' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$χ$</dd><dt><span>units :</span></dt><dd>°C²/s</dd></dl></div><div class='xr-var-data'><pre>array([[           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       ...,
       [2.96424817e-09, 1.01679314e-09,            nan, ...,
                   nan,            nan,            nan],
       [1.57667951e-08, 2.10274220e-09, 1.62262331e-09, ...,
                   nan,            nan,            nan],
       [7.05701851e-09, 3.00958698e-09,            nan, ...,
                   nan,            nan,            nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>KtTz</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-91e2a606-1813-4b85-af01-294d1cb0a04c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-91e2a606-1813-4b85-af01-294d1cb0a04c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cca97b6e-3739-422b-acb1-a0a001728e07' class='xr-var-data-in' type='checkbox'><label for='data-cca97b6e-3739-422b-acb1-a0a001728e07' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$K_ρθ_z$</dd><dt><span>units :</span></dt><dd>°Cm/s</dd></dl></div><div class='xr-var-data'><pre>array([[           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       [           nan,            nan,            nan, ...,
                   nan,            nan,            nan],
       ...,
       [7.29478138e-08, 2.69641156e-08,            nan, ...,
                   nan,            nan,            nan],
       [3.17735223e-07, 4.86244183e-08, 5.21133852e-08, ...,
                   nan,            nan,            nan],
       [1.66432455e-07, 8.03898726e-08,            nan, ...,
                   nan,            nan,            nan]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8ee3bf3a-6a20-4af7-837c-39ab7f07e291' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8ee3bf3a-6a20-4af7-837c-39ab7f07e291' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">combined</span><span class="o">.</span><span class="n">to_zarr</span><span class="p">(</span><span class="s2">&quot;./argomix_natre.zarr&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>distributed.utils_perf - WARNING - full garbage collections took 29% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 30% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 30% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 30% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 30% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 30% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 30% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 30% CPU time recently (threshold: 10%)
distributed.utils_perf - WARNING - full garbage collections took 30% CPU time recently (threshold: 10%)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.backends.zarr.ZarrStore at 0x7f91ccb2d6d0&gt;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>distributed.utils_perf - WARNING - full garbage collections took 30% CPU time recently (threshold: 10%)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">combined</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s2">&quot;argomix_natre_all_latest.nc&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># combined = xr.open_dataset(&quot;argomix_natre_all.nc&quot;)</span>
<span class="n">combined</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_zarr</span><span class="p">(</span><span class="s2">&quot;./argomix_natre.zarr&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">bins</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">26.692</span><span class="p">,</span>
    <span class="mf">26.876</span><span class="p">,</span>
    <span class="mf">27.039</span><span class="p">,</span>
    <span class="mf">27.163</span><span class="p">,</span>
    <span class="mf">27.288</span><span class="p">,</span>
    <span class="mf">27.406</span><span class="p">,</span>
    <span class="mf">27.516</span><span class="p">,</span>
    <span class="mf">27.605</span><span class="p">,</span>
    <span class="mf">27.683</span><span class="p">,</span>
    <span class="mf">27.742</span><span class="p">,</span>
    <span class="mf">27.794</span><span class="p">,</span>
    <span class="mf">27.835</span><span class="p">,</span>
    <span class="mf">27.872</span><span class="p">,</span>
    <span class="mf">27.898</span><span class="p">,</span>
    <span class="mf">27.921</span><span class="p">,</span>
    <span class="mf">27.94</span><span class="p">,</span>
    <span class="mf">27.958</span><span class="p">,</span>
    <span class="mi">29</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">combined</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;γ_vertices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cfxr</span><span class="o">.</span><span class="n">bounds_to_vertices</span><span class="p">(</span>
    <span class="n">combined</span><span class="o">.</span><span class="n">γ_bounds</span><span class="p">,</span> <span class="n">bounds_dim</span><span class="o">=</span><span class="s2">&quot;nbnds&quot;</span><span class="p">,</span> <span class="n">core_dims</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pressure_&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">combined</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s2">&quot;p_vertices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cfxr</span><span class="o">.</span><span class="n">bounds_to_vertices</span><span class="p">(</span>
    <span class="n">combined</span><span class="o">.</span><span class="n">p_bounds</span><span class="p">,</span> <span class="n">bounds_dim</span><span class="o">=</span><span class="s2">&quot;nbnds&quot;</span><span class="p">,</span> <span class="n">core_dims</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pressure_&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_data</span> <span class="o">=</span> <span class="n">combined</span><span class="o">.</span><span class="n">npts</span> <span class="o">&gt;</span> <span class="mi">40</span>
<span class="n">combined</span><span class="o">.</span><span class="n">ε</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;profile&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span>
    <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span>
    <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">add_legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/iw-fine-argo_14_0.png" src="_images/iw-fine-argo_14_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">combined</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="s2">&quot;pressure&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby_bins</span><span class="p">(</span><span class="s2">&quot;γmean&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">set_coords</span><span class="p">(</span>
    <span class="s2">&quot;pressure&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">χ</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">combined</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">combined</span><span class="o">.</span><span class="n">npts</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="s2">&quot;pressure&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby_bins</span><span class="p">(</span>
    <span class="s2">&quot;γmean&quot;</span><span class="p">,</span>
    <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
<span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">set_coords</span><span class="p">(</span><span class="s2">&quot;pressure&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">χ</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;onlyε&quot;</span><span class="p">,</span> <span class="s2">&quot;npts &gt; 30&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/iw-fine-argo_15_0.png" src="_images/iw-fine-argo_15_0.png" />
</div>
</div>
<div class="section" id="experiment-with-conservative-interpolation-of">
<h3>Experiment with conservative interpolation of ε<a class="headerlink" href="#experiment-with-conservative-interpolation-of" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile</span> <span class="o">=</span> <span class="n">combined</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">profile</span><span class="o">=</span><span class="mi">1950</span><span class="p">)</span>
<span class="n">profile</span><span class="o">.</span><span class="n">ε</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f1f4b11ddf0&gt;]
</pre></div>
</div>
<img alt="_images/iw-fine-argo_17_1.png" src="_images/iw-fine-argo_17_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">ε</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>
<span class="n">mask_outer</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">γ_vertices</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>

<span class="n">eps_ext</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">interp_1d_conservative</span><span class="p">(</span>
    <span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">ε</span> <span class="o">*</span> <span class="n">profile</span><span class="o">.</span><span class="n">γmean</span> <span class="o">*</span> <span class="n">profile</span><span class="o">.</span><span class="n">pressure</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">profile</span><span class="o">.</span><span class="n">γ_vertices</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">mask_outer</span><span class="p">],</span>
    <span class="n">target_theta_bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bins</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">mass_ext</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">interp_1d_conservative</span><span class="p">(</span>
    <span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">γmean</span> <span class="o">*</span> <span class="n">profile</span><span class="o">.</span><span class="n">pressure</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">profile</span><span class="o">.</span><span class="n">γ_vertices</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">mask_outer</span><span class="p">],</span>
    <span class="n">target_theta_bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">((</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">eps_ext</span> <span class="o">/</span> <span class="n">mass_ext</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">γmean</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">ε</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">78</span><span class="o">-</span><span class="n">d6bce3b0d837</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">eps_ext</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">interp_1d_conservative</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">ε</span> <span class="o">*</span> <span class="n">profile</span><span class="o">.</span><span class="n">γmean</span> <span class="o">*</span> <span class="n">profile</span><span class="o">.</span><span class="n">pressure</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">profile</span><span class="o">.</span><span class="n">γ_vertices</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">mask_outer</span><span class="p">],</span>

<span class="ne">NameError</span>: name &#39;transform&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="do-variance-budget-terms">
<h3>Do variance budget terms<a class="headerlink" href="#do-variance-budget-terms" title="Permalink to this headline">¶</a></h3>
<p>This does not work so well or too well actually. It looks like χ/2 matches the local turbulent stirring production exactly!</p>
<p>I think the 200m averaging scale in the finestructure estimate is the problem. It matches the vertical scale for our ‘large-scale’ vertical bins (I think the spacing between γ surfaces, but should check).</p>
<p>Another option is to do the Ferrari &amp; Polzin (2005) thing where they set microscale stirring production <span class="math notranslate nohighlight">\(= Γ⟨ε⟩/N^2_m θ^m_z\)</span>; so I could bin-average fine structure ε to get <span class="math notranslate nohighlight">\(⟨ε⟩\)</span> and use the climatology to get the gradient terms.</p>
<p>Another option is to calculate the estimates in 200m bins and then average all estimates in those bins; this would avoid some extra averaging I think (!)</p>
<ul class="simple">
<li><p><strong>Why has no one done this before?</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cf_xarray</span>
<span class="kn">import</span> <span class="nn">dcpy</span>

<span class="n">argoclim</span> <span class="o">=</span> <span class="n">dcpy</span><span class="o">.</span><span class="n">oceans</span><span class="o">.</span><span class="n">read_argo_clim</span><span class="p">()</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span>
    <span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">lon</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span> <span class="o">-</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">360</span> <span class="o">-</span> <span class="mi">26</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">argoclim</span><span class="p">[</span><span class="s2">&quot;γ&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dcpy</span><span class="o">.</span><span class="n">oceans</span><span class="o">.</span><span class="n">neutral_density</span><span class="p">(</span><span class="n">argoclim</span><span class="p">[[</span><span class="s2">&quot;Tmean&quot;</span><span class="p">,</span> <span class="s2">&quot;Smean&quot;</span><span class="p">]])</span>
<span class="n">argoclim</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">argoclim</span><span class="o">.</span><span class="n">cf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Coordinates:
- CF Axes: * X: [&#39;lon&#39;]
           * Y: [&#39;lat&#39;]
           * Z: [&#39;pres&#39;]
           * T: [&#39;time&#39;]

- CF Coordinates: * longitude: [&#39;lon&#39;]
                  * latitude: [&#39;lat&#39;]
                  * vertical: [&#39;pres&#39;]
                  * time: [&#39;time&#39;]

- Cell Measures:   area, volume: n/a

- Standard Names: * sea_water_pressure: [&#39;pres&#39;]

- Bounds:   n/a

Data Variables:
- Cell Measures:   area, volume: n/a

- Standard Names:   neutral_density: [&#39;γ&#39;]
                    sea_water_potential_temperature: [&#39;theta_mean&#39;]
                    sea_water_salinity: [&#39;S&#39;, &#39;Smean&#39;]
                    sea_water_temperature: [&#39;T&#39;, &#39;Tmean&#39;]

- Bounds:   n/a
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="density-bin-averaged">
<h3>density bin averaged<a class="headerlink" href="#density-bin-averaged" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="mf">26.69</span><span class="p">,</span>
        <span class="mf">26.88</span><span class="p">,</span>
        <span class="mf">27.04</span><span class="p">,</span>
        <span class="mf">27.16</span><span class="p">,</span>
        <span class="mf">27.29</span><span class="p">,</span>
        <span class="mf">27.41</span><span class="p">,</span>
        <span class="mf">27.52</span><span class="p">,</span>
        <span class="mf">27.6</span><span class="p">,</span>
        <span class="mf">27.68</span><span class="p">,</span>
        <span class="mf">27.74</span><span class="p">,</span>
        <span class="mf">27.79</span><span class="p">,</span>
        <span class="mf">27.84</span><span class="p">,</span>
        <span class="mf">27.87</span><span class="p">,</span>
        <span class="mf">27.9</span><span class="p">,</span>
        <span class="mf">27.92</span><span class="p">,</span>
        <span class="mf">27.94</span><span class="p">,</span>
        <span class="mf">27.96</span><span class="p">,</span>
        <span class="mf">27.97</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="c1"># bins = np.arange(26.5, 28.1, 0.15)</span>

<span class="n">combined</span><span class="p">[</span><span class="s2">&quot;KtTz_seg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined</span><span class="o">.</span><span class="n">Kρ</span> <span class="o">*</span> <span class="n">combined</span><span class="o">.</span><span class="n">mean_dTdz_seg</span>
<span class="n">binned_argo_fs</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">combined</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="s2">&quot;pressure&quot;</span><span class="p">)</span>  <span class="c1"># .where(good_data &amp; (combined.npts &gt; 30))</span>
    <span class="o">.</span><span class="n">groupby_bins</span><span class="p">(</span>
        <span class="s2">&quot;γmean&quot;</span><span class="p">,</span>
        <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="o">.</span><span class="n">set_coords</span><span class="p">(</span><span class="s2">&quot;pressure&quot;</span><span class="p">)</span>
<span class="p">)</span>


<span class="c1"># totally fine</span>
<span class="n">Tz_m_argo</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">argoclim</span><span class="o">.</span><span class="n">theta_mean</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">differentiate</span><span class="p">(</span><span class="s2">&quot;pres&quot;</span><span class="p">,</span> <span class="n">positive_upward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">pres</span><span class="o">=</span><span class="n">binned_argo_fs</span><span class="o">.</span><span class="n">pressure</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">N2_m_argo</span> <span class="o">=</span> <span class="p">(</span>
    <span class="o">-</span><span class="mf">9.81</span>
    <span class="o">/</span> <span class="mi">1025</span>
    <span class="o">*</span> <span class="p">(</span>
        <span class="n">argoclim</span><span class="o">.</span><span class="n">γ</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">differentiate</span><span class="p">(</span><span class="s2">&quot;pres&quot;</span><span class="p">,</span> <span class="n">positive_upward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="o">.</span><span class="n">compute</span><span class="p">()</span>
        <span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">])</span>
        <span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">pres</span><span class="o">=</span><span class="n">binned_argo_fs</span><span class="o">.</span><span class="n">pressure</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>


<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">binned_argo_fs</span><span class="o">.</span><span class="n">ε</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="p">(</span><span class="n">binned_argo_fs</span><span class="o">.</span><span class="n">χ</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="p">(</span><span class="n">binned_argo_fs</span><span class="o">.</span><span class="n">KtTz</span> <span class="o">*</span> <span class="n">Tz_m_argo</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="c1"># (binned_argo_fs.KtTz_seg * Tz_m_argo).plot(ax=ax[1], y=&quot;pressure&quot;, marker=&quot;o&quot;)</span>
<span class="p">(</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">binned_argo_fs</span><span class="o">.</span><span class="n">ε</span> <span class="o">/</span> <span class="n">N2_m_argo</span> <span class="o">*</span> <span class="n">Tz_m_argo</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$⟨χ⟩$/2&quot;</span><span class="p">,</span> <span class="s2">&quot;$⟨K_ρ θ_z⟩ θ_z^m$&quot;</span><span class="p">,</span> <span class="s2">&quot;$Γ⟨ε⟩/N^2_m (θ^m_z)^2$&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/iw-fine-argo_23_0.png" src="_images/iw-fine-argo_23_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">binned_argo_fs</span><span class="o">.</span><span class="n">ε</span> <span class="o">/</span> <span class="n">N2_m_argo</span> <span class="o">*</span> <span class="n">Tz_m_argo</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">binned_argo_fs</span><span class="o">.</span><span class="n">Kρ</span> <span class="o">*</span> <span class="n">Tz_m_argo</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">binned_argo_fs</span><span class="o">.</span><span class="n">KtTz</span> <span class="o">*</span> <span class="n">Tz_m_argo</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">binned_argo_fs</span><span class="o">.</span><span class="n">Kρ</span> <span class="o">*</span> <span class="n">binned_argo_fs</span><span class="o">.</span><span class="n">Tzmean</span> <span class="o">*</span> <span class="n">Tz_m_argo</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f1f4a81b1c0&gt;]
</pre></div>
</div>
<img alt="_images/iw-fine-argo_24_1.png" src="_images/iw-fine-argo_24_1.png" />
</div>
</div>
</div>
<div class="section" id="pressure-bin-averaged">
<h3>pressure bin averaged<a class="headerlink" href="#pressure-bin-averaged" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">binned</span> <span class="o">=</span> <span class="n">combined</span><span class="o">.</span><span class="n">groupby_bins</span><span class="p">(</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">2050</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">centers</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="o">.</span><span class="n">mid</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">binned</span><span class="o">.</span><span class="n">pressure_bins</span><span class="p">]</span>
<span class="n">Tz_m_argo</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">argoclim</span><span class="o">.</span><span class="n">theta_mean</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">differentiate</span><span class="p">(</span><span class="s2">&quot;pres&quot;</span><span class="p">,</span> <span class="n">positive_upward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="o">.</span><span class="n">compute</span><span class="p">()</span>
    <span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="s2">&quot;lon&quot;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">pres</span><span class="o">=</span><span class="n">centers</span><span class="p">)</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">pres</span><span class="o">=</span><span class="s2">&quot;pressure_bins&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="p">(</span><span class="n">binned</span><span class="o">.</span><span class="n">χ</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s2">&quot;pressure_bins&quot;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">(</span><span class="n">binned</span><span class="o">.</span><span class="n">KtTz_seg</span> <span class="o">*</span> <span class="n">Tz_m_argo</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">step</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;pressure_bins&quot;</span><span class="p">,</span> <span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">yincrease</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f1f4821d370&gt;]
</pre></div>
</div>
<img alt="_images/iw-fine-argo_26_1.png" src="_images/iw-fine-argo_26_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="debugging-profile-estimates">
<h2>Debugging profile estimates<a class="headerlink" href="#debugging-profile-estimates" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>[x] check MLD for N_PROF=100</p></li>
<li><p>[ ] change axes tick colors for T,S,γ</p></li>
<li><p>[ ] Throw out estimates when number of points is small. This is causing the drop near 1000m; below this data spacing is usually coarse. I need to be more careful about bins near 1000m</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile</span> <span class="o">=</span> <span class="n">argo</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">N_PROF</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">process_argo_profile</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 104 —  294dbar: ξgmvar: 0.103, ξvar: 0.114, N2: 3.61e-05 K: 5.33e-06, ε: 9.45e-10
 204 —  385dbar: ξgmvar: 0.096, ξvar: 0.033, N2: 2.28e-05 K: 4.97e-07, ε: 5.56e-11
</pre></div>
</div>
<img alt="_images/iw-fine-argo_29_1.png" src="_images/iw-fine-argo_29_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile</span> <span class="o">=</span> <span class="n">argo</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;N_PROF&quot;</span><span class="p">:</span> <span class="s2">&quot;PLATFORM_NUMBER == 6900695 &amp; CYCLE_NUMBER == 160&quot;</span><span class="p">}</span>
<span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">process_argo_profile</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 211 —  371dbar: ξgmvar: 0.095, ξvar: 0.032, N2: 2.25e-05 K: 4.48e-07, ε: 4.94e-11
 316 —  476dbar: ξgmvar: 0.039, ξvar: 0.025, N2: 1.88e-05 K: 1.52e-06, ε: 1.41e-10
 416 —  586dbar: ξgmvar: 0.104, ξvar: 0.003, N2: 1.59e-05 K: 3.60e-09, ε: 2.81e-13
 511 —  691dbar: ξgmvar: 0.104, ξvar: 0.178, N2: 1.42e-05 K: 1.12e-05, ε: 7.80e-10
 611 —  791dbar: ξgmvar: 0.105, ξvar: 0.058, N2: 1.29e-05 K: 1.16e-06, ε: 7.31e-11
 711 —  891dbar: ξgmvar: 0.105, ξvar: 0.083, N2: 1.06e-05 K: 2.32e-06, ε: 1.20e-10
 811 —  991dbar: ξgmvar: 0.101, ξvar: 0.140, N2: 7.99e-06 K: 6.95e-06, ε: 2.72e-10
 911 — 1091dbar: ξgmvar: 0.107, ξvar: 0.053, N2: 7.61e-06 K: 8.85e-07, ε: 3.30e-11
1012 — 1191dbar: ξgmvar: 0.107, ξvar: 0.099, N2: 6.11e-06 K: 2.96e-06, ε: 8.87e-11
1111 — 1291dbar: ξgmvar: 0.102, ξvar: 0.071, N2: 5.59e-06 K: 1.67e-06, ε: 4.56e-11
1211 — 1391dbar: ξgmvar: 0.102, ξvar: 0.095, N2: 5.20e-06 K: 2.94e-06, ε: 7.50e-11
1311 — 1492dbar: ξgmvar: 0.103, ξvar: 0.054, N2: 4.52e-06 K: 9.23e-07, ε: 2.04e-11
1411 — 1571dbar: ξgmvar: 0.102, ξvar: 0.080, N2: 3.55e-06 K: 2.02e-06, ε: 3.52e-11
</pre></div>
</div>
<img alt="_images/iw-fine-argo_30_1.png" src="_images/iw-fine-argo_30_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile</span> <span class="o">=</span> <span class="n">argo</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">N_PROF</span><span class="o">=</span><span class="mi">2100</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">process_argo_profile</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 203 —  399dbar: ξgmvar: 0.315, ξvar: 0.216, N2: 2.23e-05 K: 1.97e-06, ε: 2.16e-10
 303 —  499dbar: ξgmvar: 0.231, ξvar: 0.200, N2: 1.71e-05 K: 3.08e-06, ε: 2.58e-10
 403 —  599dbar: ξgmvar: 0.189, ξvar: 0.207, N2: 1.60e-05 K: 4.87e-06, ε: 3.83e-10
 503 —  699dbar: ξgmvar: 0.250, ξvar: 0.217, N2: 1.47e-05 K: 3.04e-06, ε: 2.19e-10
 603 —  799dbar: ξgmvar: 0.286, ξvar: 0.219, N2: 1.37e-05 K: 2.35e-06, ε: 1.58e-10
 703 —  899dbar: ξgmvar: 0.146, ξvar: 0.191, N2: 1.29e-05 K: 6.82e-06, ε: 4.31e-10
 803 —  987dbar: ξgmvar: 0.256, ξvar: 0.200, N2: 9.84e-06 K: 2.36e-06, ε: 1.14e-10
 903 — 1073dbar: ξgmvar: 0.460, ξvar: 0.169, N2: 8.63e-06 K: 5.15e-07, ε: 2.18e-11
</pre></div>
</div>
<img alt="_images/iw-fine-argo_31_1.png" src="_images/iw-fine-argo_31_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile</span> <span class="o">=</span> <span class="n">argo</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;N_PROF&quot;</span><span class="p">:</span> <span class="s2">&quot;PLATFORM_NUMBER == 4901588 &amp; CYCLE_NUMBER == 23&quot;</span><span class="p">}</span>
<span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">process_argo_profile</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 201 —  397dbar: ξgmvar: 0.269, ξvar: 0.217, N2: 1.73e-05 K: 2.92e-06, ε: 2.47e-10
 303 —  497dbar: ξgmvar: 0.137, ξvar: 0.219, N2: 1.57e-05 K: 1.14e-05, ε: 8.78e-10
 401 —  597dbar: ξgmvar: 0.136, ξvar: 0.215, N2: 1.43e-05 K: 1.11e-05, ε: 7.77e-10
 501 —  699dbar: ξgmvar: 0.131, ξvar: 0.208, N2: 1.42e-05 K: 1.11e-05, ε: 7.72e-10
 601 —  799dbar: ξgmvar: 0.216, ξvar: 0.219, N2: 1.46e-05 K: 4.58e-06, ε: 3.27e-10
 701 —  897dbar: ξgmvar: 0.145, ξvar: 0.207, N2: 1.44e-05 K: 9.05e-06, ε: 6.40e-10
 803 —  997dbar: ξgmvar: 0.236, ξvar: 0.209, N2: 1.23e-05 K: 3.38e-06, ε: 2.04e-10
 901 — 1099dbar: ξgmvar: 0.038, ξvar: 0.175, N2: 9.35e-06 K: 8.93e-05, ε: 4.09e-09
1001 — 1197dbar: ξgmvar: 0.087, ξvar: 0.201, N2: 8.07e-06 K: 2.19e-05, ε: 8.66e-10
1103 — 1299dbar: ξgmvar: 0.099, ξvar: 0.204, N2: 7.22e-06 K: 1.75e-05, ε: 6.19e-10
1201 — 1399dbar: ξgmvar: 0.051, ξvar: 0.200, N2: 5.85e-06 K: 6.25e-05, ε: 1.79e-09
1303 — 1499dbar: ξgmvar: 0.199, ξvar: 0.216, N2: 4.83e-06 K: 4.62e-06, ε: 1.09e-10
1403 — 1599dbar: ξgmvar: 0.113, ξvar: 0.213, N2: 3.57e-06 K: 1.33e-05, ε: 2.33e-10
1503 — 1699dbar: ξgmvar: 0.053, ξvar: 0.108, N2: 3.34e-06 K: 1.57e-05, ε: 2.57e-10
1601 — 1799dbar: ξgmvar: 0.040, ξvar: 0.137, N2: 3.21e-06 K: 4.29e-05, ε: 6.76e-10
1701 — 1899dbar: ξgmvar: 0.211, ξvar: 0.218, N2: 2.33e-06 K: 3.80e-06, ε: 4.35e-11
1803 — 1999dbar: ξgmvar: 0.078, ξvar: 0.209, N2: 1.81e-06 K: 2.49e-05, ε: 2.20e-10
1901 — 1999dbar: ξgmvar: 0.060, ξvar: 0.181, N2: 1.51e-06 K: 3.09e-05, ε: 2.28e-10
</pre></div>
</div>
<img alt="_images/iw-fine-argo_32_1.png" src="_images/iw-fine-argo_32_1.png" />
</div>
</div>
<div class="section" id="bad-profiles">
<h3>Bad profiles<a class="headerlink" href="#bad-profiles" title="Permalink to this headline">¶</a></h3>
<p>I found some bad profiles; all for the same float 6900695; and cycle numbers 160, 170 ,171, 175.</p>
<p>Changing from the mixsea psd to my psd fixed it :/. The input data were fine; whatever funny interpolation is done with mixsea screws things</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">combined</span><span class="o">.</span><span class="n">ε</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="s2">&quot;pressure_&quot;</span><span class="p">)</span>
<span class="n">combined</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">profile</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                (pressure_: 19, profile: 4, nbnds: 2)
Coordinates: (12/13)
  * pressure_              (pressure_) int64 0 1 2 3 4 5 6 ... 13 14 15 16 17 18
    flag                   (profile, pressure_) float64 5.0 5.0 5.0 ... -2.0 nan
    pressure               (profile, pressure_) float64 282.7 414.5 ... nan nan
    npts                   (profile, pressure_) float64 15.0 13.0 ... 4.0 nan
    γmean                  (profile, pressure_) float64 26.71 26.92 ... nan nan
    latitude               (profile) float64 23.04 23.05 23.17 23.56
    ...                     ...
    γ_bounds               (profile, pressure_, nbnds) float64 26.5 ... nan
    p_bounds               (profile, pressure_, nbnds) float64 206.0 ... nan
    CONFIG_MISSION_NUMBER  (profile) int64 2 2 2 2
    PLATFORM_NUMBER        (profile) int64 6900695 6900695 6900695 6900695
    CYCLE_NUMBER           (profile) int64 160 170 171 175
    DIRECTION              (profile) &lt;U1 &#x27;A&#x27; &#x27;A&#x27; &#x27;A&#x27; &#x27;A&#x27;
Dimensions without coordinates: profile, nbnds
Data variables: (12/13)
    ε                      (profile, pressure_) float64 2.364e-11 ... nan
    Kρ                     (profile, pressure_) float64 2.215e-07 ... nan
    N2mean                 (profile, pressure_) float64 2.177e-05 ... nan
    ξvar                   (profile, pressure_) float64 0.03379 ... nan
    ξvargm                 (profile, pressure_) float64 0.1436 0.05839 ... nan
    Tzlin                  (profile, pressure_) float64 0.02425 0.01908 ... nan
    ...                     ...
    Tmld                   (profile) float64 96.0 56.0 46.0 45.0
    σmld                   (profile) float64 36.0 46.0 46.0 36.0
    Tmode                  (profile) float64 146.0 66.0 56.0 55.0
    σmode                  (profile) float64 106.0 66.0 56.0 55.0
    χ                      (profile, pressure_) float64 2.333e-10 ... nan
    KtTz                   (profile, pressure_) float64 5.082e-09 ... nan</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-6b002ec8-ebd7-4a66-a319-e9550abd882e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6b002ec8-ebd7-4a66-a319-e9550abd882e' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>pressure_</span>: 19</li><li><span>profile</span>: 4</li><li><span>nbnds</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-9a44f66f-ab95-414a-b09e-ae0ec5c7a763' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9a44f66f-ab95-414a-b09e-ae0ec5c7a763' class='xr-section-summary' >Coordinates: <span>(13)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>pressure_</span></div><div class='xr-var-dims'>(pressure_)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 13 14 15 16 17 18</div><input id='attrs-1b44d911-4956-492f-b3fb-23585b54d456' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1b44d911-4956-492f-b3fb-23585b54d456' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dc07190b-1a08-4d48-b795-21929785ac55' class='xr-var-data-in' type='checkbox'><label for='data-dc07190b-1a08-4d48-b795-21929785ac55' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>flag</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.0 5.0 5.0 5.0 ... -2.0 -2.0 nan</div><input id='attrs-3967fed8-8570-4dca-ac17-feca4332e182' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3967fed8-8570-4dca-ac17-feca4332e182' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-509a3bc3-45c2-476a-97c7-e0386cfb38b2' class='xr-var-data-in' type='checkbox'><label for='data-509a3bc3-45c2-476a-97c7-e0386cfb38b2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>flag_values :</span></dt><dd>[-2, -1, 1, 2, 3, 4, 5]</dd><dt><span>flag_meanings :</span></dt><dd>too_coarse too_short N²_variance_too_high too_unstratified too_little_bandwidth no_internal_waves good_data</dd></dl></div><div class='xr-var-data'><pre>array([[ 5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,
        -2., -2., -2., -2., -2., nan],
       [ 5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,
        -2., -2., -2., -1., -1., nan],
       [ 5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,
        -2., -2., -2., -2., -2., nan],
       [ 5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,  5.,
        -2., -2., -2., -2., -2., nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pressure</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>282.7 414.5 509.3 ... nan nan nan</div><input id='attrs-8d6d9a8a-962d-4456-996b-41854ea6fa45' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8d6d9a8a-962d-4456-996b-41854ea6fa45' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7afd35cd-61eb-471b-8758-c1f3df150aa9' class='xr-var-data-in' type='checkbox'><label for='data-7afd35cd-61eb-471b-8758-c1f3df150aa9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Z</dd><dt><span>standard_name :</span></dt><dd>sea_water_pressure</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>bounds :</span></dt><dd>p_bounds</dd></dl></div><div class='xr-var-data'><pre>array([[ 282.66666667,  414.46153846,  509.33333333,  600.9       ,
         700.95      ,  801.05      ,  901.        , 1001.05      ,
        1101.05      , 1201.        , 1301.        , 1401.05      ,
        1479.5       ,           nan,           nan,           nan,
                  nan,           nan,           nan],
       [ 310.38888889,  400.9       ,  500.8       ,  592.5       ,
         687.53846154,  819.4       ,  901.05      , 1001.        ,
        1101.        , 1201.        , 1301.05      , 1401.1       ,
        1479.57142857,           nan,           nan,           nan,
                  nan,           nan,           nan],
       [ 301.        ,  401.        ,  501.05      ,  601.05      ,
         701.        ,  801.        ,  901.        , 1001.05      ,
        1087.3125    , 1209.07692308, 1314.29411765, 1401.05      ,
        1479.71428571,           nan,           nan,           nan,
                  nan,           nan,           nan],
       [ 320.14285714,  397.76470588,  487.61538462,  619.33333333,
         701.05      ,  801.        ,  900.95      , 1001.        ,
        1101.        , 1201.        , 1301.05      , 1401.05      ,
        1479.5       ,           nan,           nan,           nan,
                  nan,           nan,           nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>npts</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>15.0 13.0 18.0 20.0 ... 8.0 4.0 nan</div><input id='attrs-f23cf298-73d1-4e74-856a-b4e670dd40be' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f23cf298-73d1-4e74-856a-b4e670dd40be' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8cf41363-4db2-4cc3-8394-47d99176c374' class='xr-var-data-in' type='checkbox'><label for='data-8cf41363-4db2-4cc3-8394-47d99176c374' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>number of points in segment</dd></dl></div><div class='xr-var-data'><pre>array([[15., 13., 18., 20., 20., 20., 20., 20., 20., 20., 20., 20., 14.,
         8.,  8.,  8.,  8.,  4., nan],
       [18., 20., 20., 18., 13., 15., 20., 20., 20., 20., 20., 20., 14.,
         8.,  8.,  8.,  8.,  4., nan],
       [20., 20., 20., 20., 20., 20., 20., 20., 16., 13., 17., 20., 14.,
         8.,  8.,  8.,  8.,  4., nan],
       [14., 17., 13., 15., 20., 20., 20., 20., 20., 20., 20., 20., 14.,
         8.,  8.,  8.,  8.,  4., nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>γmean</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>26.71 26.92 27.09 ... nan nan nan</div><input id='attrs-97cebbbe-1a23-490f-9ad0-ff753c4b1bbf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-97cebbbe-1a23-490f-9ad0-ff753c4b1bbf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-26e172ad-61a8-475e-a51f-7df717bf96e5' class='xr-var-data-in' type='checkbox'><label for='data-26e172ad-61a8-475e-a51f-7df717bf96e5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>γ_bounds</dd><dt><span>standard_name :</span></dt><dd>neutral_density</dd><dt><span>units :</span></dt><dd>kg/m3</dd><dt><span>long_name :</span></dt><dd>$γ_n$</dd></dl></div><div class='xr-var-data'><pre>array([[26.70727758, 26.92163483, 27.09017929, 27.24200566, 27.37606026,
        27.48960307, 27.57617697, 27.64916837, 27.71189223, 27.76403431,
        27.81077869, 27.85031009, 27.88082515,         nan,         nan,
                nan,         nan,         nan,         nan],
       [26.76088094, 26.9425281 , 27.08418426, 27.21359268, 27.34542263,
        27.46176361, 27.55969803, 27.64158084, 27.70956612, 27.76537164,
        27.81587768, 27.85716215, 27.88443869,         nan,         nan,
                nan,         nan,         nan,         nan],
       [26.7666857 , 26.94958959, 27.09293974, 27.22997919, 27.34926735,
        27.46213334, 27.56217554, 27.64340815, 27.70858312, 27.76643944,
        27.81779601, 27.84894116, 27.8738884 ,         nan,         nan,
                nan,         nan,         nan,         nan],
       [26.75044662, 26.9431894 , 27.09185618, 27.21408612, 27.32488993,
        27.43806899, 27.54212184, 27.62103016, 27.68560784, 27.74986758,
        27.8038331 , 27.84443544, 27.87717005,         nan,         nan,
                nan,         nan,         nan,         nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>23.04 23.05 23.17 23.56</div><input id='attrs-b40d0c9e-54a7-47f0-a905-45b802189046' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b40d0c9e-54a7-47f0-a905-45b802189046' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4466811c-908b-44d9-883b-ab37fcc7db79' class='xr-var-data-in' type='checkbox'><label for='data-4466811c-908b-44d9-883b-ab37fcc7db79' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([23.04 , 23.049, 23.17 , 23.563])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-26.74 -26.79 -27.26 -29.41</div><input id='attrs-aa3de6ae-9b83-466f-8d17-1e3c4a7d4230' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-aa3de6ae-9b83-466f-8d17-1e3c4a7d4230' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-21351b4e-cbf2-45f9-8165-99a9155bb9e1' class='xr-var-data-in' type='checkbox'><label for='data-21351b4e-cbf2-45f9-8165-99a9155bb9e1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-26.742, -26.793, -27.258, -29.41 ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>γ_bounds</span></div><div class='xr-var-dims'>(profile, pressure_, nbnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>26.5 26.89 26.74 ... nan nan nan</div><input id='attrs-8d72732f-4a94-4abc-afe0-7292861fd7f5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8d72732f-4a94-4abc-afe0-7292861fd7f5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2183ccf3-a0eb-4fa2-959e-d8eb45cd021d' class='xr-var-data-in' type='checkbox'><label for='data-2183ccf3-a0eb-4fa2-959e-d8eb45cd021d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[26.50348193, 26.89389732],
        [26.7446015 , 27.08041898],
        [26.94419658, 27.21653313],
        [27.10958415, 27.3658585 ],
        [27.25821569, 27.49112198],
        [27.37838172, 27.57053787],
        [27.5026038 , 27.64626874],
        [27.57542286, 27.71019121],
        [27.65660674, 27.76214378],
        [27.71398915, 27.8072677 ],
        [27.76748342, 27.85096196],
        [27.81369033, 27.88336041],
        [27.85381254, 27.90366062],
        [        nan,         nan],
        [        nan,         nan],
        [        nan,         nan],
        [        nan,         nan],
        [        nan,         nan],
        [        nan,         nan]],

...

       [[26.57815168, 26.92046926],
        [26.77644627, 27.08640296],
        [26.95354157, 27.2028318 ],
        [27.11891194, 27.30446138],
        [27.22036625, 27.42950204],
        [27.33629464, 27.54575826],
        [27.44042784, 27.61698732],
        [27.55655176, 27.6776193 ],
        [27.62390475, 27.74723026],
        [27.68606461, 27.80544632],
        [27.75448963, 27.84271065],
        [27.81122621, 27.87825614],
        [27.84489736, 27.90660547],
        [        nan,         nan],
        [        nan,         nan],
        [        nan,         nan],
        [        nan,         nan],
        [        nan,         nan],
        [        nan,         nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>p_bounds</span></div><div class='xr-var-dims'>(profile, pressure_, nbnds)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>206.0 386.0 306.0 ... nan nan nan</div><input id='attrs-99276eed-ec03-4e03-af69-b009d863a94b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-99276eed-ec03-4e03-af69-b009d863a94b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7814fca1-7c5c-4a38-b8cb-8bc662fefa57' class='xr-var-data-in' type='checkbox'><label for='data-7814fca1-7c5c-4a38-b8cb-8bc662fefa57' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[ 206.,  386.],
        [ 306.,  496.],
        [ 406.,  596.],
        [ 506.,  696.],
        [ 606.,  796.],
        [ 706.,  896.],
        [ 806.,  996.],
        [ 906., 1096.],
        [1006., 1196.],
        [1106., 1296.],
        [1206., 1396.],
        [1306., 1496.],
        [1406., 1588.],
        [  nan,   nan],
        [  nan,   nan],
        [  nan,   nan],
        [  nan,   nan],
        [  nan,   nan],
        [  nan,   nan]],

...

       [[ 216.,  396.],
        [ 316.,  496.],
        [ 406.,  596.],
        [ 516.,  696.],
        [ 606.,  796.],
        [ 707.,  896.],
        [ 806.,  996.],
        [ 906., 1096.],
        [1006., 1196.],
        [1106., 1296.],
        [1206., 1396.],
        [1306., 1496.],
        [1406., 1589.],
        [  nan,   nan],
        [  nan,   nan],
        [  nan,   nan],
        [  nan,   nan],
        [  nan,   nan],
        [  nan,   nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>CONFIG_MISSION_NUMBER</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2 2 2 2</div><input id='attrs-22011d41-76fe-4722-aa81-6c1b91c981b9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-22011d41-76fe-4722-aa81-6c1b91c981b9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a53cb23b-192c-42c4-af66-0b820f7df43e' class='xr-var-data-in' type='checkbox'><label for='data-a53cb23b-192c-42c4-af66-0b820f7df43e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2, 2, 2, 2])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>PLATFORM_NUMBER</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>6900695 6900695 6900695 6900695</div><input id='attrs-0cb32677-890f-4449-915a-1d3dd0841409' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0cb32677-890f-4449-915a-1d3dd0841409' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0b62a74d-9061-43f7-94b1-6bcfba9755fe' class='xr-var-data-in' type='checkbox'><label for='data-0b62a74d-9061-43f7-94b1-6bcfba9755fe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([6900695, 6900695, 6900695, 6900695])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>CYCLE_NUMBER</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>160 170 171 175</div><input id='attrs-72d3c23f-4b8c-48e4-b636-6234369fe957' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-72d3c23f-4b8c-48e4-b636-6234369fe957' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-49d65c1a-126a-4248-a32a-3a924cf8c511' class='xr-var-data-in' type='checkbox'><label for='data-49d65c1a-126a-4248-a32a-3a924cf8c511' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([160, 170, 171, 175])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DIRECTION</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;A&#x27; &#x27;A&#x27; &#x27;A&#x27; &#x27;A&#x27;</div><input id='attrs-282328be-b932-40d2-ac36-f62d6bf3a041' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-282328be-b932-40d2-ac36-f62d6bf3a041' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a474a36d-9faf-4528-ab5d-413098415ca1' class='xr-var-data-in' type='checkbox'><label for='data-a474a36d-9faf-4528-ab5d-413098415ca1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;A&#x27;, &#x27;A&#x27;, &#x27;A&#x27;, &#x27;A&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3235fc8b-dd06-4100-ba84-7d7b097e4f6f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3235fc8b-dd06-4100-ba84-7d7b097e4f6f' class='xr-section-summary' >Data variables: <span>(13)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ε</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.364e-11 2.536e+52 ... nan nan</div><input id='attrs-1fd35a5b-0a9c-4820-8913-d2268737951d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1fd35a5b-0a9c-4820-8913-d2268737951d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a459565e-12d8-4264-9f69-6265d0c6ffd4' class='xr-var-data-in' type='checkbox'><label for='data-a459565e-12d8-4264-9f69-6265d0c6ffd4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$ε$</dd><dt><span>units :</span></dt><dd>W/kg</dd></dl></div><div class='xr-var-data'><pre>array([[2.36385164e-11, 2.53638804e+52, 1.23612355e-11, 4.08093165e-10,
        2.36616530e-11, 6.50976550e-11, 8.69888698e-11, 4.64418643e-12,
        3.21800384e-11, 3.56068119e-11, 3.55175343e-11, 7.65259693e-12,
        1.18291866e-12,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [2.93738809e-12, 1.22175185e-11, 2.31770481e-11, 8.45151757e-11,
        2.11869020e+52, 1.88155668e-10, 4.64722296e-12, 3.89930855e-12,
        4.19837460e-12, 1.23313837e-12, 6.34953474e-11, 2.32685471e-12,
        1.38265182e-11,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [3.47038376e-10, 1.10320801e-11, 2.94295925e-11, 1.89775072e-12,
        9.00782340e-12, 7.32797440e-11, 9.90698382e-11, 1.18106877e-10,
        3.76628714e-12, 6.65098375e+51, 1.10526817e-12, 2.45299491e-12,
        8.12042775e-12,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [1.60908109e-11, 3.42018225e-10, 3.29671581e+52, 1.93007839e-11,
        1.38595097e-11, 4.31023998e-12, 6.20413072e-12, 1.48967278e-11,
        9.64215180e-11, 1.40548101e-11, 2.64787087e-11, 4.92849828e-12,
        3.49601816e-11,            nan,            nan,            nan,
                   nan,            nan,            nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Kρ</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.215e-07 2.794e+56 ... nan nan</div><input id='attrs-5c258000-47ee-4624-bba8-545048bcafa7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5c258000-47ee-4624-bba8-545048bcafa7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8e64ab24-d38d-4c36-bcc6-3729154a54fa' class='xr-var-data-in' type='checkbox'><label for='data-8e64ab24-d38d-4c36-bcc6-3729154a54fa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$K_ρ$</dd><dt><span>units :</span></dt><dd>m²/s</dd></dl></div><div class='xr-var-data'><pre>array([[2.21481263e-07, 2.79426456e+56, 1.58740710e-07, 5.86463821e-06,
        3.69868264e-07, 1.24050139e-06, 2.16741063e-06, 1.26512261e-07,
        1.03158438e-06, 1.31715118e-06, 1.38149761e-06, 3.34096735e-07,
        6.80082760e-08,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [3.00772589e-08, 1.50085966e-07, 3.45879416e-07, 1.17311252e-06,
        3.18836823e+56, 3.57639036e-06, 9.93323487e-08, 9.83019024e-08,
        1.26529792e-07, 4.15103435e-08, 2.36654222e-06, 1.09929853e-07,
        8.63170289e-07,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [3.46817295e-06, 1.40389577e-07, 4.27083804e-07, 2.76038608e-08,
        1.48267596e-07, 1.32948125e-06, 2.09503837e-06, 2.96121480e-06,
        1.09023681e-07, 2.26911052e+56, 4.83317493e-08, 1.51448779e-07,
        4.82523438e-07,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [1.51039081e-07, 3.72209964e-06, 4.89649546e+56, 3.40675492e-07,
        2.47247423e-07, 7.33711176e-08, 1.27141126e-07, 4.28507732e-07,
        2.75056629e-06, 3.99599666e-07, 9.74240908e-07, 2.26886525e-07,
        1.67037261e-06,            nan,            nan,            nan,
                   nan,            nan,            nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>N2mean</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.177e-05 1.852e-05 ... nan nan</div><input id='attrs-c474a5a8-d613-4cb6-b4d3-d4e126fcf062' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c474a5a8-d613-4cb6-b4d3-d4e126fcf062' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-51eaaa36-4d49-4758-8683-2a8a4e5f0ef5' class='xr-var-data-in' type='checkbox'><label for='data-51eaaa36-4d49-4758-8683-2a8a4e5f0ef5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$N²$</dd><dt><span>description :</span></dt><dd>mean of quadratic fit of N² with pressure</dd></dl></div><div class='xr-var-data'><pre>array([[2.17721210e-05, 1.85167895e-05, 1.58851412e-05, 1.41950069e-05,
        1.30501507e-05, 1.07049736e-05, 8.18728677e-06, 7.48849494e-06,
        6.36354784e-06, 5.51461224e-06, 5.24457360e-06, 4.67255177e-06,
        3.54822076e-06,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [1.99223511e-05, 1.66058241e-05, 1.36694462e-05, 1.46964535e-05,
        1.35555299e-05, 1.07322283e-05, 9.54377778e-06, 8.09176374e-06,
        6.76870999e-06, 6.06000523e-06, 5.47324843e-06, 4.31788561e-06,
        3.26763742e-06,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [2.04124094e-05, 1.60302411e-05, 1.40568710e-05, 1.40244826e-05,
        1.23934190e-05, 1.12439586e-05, 9.64643819e-06, 8.13622201e-06,
        7.04709457e-06, 5.97926429e-06, 4.66501090e-06, 3.30406348e-06,
        3.43303323e-06,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [2.17323210e-05, 1.87447118e-05, 1.37345258e-05, 1.15571718e-05,
        1.14349326e-05, 1.19837801e-05, 9.95433837e-06, 7.09168986e-06,
        7.15104254e-06, 7.17492523e-06, 5.54431573e-06, 4.43122110e-06,
        4.26950803e-06,            nan,            nan,            nan,
                   nan,            nan,            nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ξvar</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.03379 4.918e+29 ... nan nan</div><input id='attrs-d45b06d9-3670-4521-a443-852bcd97471d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d45b06d9-3670-4521-a443-852bcd97471d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ccdc0e2-d550-4a36-8ace-8cdedd133341' class='xr-var-data-in' type='checkbox'><label for='data-2ccdc0e2-d550-4a36-8ace-8cdedd133341' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$ξ$</dd><dt><span>description :</span></dt><dd>strain variance</dd></dl></div><div class='xr-var-data'><pre>array([[3.37863187e-02, 4.91759220e+29, 8.64574714e-02, 1.79437817e-01,
        4.53377531e-02, 8.42185820e-02, 1.13460103e-01, 2.75849191e-02,
        7.96765524e-02, 9.09414010e-02, 9.34650052e-02, 4.63372655e-02,
        2.37349253e-02,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [1.25319622e-02, 2.83743395e-02, 4.36897630e-02, 1.88550831e-01,
        5.36451233e+29, 2.12286299e-01, 2.40237579e-02, 2.41796852e-02,
        2.77797403e-02, 1.60355872e-02, 1.21946244e-01, 2.67238247e-02,
        8.50321763e-02,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [1.34059905e-01, 2.74593187e-02, 4.83548459e-02, 1.22953552e-02,
        2.87514953e-02, 8.66988759e-02, 1.10031269e-01, 1.86350995e-01,
        2.70558728e-02, 4.77094126e+29, 1.85391159e-02, 3.19040819e-02,
        1.40087732e-01,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [2.92010325e-02, 1.55071396e-01, 6.58739166e+29, 4.59072870e-02,
        3.71099590e-02, 2.01475619e-02, 2.68769105e-02, 5.05433365e-02,
        1.27979368e-01, 4.87684743e-02, 7.75454101e-02, 3.80177342e-02,
        1.61830563e-01,            nan,            nan,            nan,
                   nan,            nan,            nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ξvargm</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.1436 0.05839 0.4274 ... nan nan</div><input id='attrs-122a17d8-471d-4c2c-b0bf-51c7f8361a72' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-122a17d8-471d-4c2c-b0bf-51c7f8361a72' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6ebe0e20-cdaa-458d-91f9-06d68a8d355a' class='xr-var-data-in' type='checkbox'><label for='data-6ebe0e20-cdaa-458d-91f9-06d68a8d355a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$ξ_{gm}$</dd><dt><span>description :</span></dt><dd>GM strain variance</dd></dl></div><div class='xr-var-data'><pre>array([[0.1436376 , 0.05838999, 0.42740113, 0.14510577, 0.14536194,
        0.14592727, 0.14661366, 0.14682351, 0.14718433, 0.14747948,
        0.1475783 , 0.14779683, 0.16510516,        nan,        nan,
               nan,        nan,        nan,        nan],
       [0.14396642, 0.14460049, 0.14522194, 0.34157336, 0.05870487,
        0.21669462, 0.1462318 , 0.14664177, 0.14705078, 0.14728735,
        0.14749445, 0.1479394 , 0.16523592,        nan,        nan,
               nan,        nan,        nan,        nan],
       [0.14387774, 0.14471732, 0.14513608, 0.14514321, 0.14551436,
        0.14579191, 0.14620411, 0.20637409, 0.15493213, 0.05933913,
        0.15577253, 0.14838449, 0.36586065,        nan,        nan,
               nan,        nan,        nan,        nan],
       [0.15160309, 0.16099273, 0.05869254, 0.15368172, 0.14574478,
        0.14561162, 0.14612198, 0.1469473 , 0.14692856, 0.14692104,
        0.14746877, 0.1478932 , 0.23151288,        nan,        nan,
               nan,        nan,        nan,        nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Tzlin</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02425 0.01908 0.01521 ... nan nan</div><input id='attrs-d0a602f3-3fe2-40a9-ba9c-f890343fed69' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d0a602f3-3fe2-40a9-ba9c-f890343fed69' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-29386ec1-8c55-4a92-8184-24b4587a94cb' class='xr-var-data-in' type='checkbox'><label for='data-29386ec1-8c55-4a92-8184-24b4587a94cb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$T_z^{lin}$</dd><dt><span>description :</span></dt><dd>linear fit of T vs pressure</dd></dl></div><div class='xr-var-data'><pre>array([[0.02424582, 0.01908242, 0.01520965, 0.01514095, 0.01320212,
        0.01088167, 0.00833459, 0.00593619, 0.00140954, 0.00232504,
        0.00431977, 0.00417473, 0.00347198,        nan,        nan,
               nan,        nan,        nan,        nan],
       [0.02351858, 0.01774396, 0.01220679, 0.01522098, 0.01229364,
        0.01136993, 0.00910831, 0.00674722, 0.00436391, 0.00256962,
        0.00364311, 0.00374324, 0.00266813,        nan,        nan,
               nan,        nan,        nan,        nan],
       [0.02477181, 0.01552286, 0.01448086, 0.01336647, 0.01197526,
        0.01197241, 0.00871052, 0.00731158, 0.00464031, 0.00242667,
        0.0028439 , 0.00283291, 0.00261213,        nan,        nan,
               nan,        nan,        nan,        nan],
       [0.02173839, 0.02071713, 0.01306682, 0.01126987, 0.01223761,
        0.01187599, 0.01004565, 0.00507414, 0.00488105, 0.00303271,
        0.00362758, 0.00337928, 0.00371936,        nan,        nan,
               nan,        nan,        nan,        nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Tzmean</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.02295 0.01879 0.016 ... nan nan</div><input id='attrs-40e7a883-c0c2-4946-a265-2ac9c9a6c35d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-40e7a883-c0c2-4946-a265-2ac9c9a6c35d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a9b2fc83-219c-4a70-af88-bba3e1c7cca0' class='xr-var-data-in' type='checkbox'><label for='data-a9b2fc83-219c-4a70-af88-bba3e1c7cca0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$T_z^{quad}$</dd><dt><span>description :</span></dt><dd>mean of quadratic fit of Tz with pressure; like N² fitting for strain</dd></dl></div><div class='xr-var-data'><pre>array([[0.02294775, 0.01879253, 0.01599978, 0.01469202, 0.0133505 ,
        0.01118349, 0.00857   , 0.00586061, 0.00219561, 0.00182   ,
        0.004145  , 0.00440283, 0.00356199,        nan,        nan,
               nan,        nan,        nan,        nan],
       [0.02243752, 0.01810576, 0.01339458, 0.01447744, 0.01363468,
        0.01064118, 0.00933131, 0.00677   , 0.00433   , 0.00278   ,
        0.0032897 , 0.00385035, 0.00285688,        nan,        nan,
               nan,        nan,        nan,        nan],
       [0.02258   , 0.01735   , 0.01385838, 0.01369838, 0.012635  ,
        0.011305  , 0.009235  , 0.00708344, 0.00503532, 0.00244734,
        0.00260111, 0.00307237, 0.00261849,        nan,        nan,
               nan,        nan,        nan,        nan],
       [0.02381405, 0.0204163 , 0.01436905, 0.01109787, 0.01154702,
        0.01225227, 0.00976526, 0.005985  , 0.00469   , 0.00364   ,
        0.00346737, 0.00353237, 0.00360339,        nan,        nan,
               nan,        nan,        nan,        nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Tmld</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>96.0 56.0 46.0 45.0</div><input id='attrs-2c9b6394-4e10-4b7d-9eee-45bb1a9fcccf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2c9b6394-4e10-4b7d-9eee-45bb1a9fcccf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a44b82c3-04c5-4ce3-aac7-221643db0ed7' class='xr-var-data-in' type='checkbox'><label for='data-a44b82c3-04c5-4ce3-aac7-221643db0ed7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>description :</span></dt><dd>ΔT criterion applied first time</dd></dl></div><div class='xr-var-data'><pre>array([96., 56., 46., 45.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>σmld</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>36.0 46.0 46.0 36.0</div><input id='attrs-19527c43-89e8-4fe1-a835-f2223d317f7c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-19527c43-89e8-4fe1-a835-f2223d317f7c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8ba134b6-b9f1-4cab-bb2a-91b943aeef7a' class='xr-var-data-in' type='checkbox'><label for='data-8ba134b6-b9f1-4cab-bb2a-91b943aeef7a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>description :</span></dt><dd>Δσ criterion applied first time</dd></dl></div><div class='xr-var-data'><pre>array([36., 46., 46., 36.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Tmode</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>146.0 66.0 56.0 55.0</div><input id='attrs-93e00f37-7940-402f-8b90-c91265605a1f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-93e00f37-7940-402f-8b90-c91265605a1f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4d4082d0-8bfa-46bb-a19e-3754ccef4456' class='xr-var-data-in' type='checkbox'><label for='data-4d4082d0-8bfa-46bb-a19e-3754ccef4456' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>description :</span></dt><dd>ΔT criterion applied second time</dd></dl></div><div class='xr-var-data'><pre>array([146.,  66.,  56.,  55.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>σmode</span></div><div class='xr-var-dims'>(profile)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>106.0 66.0 56.0 55.0</div><input id='attrs-58ca28a0-51e5-4a15-a0c2-d91b4a9db59c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-58ca28a0-51e5-4a15-a0c2-d91b4a9db59c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fa6e14b9-2b05-4265-aa40-4bf07aafbd22' class='xr-var-data-in' type='checkbox'><label for='data-fa6e14b9-2b05-4265-aa40-4bf07aafbd22' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>description :</span></dt><dd>Δσ criterion applied second time</dd></dl></div><div class='xr-var-data'><pre>array([106.,  66.,  56.,  55.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>χ</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.333e-10 1.974e+53 ... nan nan</div><input id='attrs-8d5ce5cf-d568-4680-9751-527120129c8c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8d5ce5cf-d568-4680-9751-527120129c8c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0d6a8564-b75e-4dad-a488-08d2cb0c5845' class='xr-var-data-in' type='checkbox'><label for='data-0d6a8564-b75e-4dad-a488-08d2cb0c5845' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$χ$</dd><dt><span>units :</span></dt><dd>°C²/s</dd></dl></div><div class='xr-var-data'><pre>array([[2.33263671e-10, 1.97364115e+53, 8.12729831e-11, 2.53182794e-09,
        1.31847653e-10, 3.10299895e-10, 3.18370598e-10, 8.69055809e-12,
        9.94589724e-12, 8.72587848e-12, 4.74710895e-11, 1.29528529e-11,
        1.72574648e-12,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [3.02843189e-11, 9.84019085e-11, 1.24111757e-10, 4.91759850e-10,
        1.18546403e+53, 8.09943173e-10, 1.72984105e-11, 9.01092374e-12,
        4.74459075e-12, 6.41616514e-13, 5.12219620e-11, 3.25946916e-12,
        1.40899748e-11,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [3.53654152e-09, 8.45208560e-11, 1.64046943e-10, 1.03594927e-11,
        4.73398504e-11, 3.39823356e-10, 3.57351501e-10, 2.97158229e-10,
        5.52847350e-12, 2.71816440e+51, 6.54002764e-13, 2.85919661e-12,
        6.61682081e-12,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [1.71311214e-10, 3.10292992e-09, 2.02195378e+53, 8.39171002e-11,
        6.59327638e-11, 2.20286861e-11, 2.42484118e-11, 3.06984881e-11,
        1.21003392e-10, 1.05890624e-11, 2.34259653e-11, 5.66202574e-12,
        4.33777088e-11,            nan,            nan,            nan,
                   nan,            nan,            nan]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>KtTz</span></div><div class='xr-var-dims'>(profile, pressure_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>5.082e-09 5.251e+54 ... nan nan</div><input id='attrs-10ec5d57-6249-4f94-8c5a-e00b86f4b320' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-10ec5d57-6249-4f94-8c5a-e00b86f4b320' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c7f53107-baaf-4d89-ae40-4dd631f313e1' class='xr-var-data-in' type='checkbox'><label for='data-c7f53107-baaf-4d89-ae40-4dd631f313e1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$K_ρθ_z$</dd><dt><span>units :</span></dt><dd>°Cm/s</dd></dl></div><div class='xr-var-data'><pre>array([[5.08249607e-09, 5.25113107e+54, 2.53981604e-09, 8.61633765e-08,
        4.93792782e-09, 1.38731296e-08, 1.85747116e-08, 7.41438520e-10,
        2.26495389e-09, 2.39721725e-09, 5.72630756e-09, 1.47097006e-09,
        2.42244755e-10,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [6.74858985e-10, 2.71742024e-09, 4.63290956e-09, 1.69836633e-08,
        4.34723813e+54, 3.80570162e-08, 9.26901220e-10, 6.65503924e-10,
        5.47874109e-10, 1.15398704e-10, 7.78520827e-09, 4.23268807e-10,
        2.46597320e-09,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [7.83113582e-08, 2.43575935e-09, 5.91869043e-09, 3.78128282e-10,
        1.87336139e-09, 1.50297834e-08, 1.93476757e-08, 2.09755732e-08,
        5.48969276e-10, 5.55329427e+53, 1.25716144e-10, 4.65307337e-10,
        1.26348153e-09,            nan,            nan,            nan,
                   nan,            nan,            nan],
       [3.59685199e-09, 7.59914940e-08, 7.03579687e+54, 3.78077369e-09,
        2.85496987e-09, 8.98963103e-10, 1.24156562e-09, 2.56461883e-09,
        1.29001521e-08, 1.45454216e-09, 3.37805667e-09, 8.01447860e-10,
        6.01900891e-09,            nan,            nan,            nan,
                   nan,            nan,            nan]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f92478b1-3f17-4b10-b74c-52efd8cc4232' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f92478b1-3f17-4b10-b74c-52efd8cc4232' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="natre-finescale.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">NATRE micro vs finescale</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="iw-fine-estimates.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Existing finestructure estimates</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Deepak Cherian<br/>
        
            &copy; Copyright 2021.<br/>
          <div class="extra_footer">
            <div>
<script data-goatcounter="https://count.cherian.net/count"
        async src="count.js"></script>
</div>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>